(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[921],{40193:function(e,t,i){(window.__NEXT_P=window.__NEXT_P||[]).push(["/game/gomoku",function(){return i(47399)}])},9171:function(e,t,i){"use strict";i.d(t,{D:function(){return l}});var r=i(55402),s=i(95050),n=i(67294);let a=[["#ffbe0b","#fb5607","#ff006e","#8338ec","#3a86ff"],["#9b5de5","#f15bb5","#fee440","#00bbf9","#00f5d4"]],o=()=>{let e=a.length;return a[Math.min(e-1,Math.floor(Math.random()*e))]},l=()=>{let e=n.useRef(!1),t=n.useRef(null);n.useEffect(()=>(t.current=new s.Z,()=>{var e;null===(e=t.current)||void 0===e||e.clearCanvas(),t.current=null}),[]);let i=(0,r.$0)(async()=>{if(null==t.current)return;let i=t.current,r=o(),s=window.screen.width<=900;e.current=!0;try{await i.addConfetti({confettiColors:r,confettiRadius:s?4:8,confettiNumber:s?100:300})}finally{e.current=!1}});return i}},24729:function(e,t,i){"use strict";i.d(t,{ql:function(){return n},Ee:function(){return c},rU:function(){return g},BD:function(){return d},yj:function(){return u}});var r=i(9008),s=i.n(r);let n=s();var a=i(25675),o=i.n(a),l=i(67294);class c extends l.PureComponent{render(){return l.createElement(o(),this.props)}}let d=[{regex:/^@kyokuya\/_demo\/([\s\S]+)$/,importFunc:e=>()=>i(74243)("./".concat(e[1]))}];var p=i(11163);let u=()=>{let{asPath:e}=(0,p.useRouter)();return l.useMemo(()=>{var t;let i=null!==(t=e.split("#")[1])&&void 0!==t?t:null;return{path:e,hash:i}},[e])};var h=i(41664),m=i.n(h);class g extends l.PureComponent{render(){return l.createElement(m(),{...this.props,legacyBehavior:!1})}}},34781:function(e,t,i){"use strict";i.d(t,{p:function(){return o},X:function(){return s}}),(r=s||(s={}))[r.PENDING=1]="PENDING",r[r.RUNNING=2]="RUNNING",r[r.PAUSED=4]="PAUSED",r[r.END=8]="END";var r,s,n=i(76955),a=i(54362);class o extends n.jz{constructor(e){super();let t=new n.ZM(e.status),i=new n.ZM(e.elapsedTime),r=Date.now(),o=(e,t)=>{let n=Date.now();if(t===s.RUNNING){let e=n-r;i.setState(t=>t+e)}else e===s.PENDING&&i.setState(0);r=n};t.subscribe({next:(e,t)=>o(e,t),complete:()=>{}});let l=(0,a.iP)(()=>{let e=t.getSnapshot();o(e,e)});this.status$=t,this.elapsedTime$=i,this._disposables.push(new n.JT(l))}}},36435:function(e,t,i){"use strict";i.d(t,{DV:function(){return d},TS:function(){return m},Tl:function(){return x}});var r=i(85893),s=i(18872),n=i(5354),a=i(24729),o=i(54362),l=i(49894),c=i(67294);let d=e=>{let t=(0,n.mY)(e=>e.author$);return(0,r.jsx)(l.Z,{className:(0,s.cx)(p.container,e.className),url:t.about,title:"about",onClick:o.UW,children:(0,r.jsx)(a.Ee,{alt:"avatar",src:t.avatar})})},p={container:(0,s.iv)({display:"inline-block",boxSizing:"border-box",transition:"all 0.3s",padding:0,borderRadius:"50%",margin:0,overflow:"hidden",background:"#88acdb",textAlign:"center",userSelect:"none","&&:hover":{transform:"scale(1.1) rotate(360deg)"},"&>img":{boxSizing:"border-box",display:"inline-block",width:"100%",height:"100%"}})};var u=i(45697),h=i.n(u);let m=e=>{let t=(0,n.mY)(e=>e.title$),i=(0,n.mY)(e=>e.description$),s=(0,n.mY)(e=>e.author$),{description:a=i,title:o}=e;return(0,r.jsx)(g,{title:o,siteTitle:t,description:a,authorName:s.name})};m.propTypes={title:h().string.isRequired,description:h().string};class g extends c.PureComponent{render(){let{title:e,siteTitle:t,authorName:i,description:s}=this.props;return(0,r.jsxs)(a.ql,{children:[(0,r.jsxs)("title",{children:[e," | ",t]}),(0,r.jsx)("meta",{name:"viewport",content:"initial-scale=1.0, width=device-width"},"viewport"),(0,r.jsx)("meta",{name:"author",content:i},"author"),(0,r.jsx)("meta",{name:"description",content:s},"description"),(0,r.jsx)("meta",{property:"og:title",content:e},"og:title"),(0,r.jsx)("meta",{property:"og:description",content:s},"og:description"),(0,r.jsx)("meta",{property:"og:type",content:"website"},"og:type")]})}}g.displayName="$SeoPageDescription",g.propTypes={title:h().string.isRequired,siteTitle:h().string.isRequired,authorName:h().string.isRequired,description:h().string.isRequired};var v=i(94101),f=i(14651),y=i(24366);let x=e=>{let t=(0,n.O5)(),i=(0,n.mY)(e=>e.theme$),a=i===v.Q2.darken,o=c.useCallback(e=>{e.stopPropagation(),t({type:n.Jx.TOGGLE_THEME,payload:a?v.Q2.light:v.Q2.darken})},[t,a]),l=a?y.Z:f.Z;return(0,r.jsx)("div",{className:(0,s.cx)(b.container,e.className),children:(0,r.jsx)(l,{className:b.icon,onClick:o})})};x.propTypes={className:h().string};let b={container:(0,s.iv)({cursor:"pointer"}),icon:(0,s.iv)({height:24,width:24,color:"hsl(55deg, 40%, 60%)"})}},28514:function(e,t,i){"use strict";i.d(t,{Vj:function(){return v}}),n||(n={}),(r=a||(a={})).colorBgBody="--colorBgBody",r.colorBgHeader="--colorBgHeader",(s=o||(o={}))[s.colorBgBody="var(--colorBgBody)"]="colorBgBody",s[s.colorBgHeader="var(--colorBgHeader)"]="colorBgHeader";var r,s,n,a,o,l=i(85893),c=i(18872),d=i(94101),p=i(5354),u=i(36435),h=i(67294);let m={[a.colorBgBody]:"#4D4D4D",[a.colorBgHeader]:"#333333"},g={[a.colorBgBody]:"#EAEAEA",[a.colorBgHeader]:""},v=e=>{let t=(0,p.mY)(e=>e.author$),i=(0,p.mY)(e=>e.copyright$),r=(0,p.mY)(e=>e.theme$);return(0,l.jsxs)(h.Fragment,{children:[(0,l.jsx)(u.TS,{title:e.title,description:e.description}),(0,l.jsxs)("div",{className:f.container,"data-theme":r,children:[(0,l.jsxs)("header",{className:f.header,children:[(0,l.jsx)("h1",{className:f.title,children:e.title}),(0,l.jsxs)("div",{className:f.toolbarButtons,children:[(0,l.jsx)(u.Tl,{className:f.themeToggle}),(0,l.jsx)(u.DV,{className:f.authorAvatar})]})]}),(0,l.jsx)("main",{className:f.main,children:(0,l.jsx)("div",{className:f.content,children:e.children})}),(0,l.jsx)("footer",{className:f.footer,children:(0,l.jsxs)("div",{className:f.copyright,children:[(0,l.jsxs)("span",{children:["\xa9 ",i.date," ",t.name]},"date"),(0,l.jsx)("span",{children:t.motto},"motto")]})})]})]})},f={container:(0,c.iv)({['&[data-theme="'.concat(d.Q2.light,'"]')]:{...g},['&[data-theme="'.concat(d.Q2.darken,'"]')]:{...m},position:"relative",boxSizing:"border-box",display:"flex",flexDirection:"column",width:"100vw",minHeight:"100vh",background:o.colorBgBody}),header:(0,c.iv)({flex:"0 0 auto",alignItems:"center",display:"flex",boxSizing:"border-box",background:o.colorBgHeader}),title:(0,c.iv)({flex:"1 1 auto",color:"#696969",textAlign:"center",fontFamily:"'lucida grande', 'lucida sans unicode', lucida, helvetica, 'Hiragino Sans GB',\n          'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif",margin:"1rem 0"}),toolbarButtons:(0,c.iv)({flex:"0 0 auto",display:"flex",alignItems:"center"}),themeToggle:(0,c.iv)({marginRight:16,width:24,height:24}),authorAvatar:(0,c.iv)({marginRight:16,width:24,height:24}),main:(0,c.iv)({flex:"1 0 auto",boxSizing:"border-box",width:"100%",marginBottom:"2rem",background:o.colorBgBody}),footer:(0,c.iv)({flex:"0 0 auto",boxSizing:"border-box",width:"100%",padding:"1rem",lineHeight:"2",color:"hsla(0deg, 0%, 85%, 0.8)",background:"hsl(0deg, 0%, 20%)",fontSize:"max(0.8rem, 12px)",fontFamily:"'Andale Mono', 'lucida grande', 'lucida sans unicode', lucida, helvetica,\n        'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif",textShadow:"0 1px #333"}),content:(0,c.iv)({flex:"1 0 auto",boxSizing:"border-box",display:"flex",justifyContent:"center"}),copyright:(0,c.iv)({display:"flex",justifyContent:"space-between",maxWidth:400,margin:"auto",userSelect:"none"})}},49894:function(e,t,i){"use strict";i.d(t,{Z:function(){return g}});var r=i(85893),s=i(67294),n=i(18872),a=i(23191);let o={link:(0,n.iv)({padding:"0.2rem 0",color:a.TV.colorLink,textDecoration:"none",background:"linear-gradient(90deg, hsla(358deg, 100%, 62%, 0.8), hsla(048deg, 100%, 50%, 0.8), hsla(196deg, 100%, 53%, 0.8))",backgroundSize:"0 3px",backgroundRepeat:"no-repeat",backgroundPosition:"50% 100%",transition:"all 0.3s ease-in-out","&:visited":{color:a.TV.colorLink},"&&:hover":{color:a.TV.colorLinkHover,backgroundSize:"100% 3px",backgroundPositionX:0}})};class l extends s.PureComponent{render(){let{children:e,className:t,url:i,rel:s="noopener,noreferrer",target:a="_blank",title:l,...c}=this.props;return(0,r.jsx)("a",{...c,className:(0,n.cx)(o.link,t),href:i,title:l,target:a,rel:s,children:e})}}var c=i(24729);class d extends s.PureComponent{render(){let{children:e,className:t,url:i,title:s,...a}=this.props;return(0,r.jsx)(c.rU,{...a,className:(0,n.cx)(o.link,t),href:i,title:s,children:e})}}var p=i(45697),u=i.n(p);let h={url:u().string.isRequired,title:u().string,children:u().node,className:u().string,rel:u().string,style:u().object,target:u().string};class m extends s.PureComponent{render(){let{url:e,title:t,children:i}=this.props;return/^#/.test(e)?(0,r.jsx)("a",{title:t,href:e,children:i}):/^(\w+:[/]{2})/.test(e)?s.createElement(l,this.props):s.createElement(d,this.props)}}m.propTypes=h;var g=m},47399:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return tk}});var r,s,n,a,o,l,c,d,p,u,h,m,g=i(85893),v=i(45697),f=i.n(v),y=i(67294);let x="2023-07-25";(r=l||(l={})).FLIP_PLAYER="@gomoku/flip-player",r.MODIFY_PLAYER="@gomoku/modify-player",r.MODIFY_PREFERENCE="@gomoku/modify-preference",r.MOVE="@gomoku/move",r.PAUSE="@gomoku/pause",r.RESET="@gomoku/reset",r.RESTART="@gomoku/restart",r.RESUME="@gomoku/resume",r.RETRACT="@gomoku/retract",r.START="@gomoku/start",(s=c||(c={})).MOVE="move",s.RETRACT="retract",(n=d||(d={})).HUMAN="human",n.COMPUTER="computer",n.STUPID_COMPUTER="stupid-computer";var b=i(59976);let k=y.createContext(null);k.displayName="GomokuContextType";let N=()=>{let e=y.useContext(k);return e.dispatch},C=e=>{let t=y.useContext(k),i=e(t);return(0,b.vc)(i)};var R=i(34781),S=i(35369),w=i(26812);let P=w.a7.rightHalf,j=e=>e===d.COMPUTER||e===d.STUPID_COMPUTER;function I(e,t,i){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:5,s=new Int32Array(t*i).fill(-1);for(let{r:i,c:r,p:n}of e)s[i*t+r]=n;let n=(e,i)=>e*t+i,a=(e,r)=>e>=0&&e<t&&r>=0&&r<i;for(let e of P){let[o,l]=w.bs[e];for(let e=0;e<t;++e)for(let t=0;t<i;++t){let i=s[n(e,t)];if(i<0)continue;let c=1;for(let r=e+o,d=t+l;a(r,d)&&s[n(r,d)]===i;r+=o,d+=l)c+=1;if(c>=r){if(0!==i&&1!==i)throw Error("[checkWinner] Bad player(".concat(i,") on piece (").concat(e,", ").concat(t,")."));return i}}}return -1}class E{constructor(e){this.restart=()=>{let e=this.viewmodel,t=e.status$.getSnapshot();t!==R.X.PENDING&&(e.status$.next(R.X.PENDING),e.winner$.next(-1),e.mover$.next(0),e.pieces$.next(S.aV.of()),e.instructions$.next(S.aV.of()),e.gameTick$.setState(e=>e+1),e.attemptTick$.next(0))},this.reset=(e,t)=>{let i=this.viewmodel,r=i.status$.getSnapshot();r===R.X.PENDING&&(e&&i.MAX_ROW$.next(e),t&&i.MAX_COL$.next(t),i.status$.next(R.X.PENDING),i.winner$.next(-1),i.mover$.next(0),i.pieces$.next(S.aV.of()),i.instructions$.next(S.aV.of()),i.gameTick$.setState(e=>e+1),i.attemptTick$.next(0))},this.start=()=>{let e=this.viewmodel,t=e.status$.getSnapshot();t===R.X.PENDING&&e.status$.next(R.X.RUNNING)},this.pause=()=>{let e=this.viewmodel,t=e.status$.getSnapshot();t===R.X.RUNNING&&e.status$.next(R.X.PAUSED)},this.resume=()=>{let e=this.viewmodel,t=e.status$.getSnapshot();t===R.X.PAUSED&&e.status$.next(R.X.RUNNING)},this.move=(e,t)=>{let i=this.viewmodel,r=i.status$.getSnapshot();if(r!==R.X.RUNNING)return;let s=i.pieces$.getSnapshot();if(s.some(i=>i.r===e&&i.c===t))return;let n=i.MAX_ROW$.getSnapshot(),a=i.MAX_COL$.getSnapshot(),o=i.mover$.getSnapshot(),l={r:e,c:t,p:o},d=s.push(l),p=I(d,n,a),u=p>=0||d.size===n*a;u&&i.status$.next(R.X.END),i.winner$.next(p),i.pieces$.next(d),i.mover$.next(1^o),i.attemptTick$.setState(e=>e+1),i.instructions$.setState(e=>e.push({type:c.MOVE,payload:l,timestamp:new Date().toISOString()}))},this.retract=()=>{let e=this.viewmodel,t=e.status$.getSnapshot();if(t!==R.X.RUNNING&&t!==R.X.END)return;let i=e.mover$.getSnapshot(),r=e.pieces$.getSnapshot(),s=r.findLastIndex(e=>e.p===i);if(s<0)return;let n=r.size-s,a=r.slice(0,s),o=1&a.size;e.status$.next(R.X.RUNNING),e.pieces$.next(a),e.winner$.next(-1),e.mover$.next(o),e.attemptTick$.setState(e=>e+1),e.instructions$.setState(e=>e.push({type:c.RETRACT,payload:n,timestamp:new Date().toISOString()}))},this.flipPlayer=()=>{let e=this.viewmodel,t=e.status$.getSnapshot();if(t!==R.X.PENDING)return;let[i,r]=e.players$.getSnapshot();e.players$.next([r,i])},this.modifyPlayer=e=>{var t,i,r,s;let n=this.viewmodel,a=n.status$.getSnapshot();if(a===R.X.END)return;if(0!==e.id&&1!==e.id){console.error("[Bad action] modifyPlayer",e);return}let o=n.players$.getSnapshot()[e.id],l={name:e.name||o.name,type:e.type||o.type,preference:{pieceFillStyle:null!==(r=null===(t=e.preference)||void 0===t?void 0:t.pieceFillStyle)&&void 0!==r?r:o.preference.pieceFillStyle,pieceStrokeStyle:null!==(s=null===(i=e.preference)||void 0===i?void 0:i.pieceStrokeStyle)&&void 0!==s?s:o.preference.pieceStrokeStyle}};n.players$.setState(t=>t.map((t,i)=>i===e.id?l:t))},this.modifyPreference=e=>{let t=this.viewmodel,i=t.status$.getSnapshot();i!==R.X.END&&t.preference$.setState(t=>({...t,...e}))},this.viewmodel=e.viewmodel}}var T=i(83235),D=i(55402),M=i(54362),A=i(73062);let _={MAX_ROW:15,MAX_COL:15,status:R.X.PENDING,elapsedTime:0,winner:-1,mover:0,pieces:[],instructions:[],gameTick:0,attemptTick:0,players:[{name:"guanghechen",type:d.COMPUTER,preference:{pieceFillStyle:{prefer:"image",imageUrl:"/asset/img/gomoku/guanghechen.jpg"}}},{name:"wulala",type:d.HUMAN,preference:{pieceFillStyle:{prefer:"image",imageUrl:"/asset/img/gomoku/wulala.jpg"}}}],preference:{borderColor:{r:255,g:255,b:255,a:1},locatePointColor:{r:51,g:51,b:51,a:1},boardBackground:{prefer:"color",color:{r:230,g:226,b:222,a:1},imageUrl:"/asset/img/gomoku/board.jpg"}}};var $=i(73935);class O extends R.p{constructor(e){super(e),this.getSnapshot=()=>({status:this.status$.getSnapshot(),elapsedTime:this.elapsedTime$.getSnapshot(),MAX_ROW:this.MAX_ROW$.getSnapshot(),MAX_COL:this.MAX_COL$.getSnapshot(),winner:this.winner$.getSnapshot(),mover:this.mover$.getSnapshot(),pieces:Array.from(this.pieces$.getSnapshot()),instructions:Array.from(this.instructions$.getSnapshot()),gameTick:this.gameTick$.getSnapshot(),attemptTick:this.attemptTick$.getSnapshot(),players:this.players$.getSnapshot(),preference:this.preference$.getSnapshot()}),this.dispatch=e=>{let t=U[e.type];t?(0,$.unstable_batchedUpdates)(()=>{t(this._controller,e)}):console.error(this.constructor.name,"Bad action:",e)},this.MAX_ROW$=new b.ZM(e.MAX_ROW),this.MAX_COL$=new b.ZM(e.MAX_COL),this.winner$=new b.ZM(e.winner),this.mover$=new b.ZM(e.mover),this.pieces$=new b.ZM(S.aV.of(...e.pieces)),this.instructions$=new b.ZM(S.aV.of(...e.instructions)),this.gameTick$=new b.ZM(e.gameTick),this.attemptTick$=new b.ZM(e.attemptTick),this.players$=new b.ZM(e.players),this.preference$=new b.ZM(e.preference);let t=new E({viewmodel:this});this._controller=t}}let U={[l.RESTART]:e=>{e.restart()},[l.RESET]:(e,t)=>{var i;let{MAX_ROW:r,MAX_COL:s}=null!==(i=t.payload)&&void 0!==i?i:{};e.reset(r,s)},[l.START]:e=>{e.start()},[l.PAUSE]:e=>{e.pause()},[l.RESUME]:e=>{e.resume()},[l.RETRACT]:e=>{e.retract()},[l.MOVE]:(e,t)=>{let{r:i,c:r}=t.payload;e.move(i,r)},[l.FLIP_PLAYER]:e=>{e.flipPlayer()},[l.MODIFY_PLAYER]:(e,t)=>{let i=t.payload;e.modifyPlayer(i)},[l.MODIFY_PREFERENCE]:(e,t)=>{let i=t.payload;e.modifyPreference(i)}},q=(0,A.U)({displayName:"PersistentGomokuContextProvider",version:x,disposeWhenUnmounted:!0,Provider:k.Provider,Persistent:e=>{let{viewmodel:t,storage:i,storageKey:r}=e,s=(0,b.sD)(t,["MAX_ROW$","MAX_COL$","winner$","instructions$","gameTick$","players$","preference$"]),n=y.useMemo(()=>(0,T.P2)(()=>{let e={MAX_ROW:t.MAX_ROW$.getSnapshot(),MAX_COL:t.MAX_COL$.getSnapshot(),winner:t.winner$.getSnapshot(),instructions:Array.from(t.instructions$.getSnapshot()),gameTick:t.gameTick$.getSnapshot(),players:Array.from(t.players$.getSnapshot()),preference:t.preference$.getSnapshot()};return M.kg.log("saving ".concat(r,". data:"),e),i.save({version:x,data:e})},200),[t,i,r]);return y.useEffect(()=>void n(),[n,s]),(0,D.i7)(()=>n.flushSync(),!1),(0,g.jsx)(y.Fragment,{})},SideEffect:()=>(0,g.jsx)(y.Fragment,{}),ViewModel:O,initContextState:function(e){var t,i,r,s,n,a,o,l,d,p,u,h,m;let g=arguments.length>1&&void 0!==arguments[1]?arguments[1]:_,{MAX_ROW:v=g.MAX_ROW,MAX_COL:f=g.MAX_COL,instructions:y=g.instructions.slice(),gameTick:x=g.gameTick}={...e},b=function(e){let t=[];for(let i of e)switch(i.type){case c.RETRACT:t.splice(t.length-i.payload,i.payload);break;case c.MOVE:{let{r:e,c:r,p:s}=i.payload;t.push({r:e,c:r,p:s})}}return t}(y),k=I(b,v,f),N=1&b.length,C=k<0?y.length>0?R.X.PAUSED:R.X.PENDING:R.X.END,[S,w]=g.players,[P,j]=null!==(n=null==e?void 0:e.players)&&void 0!==n?n:[];return{elapsedTime:0,MAX_ROW:v,MAX_COL:f,status:C,winner:k,mover:N,pieces:b,instructions:y,gameTick:x,attemptTick:0,players:[{name:null!==(a=null==P?void 0:P.name)&&void 0!==a?a:S.name,type:null!==(o=null==P?void 0:P.type)&&void 0!==o?o:S.type,preference:{pieceFillStyle:null!==(l=null==P?void 0:null===(t=P.preference)||void 0===t?void 0:t.pieceFillStyle)&&void 0!==l?l:S.preference.pieceFillStyle,pieceStrokeStyle:null!==(d=null==P?void 0:null===(i=P.preference)||void 0===i?void 0:i.pieceStrokeStyle)&&void 0!==d?d:S.preference.pieceStrokeStyle}},{name:null!==(p=null==j?void 0:j.name)&&void 0!==p?p:w.name,type:null!==(u=null==j?void 0:j.type)&&void 0!==u?u:w.type,preference:{pieceFillStyle:null!==(h=null==j?void 0:null===(r=j.preference)||void 0===r?void 0:r.pieceFillStyle)&&void 0!==h?h:w.preference.pieceFillStyle,pieceStrokeStyle:null!==(m=null==j?void 0:null===(s=j.preference)||void 0===s?void 0:s.pieceStrokeStyle)&&void 0!==m?m:w.preference.pieceStrokeStyle}}],preference:(0,M.wT)(g.preference,null==e?void 0:e.preference)}}});var X=i(18872);p||(p={}),(a=u||(u={})).colorBgOverlay="--colorBgOverlay",a.colorButton="--colorButton",a.colorOverlayEnd="--colorOverlayEnd",a.colorPlayerName="--colorPlayerName",a.colorPlayerType="--colorPlayerType",a.colorThinkingIcon="--colorThinkingIcon",a.colorVersus="--colorVersus",a.colorWinnerName="--colorWinnerName",(o=h||(h={}))[o.colorBgOverlay="var(--colorBgOverlay)"]="colorBgOverlay",o[o.colorButton="var(--colorButton)"]="colorButton",o[o.colorOverlayEnd="var(--colorOverlayEnd)"]="colorOverlayEnd",o[o.colorPlayerName="var(--colorPlayerName)"]="colorPlayerName",o[o.colorPlayerType="var(--colorPlayerType)"]="colorPlayerType",o[o.colorThinkingIcon="var(--colorThinkingIcon)"]="colorThinkingIcon",o[o.colorVersus="var(--colorVersus)"]="colorVersus",o[o.colorWinnerName="var(--colorWinnerName)"]="colorWinnerName";var B=i(26692);class F extends y.Component{shouldComponentUpdate(e){let t=this.props;return t.colon!==e.colon||!(0,B.Z)(t.data,e.data)||!(0,B.Z)(t.items,e.items)||!(0,B.Z)(t.itemsOrder,e.itemsOrder)||!(0,B.Z)(t.classes,e.classes)}render(){var e,t,i;let{onChange:r}=this,{data:s,items:n,itemsOrder:a,colon:o}=this.props,l={formItem:(0,X.cx)(G.formItem,null===(e=this.props.classes)||void 0===e?void 0:e.formItem),label:(0,X.cx)(G.label,null===(t=this.props.classes)||void 0===t?void 0:t.label),content:(0,X.cx)(G.content,null===(i=this.props.classes)||void 0===i?void 0:i.content)},c=a.map(e=>{let t=n[e],{FormItemRenderer:i}=t;return(0,g.jsxs)("div",{className:l.formItem,children:[(0,g.jsxs)("div",{className:l.label,children:[t.label,o]}),(0,g.jsx)("div",{className:l.content,children:(0,g.jsx)(i,{value:s[e],onChange:t=>r(e,t)})})]},e)});return(0,g.jsx)(y.Fragment,{children:c})}constructor(...e){super(...e),this.onChange=(e,t)=>{this.props.onChange({[e]:t})}}}F.displayName="Form",F.propTypes={data:f().object.isRequired,items:f().object.isRequired,itemsOrder:f().array.isRequired,classes:f().object,colon:f().node,onChange:f().func.isRequired};let G={formItem:(0,X.iv)({display:"flex",alignItems:"flex-start"}),label:(0,X.iv)({flex:"0 1 auto",display:"inline-flex",justifyContent:"flex-end",alignItems:"flex-start",marginRight:8,userSelect:"none",height:"100%"}),content:(0,X.iv)({flex:"1 1 auto",display:"inline-flex",justifyContent:"flex-start",alignItems:"flex-start",height:"100%"})};var Z=i(78262),V=i(9581),W=i(31425),L=i(83321);class z extends y.Component{static getDerivedStateFromProps(e,t){let i=(0,M.ei)(e.data,e.keys);return(0,B.Z)(i,t.value)?null:{value:i}}shouldComponentUpdate(e,t){let i=this.props,r=this.state;return r.value!==t.value||i.FormItemGroupRenderer!==e.FormItemGroupRenderer||!(0,B.Z)(i.keys,e.keys)}render(){let{onChange:e}=this,{FormItemGroupRenderer:t}=this.props,{value:i}=this.state;return(0,g.jsx)(t,{data:i,onChange:e})}constructor(e){super(e),this.onChange=e=>{this.props.onChange(e)},this.state={value:(0,M.ei)(e.data,e.keys)}}}z.displayName="FormItemGroup",z.propTypes={data:f().object.isRequired,keys:f().array.isRequired,FormItemGroupRenderer:f().any.isRequired,onChange:f().func.isRequired};class H extends y.Component{shouldComponentUpdate(e,t){let i=this.props,r=this.state;return r.isNoChangeWithFactoryData!==t.isNoChangeWithFactoryData||r.isNoChangeWithInitialData!==t.isNoChangeWithInitialData||!(0,B.Z)(r.data,t.data)||i.container!==e.container||i.isResetAvailable!==e.isResetAvailable||i.formItemGroups!==e.formItemGroups||!(0,B.Z)(i.classes,e.classes)||!(0,B.Z)(i.factoryData,e.factoryData)}render(){var e;let{onConfirm:t,onDiscard:i,onChange:r,onReset:s,onClose:n}=this,{container:a,formItemGroups:o,isResetAvailable:l=!0}=this.props,{data:c,isNoChangeWithFactoryData:d,isNoChangeWithInitialData:p}=this.state,u={dialog:(0,X.cx)(Y.dialog,null===(e=this.props.classes)||void 0===e?void 0:e.dialog)},h=o.map((e,t)=>(0,g.jsx)(z,{data:c,keys:e.keys,FormItemGroupRenderer:e.FormItemGroupRenderer,onChange:r},t));return(0,g.jsxs)(y.Fragment,{children:[(0,g.jsxs)(Z.Z,{"aria-labelledby":"edit-player",container:a,open:!0,onClose:n,children:[(0,g.jsx)(V.Z,{className:u.dialog,children:h}),(0,g.jsxs)(W.Z,{children:[null!=this.props.factoryData&&(0,g.jsx)(L.Z,{color:"inherit",disabled:!l||d,onClick:s,children:"Reset"}),(0,g.jsx)(L.Z,{color:"inherit",onClick:i,children:"Discard"}),(0,g.jsx)(L.Z,{color:"primary",disabled:p,onClick:t,children:"Save"})]})]}),(0,g.jsx)(K,{beforeUnload:i})]})}updateData(e){var t;let i=this.state.initialData,r=null!==(t=this.props.factoryData)&&void 0!==t?t:i,s=(0,B.Z)(i,e),n=(0,B.Z)(r,e);this.setState({data:e,isNoChangeWithFactoryData:n,isNoChangeWithInitialData:s})}constructor(e){var t;super(e),this.onConfirm=()=>{let{data:e}=this.state;this.props.onSave(e)},this.onDiscard=()=>{let{initialData:e}=this.state;this.props.onDiscard(e)},this.onChange=e=>{var t,i;let r={...this.state.data,...e};this.updateData(r),null===(t=(i=this.props).onRealTimeChange)||void 0===t||t.call(i,r)},this.onReset=()=>{var e,t,i,r,s;let n=null!==(s=this.props.factoryData)&&void 0!==s?s:this.state.initialData,a={...n};this.updateData(a),null===(e=(t=this.props).onReset)||void 0===e||e.call(t),null===(i=(r=this.props).onRealTimeChange)||void 0===i||i.call(r,a)},this.onClose=()=>{let{isNoChangeWithInitialData:e}=this.state;e&&this.props.onDiscard(this.state.initialData)},this.state={initialData:e.initialData,data:e.initialData,isNoChangeWithFactoryData:(0,B.Z)(null!==(t=e.factoryData)&&void 0!==t?t:e.initialData,e.initialData),isNoChangeWithInitialData:!0}}}H.displayName="FormDialog",H.propTypes={initialData:f().object.isRequired,factoryData:f().object,isResetAvailable:f().bool,formItemGroups:f().array.isRequired,container:f().any,classes:f().object,onSave:f().func.isRequired,onDiscard:f().func.isRequired,onReset:f().func,onRealTimeChange:f().func};let Y={dialog:(0,X.iv)({minWidth:240,minHeight:300})},K=e=>((0,D.TK)(()=>void e.beforeUnload(),[]),(0,g.jsx)(y.Fragment,{}));var Q=i(94054),J=i(72890),ee=i(52465),et=i(36872),ei=i(30780);class er extends y.Component{shouldComponentUpdate(e,t){let i=this.props,r=this.state;return r.prefer!==t.prefer||i.imageInputId!==e.imageInputId||i.background!==e.background||i.visible!==e.visible||i.disabled!==e.disabled||i.className!==e.className}render(){let{onClosePicker:e,onColorChange:t,onImageChange:i,onPickerClicked:r,onPreferChange:s}=this,{imageInputId:n,background:a,visible:o,className:l}=this.props,{prefer:c}=this.state;return(0,g.jsxs)("div",{className:(0,X.cx)(es.container,!o&&es.invisible,l),onClick:r,children:[(0,g.jsx)("div",{className:es.cover,onClick:e}),(0,g.jsxs)("div",{className:es.backgroundPicker,children:[(0,g.jsx)("div",{className:es.backgroundPrefer,children:(0,g.jsx)(Q.Z,{style:{display:"flex",justifyContent:"center"},children:(0,g.jsxs)(J.Z,{className:es.backgroundRadioGroup,value:c,onChange:s,children:[(0,g.jsx)(ee.Z,{value:"color",control:(0,g.jsx)(et.Z,{}),label:"color"}),(0,g.jsx)(ee.Z,{value:"image",control:(0,g.jsx)(et.Z,{}),label:"image"})]})})}),(0,g.jsxs)("div",{children:[(0,g.jsx)("div",{className:(0,X.cx)(es.colorPickerWrapper,"color"!==c&&es.invisible),onDoubleClick:e,children:(0,g.jsx)(ei.xS,{className:es.colorPicker,color:a.color,onChange:t})}),(0,g.jsxs)("div",{className:(0,X.cx)(es.imagePickerWrapper,"image"!==c&&es.invisible),children:[(0,g.jsx)("input",{type:"file",accept:"image/*",id:n,style:{display:"none"},multiple:!1,disabled:this.props.disabled,onChange:i}),(0,g.jsx)("label",{htmlFor:n,children:(0,g.jsx)(L.Z,{className:es.imageUploadBtn,variant:"contained",component:"span",children:(0,g.jsx)("img",{alt:"background",src:a.imageUrl})})})]})]})]})]})}constructor(e){super(e),this.onClosePicker=()=>{this.props.onVisibleChange(!1)},this.onColorChange=e=>{if(this.props.disabled)return;let{background:t,onBackgroundChange:i}=this.props,r={prefer:"color",imageUrl:t.imageUrl,color:e.rgb};i(r)},this.onImageChange=e=>{if(this.props.disabled)return;let{background:t,onBackgroundChange:i}=this.props,r=e.target.files;if(null!==r){let e=new FileReader;e.readAsDataURL(r[0]),e.onload=e=>{var r;let s=null===(r=e.target)||void 0===r?void 0:r.result;if(null!=s){let e={prefer:"image",color:t.color,imageUrl:String(s)};i(e)}}}},this.onPickerClicked=e=>{e.stopPropagation()},this.onPreferChange=(e,t)=>{if(t!==this.state.prefer){let{background:e,onBackgroundChange:i}=this.props;this.setState({prefer:t}),("color"===t&&e.color||"image"===t&&e.imageUrl)&&i({prefer:t,color:e.color,imageUrl:e.imageUrl})}},this.state={prefer:e.background.prefer}}}er.displayName="BackgroundPickerComponent",er.propTypes={imageInputId:f().string.isRequired,background:f().any.isRequired,visible:f().bool.isRequired,disabled:f().bool.isRequired,className:f().string,onVisibleChange:f().func.isRequired,onBackgroundChange:f().func.isRequired};let es={container:(0,X.iv)({position:"absolute",zIndex:20,top:"20px"}),invisible:(0,X.iv)({"&&":{display:"none",visibility:"hidden"}}),cover:(0,X.iv)({position:"fixed",top:"0px",right:"0px",bottom:"0px",left:"0px",cursor:"default"}),backgroundPicker:(0,X.iv)({display:"flex",flexDirection:"column",minWidth:"220px",border:"1px solid #e6e6e6",borderRadius:"4px",boxShadow:"rgba(0, 0, 0, 0.15) 0px 0px 0px 1px, rgba(0, 0, 0, 0.15) 0px 8px 16px",background:"#fff"}),backgroundPrefer:(0,X.iv)({flex:"0 0 auto",borderBottom:"1px solid rgba(0, 0, 0, 0.15)",userSelect:"none"}),backgroundRadioGroup:(0,X.iv)({"&&":{display:"flex",flexDirection:"row",justifyContent:"center"}}),imagePickerWrapper:(0,X.iv)({boxSizing:"border-box",display:"flex",justifyContent:"center",alignItems:"center",width:"220px",height:"220px","& img":{display:"inline-block",width:"200px",height:"200px"}}),colorPickerWrapper:(0,X.iv)({display:"block"}),colorPicker:(0,X.iv)({border:"none !important",borderRadius:"0px !important",boxShadow:"none !important"}),imageUploadBtn:(0,X.iv)({"&&":{background:"none",padding:"0px",margin:"0px"}})},en=e=>{let{background:t,visible:i,disabled:r,className:s,onBackgroundChange:n,onVisibleChange:a}=e,o=y.useId();return(0,g.jsx)(er,{imageInputId:o,background:t,visible:i,disabled:r,className:s,onBackgroundChange:n,onVisibleChange:a})};class ea extends y.Component{shouldComponentUpdate(e){let t=this.props;return t.visible!==e.visible||t.color!==e.color||t.className!==e.className}render(){let{color:e,visible:t,className:i}=this.props,{onColorChange:r,onClosePicker:s}=this;return(0,g.jsxs)("div",{className:(0,X.cx)(eo.container,!t&&eo.invisible,i),children:[(0,g.jsx)("div",{className:eo.cover,onClick:s}),(0,g.jsx)("div",{className:eo.picker,onDoubleClick:s,children:(0,g.jsx)(ei.xS,{className:eo.colorPicker,color:e,onChange:r})})]})}constructor(...e){super(...e),this.onColorChange=e=>{this.props.onColorChange(e.rgb)},this.onClosePicker=()=>{this.props.onVisibleChange(!1)}}}ea.displayName="ColorPicker",ea.propTypes={visible:f().bool.isRequired,color:f().any.isRequired,className:f().string,onVisibleChange:f().func.isRequired,onColorChange:f().func.isRequired};let eo={container:(0,X.iv)({position:"absolute",zIndex:20,top:"20px",display:"block",visibility:"visible"}),invisible:(0,X.iv)({"&&":{display:"none",visibility:"hidden"}}),cover:(0,X.iv)({position:"fixed",top:0,right:0,bottom:0,left:0}),picker:(0,X.iv)({display:"flex",flexDirection:"column",minWidth:"220px",border:"1px solid #e6e6e6",borderRadius:"4px",boxShadow:"rgba(0, 0, 0, 0.15) 0px 0px 0px 1px, rgba(0, 0, 0, 0.15) 0px 8px 16px",background:"#fff"}),colorPicker:(0,X.iv)({border:"none !important",borderRadius:"0 !important",boxShadow:"none !important",caretColor:"transparent"})};class el extends y.Component{shouldComponentUpdate(e,t){let i=this.props,r=this.state;return r.isPickerVisible!==t.isPickerVisible||i.value!==e.value||i.disabled!==e.disabled||i.required!==e.required}render(){let{onToggleVisible:e,onVisibleChange:t,onBackgroundChange:i}=this,{value:r,disabled:s=!1}=this.props,{isPickerVisible:n}=this.state,a=ec(r,s);return(0,g.jsxs)("div",{className:a.container,children:[(0,g.jsx)("div",{className:a.swatch,onClick:e,children:(0,g.jsx)("div",{className:a.colorSquare})}),(0,g.jsx)(en,{className:a.picker,visible:n,disabled:s,background:r,onVisibleChange:t,onBackgroundChange:i})]})}constructor(e){super(e),this.onToggleVisible=()=>{this.props.disabled||this.setState(e=>({isPickerVisible:!e.isPickerVisible}))},this.onVisibleChange=e=>{this.setState({isPickerVisible:e})},this.onBackgroundChange=e=>{this.props.disabled||this.props.onChange(e)},this.state={isPickerVisible:!1}}}el.displayName="FormItemBackground",el.propTypes={value:f().object.isRequired,disabled:f().bool,required:f().bool,onChange:f().func.isRequired};let ec=(e,t)=>({container:(0,X.iv)({display:"flex",alignItems:"center",caretColor:"transparent"}),swatch:(0,X.iv)({display:"inline-block",padding:3,border:"1px solid rgba(0,0,0,.2)",borderRadius:"1px",background:"#fff",cursor:t?"default":"pointer"}),colorSquare:(0,X.iv)("image"===e.prefer?{width:32,height:32,borderRadius:2,background:(0,M.l9)(e),backgroundSize:"cover"}:{width:32,height:12,borderRadius:2,background:(0,M.l9)(e),backgroundSize:"cover"}),picker:(0,X.iv)({"&&":{left:30}})});class ed extends y.Component{shouldComponentUpdate(e,t){let i=this.props,r=this.state;return r.isPickerVisible!==t.isPickerVisible||i.value!==e.value||i.disabled!==e.disabled||i.required!==e.required}render(){let{onToggleVisible:e,onVisibleChange:t,onColorChange:i}=this,{value:r,disabled:s}=this.props,{isPickerVisible:n}=this.state,a=ep(r,s);return(0,g.jsxs)("div",{className:a.container,children:[(0,g.jsx)("div",{className:a.swatch,onClick:e,children:(0,g.jsx)("div",{className:a.colorSquare})}),(0,g.jsx)(ea,{className:a.picker,visible:n,color:r,onVisibleChange:t,onColorChange:i})]})}constructor(e){super(e),this.onToggleVisible=()=>{this.props.disabled||this.setState(e=>({isPickerVisible:!e.isPickerVisible}))},this.onVisibleChange=e=>{this.setState({isPickerVisible:e})},this.onColorChange=e=>{this.props.disabled||this.props.onChange(e)},this.state={isPickerVisible:!1}}}ed.displayName="FormItemColor",ed.propTypes={value:f().object.isRequired,disabled:f().bool,required:f().bool,onChange:f().func.isRequired};let ep=(e,t)=>({container:(0,X.iv)({display:"flex",alignItems:"center",caretColor:"transparent"}),swatch:(0,X.iv)({display:"inline-block",padding:3,border:"1px solid rgba(0,0,0,.2)",borderRadius:"1px",background:"#fff",cursor:t?"default":"pointer"}),colorSquare:(0,X.iv)({width:32,height:12,borderRadius:2,backgroundColor:(0,M.xv)(e)}),picker:(0,X.iv)({"&&":{left:30}})});var eu=i(55819),eh=i(45018);class em extends y.Component{shouldComponentUpdate(e){let t=this.props;return t.value!==e.value||t.disabled!==e.disabled||t.required!==e.required||!(0,B.Z)(t.choices,e.choices)}render(){let{onChange:e}=this,{value:t,choices:i,disabled:r,required:s}=this.props,n=Array.isArray(i)?i.map(e=>(0,g.jsx)(eu.Z,{value:e,children:e},e)):Object.keys(i).map(e=>(0,g.jsx)(eu.Z,{value:e,children:i[e]},e));return(0,g.jsx)(eh.Z,{variant:"standard",required:s,disabled:r,value:t,onChange:e,children:n})}constructor(...e){super(...e),this.onChange=e=>{let{normalize:t,onChange:i}=this.props,r=t?t(e.target.value):e.target.value;i(r)}}}em.displayName="FormItemEnum",em.propTypes={value:f().any.isRequired,choices:f().any.isRequired,disabled:f().bool,required:f().bool,onChange:f().func.isRequired,normalize:f().func};var eg=i(98271);class ev extends y.Component{shouldComponentUpdate(e,t){let i=this.props,r=this.state;return r.value!==t.value||i.value!==e.value||i.disabled!==e.disabled||i.required!==e.required}render(){let{onChange:e,onBlur:t}=this,{disabled:i,required:r}=this.props,{value:s}=this.state;return(0,g.jsx)(eg.Z,{variant:"standard",disabled:i,required:r,value:s,onChange:e,onBlur:t})}componentDidUpdate(e){let t=this.props,i=this.state;t.value!==e.value&&i.value!==t.value&&this.setState({value:t.value})}constructor(e){super(e),this.onChange=e=>{this.setState({value:e.target.value})},this.onBlur=()=>{this.props.onChange(this.state.value)},this.state={value:e.value}}}ev.displayName="FormItemString",ev.propTypes={value:f().string.isRequired,disabled:f().bool,required:f().bool,onChange:f().func.isRequired};let ef=[d.HUMAN,d.COMPUTER,d.STUPID_COMPUTER],ey=["name","type","pieceFill"],ex={name:{label:"Name",FormItemRenderer:e=>{let t=C(e=>e.status$),i=t===R.X.END;return(0,g.jsx)(ev,{...e,disabled:i})}},type:{label:"Type",FormItemRenderer:e=>{let t=C(e=>e.status$),i=t!==R.X.PENDING;return(0,g.jsx)(em,{...e,disabled:i,choices:ef})}},pieceFill:{label:"Avatar",FormItemRenderer:e=>{let t=C(e=>e.status$),i=t===R.X.END;return(0,g.jsx)(el,{...e,disabled:i})}}};class eb extends y.Component{shouldComponentUpdate(e){let t=this.props;return!(0,B.Z)(t.data,e.data)}render(){let{onChange:e}=this,{data:t}=this.props;return(0,g.jsx)(F,{data:t,items:ex,itemsOrder:ey,classes:eN,onChange:e})}constructor(...e){super(...e),this.onChange=e=>{this.props.onChange(e)}}}eb.displayName="PlayerSettingsRenderer",eb.propTypes={data:f().object.isRequired,onChange:f().func.isRequired};let ek={keys:ey,FormItemGroupRenderer:eb},eN={formItem:(0,X.iv)({margin:"1rem 1rem",alignItems:"center"}),label:(0,X.iv)({minWidth:"6rem"})},eC=e=>{let{playerId:t}=e,i=N(),r=C(e=>e.status$),s=C(e=>e.players$)[t],n=y.useMemo(()=>{let e=_.players[t];return{name:e.name,type:e.type,pieceFill:e.preference.pieceFillStyle,pieceStroke:e.preference.pieceStrokeStyle}},[t]),a=y.useMemo(()=>({name:s.name,type:s.type,pieceFill:s.preference.pieceFillStyle,pieceStroke:s.preference.pieceStrokeStyle}),[s]),o=y.useMemo(()=>[ek],[]),c=r===R.X.END,d={onRealTimeChange:(0,D.$0)(e=>{i({type:l.MODIFY_PLAYER,payload:{id:t,type:e.type,name:e.name,preference:(0,M.S4)({pieceFillStyle:e.pieceFill,pieceStrokeStyle:e.pieceStroke})}})}),onSave:t=>{d.onRealTimeChange(t),e.onClose()},onDiscard:(0,D.$0)(t=>{d.onRealTimeChange(t),e.onClose()})};return(0,g.jsx)(y.Fragment,{children:e.visible&&(0,g.jsx)(H,{container:e.containerRef.current,initialData:a,factoryData:n,isResetAvailable:!c,formItemGroups:o,classes:eR,onSave:d.onSave,onDiscard:d.onDiscard,onRealTimeChange:d.onRealTimeChange})})},eR={dialog:(0,X.iv)({minWidth:240,minHeight:400})};var eS=i(8802);class ew extends y.Component{shouldComponentUpdate(e,t){let i=this.props,r=this.state;return r.isPickerVisible!==t.isPickerVisible||i.position!==e.position||i.name!==e.name||i.type!==e.type||i.disabled!==e.disabled||i.thinking!==e.thinking||i.running!==e.running||i.avatar!==e.avatar||i.className!==e.className}render(){let{onAvatarClick:e,onAvatarChange:t,onVisibleChange:i,onEdit:r}=this,{name:s,type:n,avatar:a,className:o}=this.props,{isPickerVisible:l}=this.state,c=eP(this.props.position,this.props.avatar,this.props.disabled,this.props.thinking,this.props.running);return(0,g.jsxs)("div",{className:(0,X.cx)(c.container,o),onClick:r,children:[(0,g.jsxs)("div",{className:c.userWrapper,children:[(0,g.jsx)("span",{className:c.name,children:s}),(0,g.jsx)("span",{className:c.type,children:n})]}),(0,g.jsx)("div",{className:c.avatar,onClick:e,children:(0,g.jsx)(eS.Z,{className:c.thinkingIcon})}),(0,g.jsx)(en,{className:c.picker,visible:l,disabled:this.props.disabled,background:a,onVisibleChange:i,onBackgroundChange:t})]})}constructor(e){super(e),this.onAvatarClick=e=>{e.stopPropagation(),this.setState({isPickerVisible:!0})},this.onAvatarChange=e=>{this.props.onAvatarChange(e)},this.onVisibleChange=e=>{this.setState({isPickerVisible:e})},this.onEdit=()=>{this.props.onEdit()},this.state={isPickerVisible:!1}}}ew.displayName="$DuelPlayer",ew.propTypes={position:f().oneOf(["left","right"]).isRequired,name:f().string.isRequired,type:f().string.isRequired,disabled:f().bool.isRequired,thinking:f().bool.isRequired,running:f().bool.isRequired,avatar:f().object.isRequired,className:f().string,onEdit:f().func.isRequired,onAvatarChange:f().func.isRequired};let eP=(e,t,i,r,s)=>({container:(0,X.iv)({position:"relative",display:"flex",flexDirection:"left"===e?"row":"row-reverse",justifyContent:"flex-end",alignItems:"center",lineHeight:"16px",cursor:i?"default":"pointer"}),avatar:(0,X.iv)({position:"relative",width:32,height:32,borderRadius:"50%",margin:"left"===e?"0 0 0 6px":"0 6px 0 0",background:(0,M.l9)(t),backgroundSize:"cover"}),userWrapper:(0,X.iv)({display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"left"===e?"flex-end":"flex-start",lineHeight:"16px"}),name:(0,X.iv)({display:"flex",alignItems:"center",color:h.colorPlayerName,fontWeight:"bold",fontSize:16,userSelect:"none"}),thinkingIcon:(0,X.iv)({"&&":{position:"absolute",top:0,left:"left"===e?void 0:-20,right:"left"===e?-20:void 0,display:"inline-block",visibility:r?"visible":"hidden",transition:"translate(0, -50%)",width:16,height:16,color:h.colorThinkingIcon,userSelect:"none",animation:s?"1s ease-in 0s ".concat(ej.thinkingIcon," infinite alternate both"):void 0}}),type:(0,X.iv)({margin:"4px 0",color:h.colorPlayerType,fontSize:14,userSelect:"none"}),picker:(0,X.iv)({"&&":"left"===e?{top:48,left:16}:{top:48,left:"unset",right:16}})}),ej={thinkingIcon:(0,X.F4)({"0%":{transform:"rotate(-30deg) scale(1.0)"},"50%":{transform:"rotate(0deg) scale(1.2)"},"100%":{transform:"rotate(30deg) scale(1.0)"}})};class eI extends y.Component{shouldComponentUpdate(e,t){let i=this.props,r=this.state;return r.editingPlayerId!==t.editingPlayerId||i.containerRef!==e.containerRef||i.status!==e.status||i.mover!==e.mover||i.players!==e.players}render(){let{onCancel:e,onEditPlayer0:t,onEditPlayer1:i,onPlayer0AvatarChange:r,onPlayer1AvatarChange:s}=this,{containerRef:n,status:a,mover:o,players:l}=this.props,{editingPlayerId:c}=this.state,[d,p]=l,u=a===R.X.RUNNING,h=a===R.X.PENDING;return(0,g.jsxs)("div",{className:eE.container,children:[(0,g.jsx)(ew,{position:"left",className:eE.player0,name:d.name,type:d.type,avatar:d.preference.pieceFillStyle,disabled:!h,running:u,thinking:0===o,onEdit:t,onAvatarChange:r},"player0"),(0,g.jsx)("span",{className:eE.versus,children:"VS"}),(0,g.jsx)(ew,{position:"right",className:eE.player1,name:p.name,type:p.type,avatar:p.preference.pieceFillStyle,disabled:!h,running:u,thinking:1===o,onEdit:i,onAvatarChange:s},"player1"),null!=c&&(0,g.jsx)(eC,{containerRef:n,visible:!0,playerId:c,onClose:e})]})}constructor(e){super(e),this.onCancel=()=>{this.setState({editingPlayerId:null})},this.onEditPlayer0=()=>{this.setState({editingPlayerId:0})},this.onEditPlayer1=()=>{this.setState({editingPlayerId:1})},this.onPlayer0AvatarChange=e=>{let{dispatchGomokuAction:t}=this.props;t({type:l.MODIFY_PLAYER,payload:{id:0,preference:{pieceFillStyle:e}}})},this.onPlayer1AvatarChange=e=>{let{dispatchGomokuAction:t}=this.props;t({type:l.MODIFY_PLAYER,payload:{id:1,preference:{pieceFillStyle:e}}})},this.state={editingPlayerId:null}}}eI.displayName="$DuelPlayers",eI.propTypes={containerRef:f().object.isRequired,status:f().number.isRequired,mover:f().number.isRequired,players:f().array.isRequired,dispatchGomokuAction:f().func.isRequired};let eE={container:(0,X.iv)({display:"flex",alignItems:"center",maxWidth:"min(90vw, 400px)",height:"3rem",width:"100%",margin:"auto"}),player0:(0,X.iv)({flex:"1 1 0",display:"flex"}),player1:(0,X.iv)({flex:"1 1 0",display:"flex"}),versus:(0,X.iv)({flex:"0 0 auto",margin:"0 36px",color:h.colorVersus})},eT=e=>{let t=N(),i=C(e=>e.status$),r=C(e=>e.mover$),s=C(e=>e.players$);return(0,g.jsx)(eI,{containerRef:e.containerRef,status:i,mover:r,players:s,dispatchGomokuAction:t})};var eD=i(94101);class eM{init(e){var t;this.canvas=e,window.addEventListener("resize",this.onresize),null===(t=this.canvas)||void 0===t||t.addEventListener("click",this.onclick),this.onresize()}reset(e){null!=e.GOMOKU_SIZE&&(this.GOMOKU_SIZE=e.GOMOKU_SIZE),null!=e.pieceDrawer&&(this.pieceDrawer=e.pieceDrawer),null!=e.styles&&(this.styles={...this.styles,...e.styles}),this.canvas!==e.canvas&&(console.log("destroying canvas"),this.destroy(),this.init(e.canvas)),this.onresize()}destroy(){var e;window.removeEventListener("resize",this.onresize),null===(e=this.canvas)||void 0===e||e.removeEventListener("click",this.onclick)}async draw(e){let{_drawingStatus:t}=this;if(t.drawing){t.requesting=!0,t.requestData=[e];return}t.drawing=!0,this.pieces=e;try{let{canvas:e,bufferCanvas:t}=this,i=null==e?void 0:e.getContext("2d");if(null==e||null==i)return;let{width:r,height:s}=e;t.width=r,t.height=s;let n=t.getContext("2d");null!=n?(n.clearRect(0,0,r,s),await this._drawAll(n),i.clearRect(0,0,r,s),i.drawImage(t,0,0)):(i.clearRect(0,0,r,s),await this._drawAll(i))}finally{t.drawing=!1,t.requesting&&(t.requesting=!1,await this.draw(...t.requestData))}}async _drawAll(e){this._drawBoard(e),this._drawLocatePoints(e),await this._drawPieces(e),this._drawLastPlacedHighlight(e),this._drawActivatedCellHighlight(e)}_drawBoard(e){let{lineWidth:t,farTop:i,farRight:r,farBottom:s,farLeft:n,gridSize:a,styles:o}=this,l=a+t;e.lineWidth=t,e.strokeStyle=o.gridLineColor,e.beginPath();for(let t=i;t<=s;t+=l)e.moveTo(t,n),e.lineTo(t,r);for(let t=n;t<=r;t+=l)e.moveTo(i,t),e.lineTo(s,t);e.closePath(),e.stroke()}_drawLocatePoints(e){let{lineWidth:t,GOMOKU_SIZE:i,styles:r}=this,s=i-1>>1,n=s%4==0?4:s%4,a=t+6>>1;e.fillStyle=r.locatePointColor;for(let t=n;t+1<i;t+=4)for(let r=n;r+1<i;r+=4){let{x:i,y:s}=this.position(t,r);e.beginPath(),e.arc(i,s,a,0,eD.QA,!1),e.closePath(),e.stroke(),e.fill()}}async _drawPieces(e){if(null==this.pieceDrawer)return;let{GOMOKU_SIZE:t,pieceDrawer:i,pieceRadius:r,pieces:s}=this,n=[],a=[];for(let{r:e,c:i,p:r}of s)if(e>=0&&e<t&&i>=0&&i<t){let t=this.position(e,i);0===r?n.push(t):1===r&&a.push(t)}await Promise.allSettled([i.drawPieces(e,0,r,n),i.drawPieces(e,1,r,a)])}_drawLastPlacedHighlight(e){let t=this.pieces.get(-1);if(void 0===t)return;let{r:i,c:r}=t,{GOMOKU_SIZE:s,pieceRadius:n,activateCell:a}=this;if((i!==a.r||r!==a.c)&&i>=0&&i<s&&r>=0&&r<s){let{x:t,y:s}=this.position(i,r);e.setLineDash([5,3]),e.lineWidth=1,e.strokeStyle="#c80000",e.beginPath(),e.arc(t,s,n+4,0,eD.QA,!1),e.closePath(),e.stroke(),e.setLineDash([])}}_drawActivatedCellHighlight(e){let{GOMOKU_SIZE:t,activateCell:i,pieceRadius:r}=this,{r:s,c:n}=i;if(s>=0&&s<t&&n>=0&&n<t){let{x:t,y:i}=this.position(s,n);e.setLineDash([5,3]),e.lineWidth=1,e.strokeStyle="blue",e.beginPath(),e.arc(t,i,r+4,0,eD.QA,!1),e.closePath(),e.stroke(),e.setLineDash([])}}locate(e,t){let{GOMOKU_SIZE:i,pieceRadius:r}=this,s=this.gridSize+this.lineWidth,n=e-this.farLeft,a=t-this.farTop,o=Math.floor(a/s),l=Math.floor(n/s),c=n-l*s,d=a-o*s;return 2*c>s&&(l+=1,c=s-c),2*d>s&&(o+=1,d=s-d),o>=0&&o<i&&l>=0&&l<i&&Math.abs(c)<=r&&Math.abs(d)<=r?{r:o,c:l}:{r:-1,c:-1}}position(e,t){let{lineWidth:i,gridSize:r,farLeft:s,farTop:n}=this,a=r+i;return{x:s+t*a,y:n+e*a}}updateActivateCell(e,t){this.activateCell.r=e,this.activateCell.c=t,this.draw(this.pieces)}constructor(e){var t,i,r,s,n;this.canvas=null,this.pieceDrawer=null,this.pieceRadius=0,this.gridSize=0,this.farTop=0,this.farRight=0,this.farBottom=0,this.farLeft=0,this.activateCell={r:-1,c:-1},this._drawingStatus={drawing:!1,requesting:!1,requestData:[S.aV.of()]},this.onresize=()=>{let{canvas:e,GOMOKU_SIZE:t,lineWidth:i}=this;if(null==e)return;let r=e.parentElement;if(null!=r){var s;let n=Math.min(r.clientWidth,r.clientHeight),a=i*t,o=Math.floor((n-a)/(t+.2));if(o<12)throw TypeError("Canvas is not large enough. clientWidth(".concat(r.clientWidth,"), clientHeight(").concat(r.clientHeight,")"));e.width=n,e.height=n;let l=n-a-o*(t-1);this.farLeft=this.farTop=Math.floor(l/2),this.farRight=this.farBottom=n-(l-this.farLeft),this.gridSize=o;let c=Math.round((this.lineWidth+16)/2)+1;this.pieceRadius=null!==(s=this.__customPieceRadius)&&void 0!==s?s:Math.floor(Math.min(.4*o,Math.max(.3*this.gridSize,c))),this.draw(this.pieces)}},this.onclick=e=>{let{GOMOKU_SIZE:t}=this,{offsetX:i,offsetY:r}=e,{r:s,c:n}=this.locate(i,r);if(s>=0&&s<t&&n>=0&&n<t){var a,o;this.updateActivateCell(s,n),null===(a=(o=this.listeners).onClick)||void 0===a||a.call(o,s,n)}},this.GOMOKU_SIZE=e.lines,this.pieces=e.pieces,this.lineWidth=null!==(r=e.lineWidth)&&void 0!==r?r:1,this.pieceDrawer=e.pieceDrawer,this.listeners={...e.listeners},this.bufferCanvas=document.createElement("canvas"),this.styles={gridLineColor:null!==(s=null===(t=e.styles)||void 0===t?void 0:t.gridLineColor)&&void 0!==s?s:"#492d15",locatePointColor:null!==(n=null===(i=e.styles)||void 0===i?void 0:i.locatePointColor)&&void 0!==n?n:"#333333"},this.__customPieceRadius=e.pieceRadius,this.init(e.canvas)}}var eA=i(6260);class e_{drawPieces(e,t,i,r){let s=2*i,{pieceFillStyle:n,pieceStrokeStyle:a}=this.getPreferenceSettings(t),o=null!=a?(0,M.xv)(a):"";switch(o&&(e.strokeStyle=o),n.prefer){case"color":for(let{x:t,y:s}of((0,eA.Z)(null!=n.color,"[drawPiece] color is not defined"),e.fillStyle=(0,M.xv)(n.color),r))e.beginPath(),e.arc(t,s,i,0,eD.QA,!1),e.closePath(),e.stroke(),e.fill();return Promise.resolve();case"image":{(0,eA.Z)(null!=n.imageUrl,"[drawPiece] imageUrl is not defined");let t=document.createElement("img");return t.src=n.imageUrl,new Promise(n=>{t.onload=()=>{for(let{x:n,y:a}of r)e.save(),e.beginPath(),e.arc(n,a,i,0,eD.QA,!1),e.closePath(),e.clip(),e.drawImage(t,0,0,t.width,t.height,n-i,a-i,s,s),e.restore();n()}})}default:return Promise.resolve()}}constructor(e){this.getPreferenceSettings=e}}new RegExp("^\\s*(\\d+(?:\\.\\d+)?)([".concat("KMGTP","]B?)?\\s*$"));let e$=e=>new Promise(t=>setTimeout(t,e));var eO=i(25289);class eU{get isRunning(){return this._running}request(e){if(!this._running){var t;this._running=!0,null===(t=this._worker)||void 0===t||t.postMessage(e)}}constructor(e){if(this._running=!1,this._worker=null,e.canUseDOM&&"undefined"!=typeof Worker){let{scriptURL:t,options:i,onResponse:r}=e,s=new Worker(t,i);s.onmessage=e=>{this._running=!1,r(e)},this._worker=s}}}(m||(m={})).MOVE="move";let eq=new class{run(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,{_tasks:r,_taskMap:s,_previousTaskHolder:n}=this;return new Promise((a,o)=>{this._taskId+=1;let l={id:this._taskId,type:e,data:t,status:"pending",resolve:a,reject:o};r.enqueue(l),s.set(l.id,l);let c=n.get(i);void 0!==c&&"pending"===c.status&&(c.status="canceled",c.resolve(null),l.id=c.id),n.set(i,l),this._schedule()})}_schedule(){var e;let t;let i=this._workers.find(e=>!e.isRunning);if(void 0===i)return;let{_tasks:r}=this;for(;r.size>0&&"pending"!==(t=r.dequeue()).status;);(null===(e=t)||void 0===e?void 0:e.status)==="pending"&&(t.status="running",i.request({id:t.id,type:t.type,data:t.data}))}constructor(e){var t;let i=Math.max(1,Math.min(100,e.workerInstanceCount));this._requestId=0,this._taskId=0,this._tasks=new eO.T,this._taskMap=new Map,this._previousTaskHolder=new Map,this._tasks.init(),this._tasks.resize(null!==(t=e.MAX_TASK_NUMBER)&&void 0!==t?t:1e4),this._workers=Array(i).fill([]).map(()=>new eU({canUseDOM:e.canUseDOM,scriptURL:e.workerUrl,options:e.workerOptions,onResponse:e=>{let{id:t,data:i,error:r}=e.data,s=this._taskMap.get(t);switch((0,eA.Z)(void 0!==s,()=>"[Webworker] Cannot find the running task with id (".concat(t,")")),s.status){case"running":null===i?s.reject("[Webworker] Cannot solve the request. ".concat(r)):s.resolve(i),s.status="done";break;case"pending":case"done":throw Error("[Webworker] Bad task status (".concat(s.status,"). id (").concat(t,")"))}this._schedule()}}))}}({canUseDOM:eD.Nq,workerUrl:"/asset/js/webworker/gomoku.js",workerInstanceCount:1,MAX_TASK_NUMBER:10});async function eX(e){let t=await eq.run(m.MOVE,e);if(null===t)return[-1,-1];let{r:i,c:r}=t;return[i,r]}class eB{async move(e){let t=Date.now(),i=this._move(e),r=t+this.MINIMAL_THINKING_TIME-Date.now();return r>0&&await e$(r),i}constructor(e){var t;let i=Math.min(3e5,null!==(t=e.MINIMAL_THINKING_TIME)&&void 0!==t?t:0);this.MINIMAL_THINKING_TIME=i}}class eF extends eB{async _move(e){let{MAX_ROW:t,MAX_COL:i,pieces:r,playerId:s}=e,[n,a]=await eX({MAX_ROW:t,MAX_COL:i,pieces:Array.from(r),playerId:s,MAX_ADJACENT:this.MAX_ADJACENT,MAX_DISTANCE_OF_NEIGHBOR:this.MAX_DISTANCE_OF_NEIGHBOR});return[n,a]}constructor(e){super(e),this.type=d.COMPUTER,this.MAX_ADJACENT=e.MAX_ADJACENT,this.MAX_DISTANCE_OF_NEIGHBOR=e.MAX_DISTANCE_OF_NEIGHBOR,this.scoreMap=e.scoreMap}}class eG extends eB{_move(e){if(null!=e.clickedPos){let{r:t,c:i}=e.clickedPos;return[t,i]}return[-1,-1]}constructor(...e){super(...e),this.type=d.HUMAN}}var eZ=i(66420);class eV extends eB{_move(e){let{MAX_ROW:t,MAX_COL:i}=e,r=Array.from(e.pieces);if(r.length<=0)return[t>>1,i>>1];for(let e of((0,eZ.ZP)(r),(0,eZ.ZP)(this.shufflableDirections),r))for(let[s,n]of this.shufflableDirections){let a=e.r+s,o=e.c+n;if(a>=0&&a<t&&o>=0&&o<i){if(r.some(e=>e.r===a&&e.c===o))continue;return[a,o]}}return[-1,-1]}constructor(e){super(e),this.type=d.STUPID_COMPUTER,this.shufflableDirections=w.bs.slice()}}let eW=e=>{switch(e.type){case d.HUMAN:return new eG({MINIMAL_THINKING_TIME:0});case d.COMPUTER:return new eF({MAX_ADJACENT:5,MAX_DISTANCE_OF_NEIGHBOR:2,MINIMAL_THINKING_TIME:300});case d.STUPID_COMPUTER:return new eV({MINIMAL_THINKING_TIME:300})}},eL=()=>{var e;let t=N(),i=C(e=>e.status$),r=C(e=>e.MAX_ROW$),s=C(e=>e.MAX_COL$),n=C(e=>e.pieces$),a=C(e=>e.players$),o=C(e=>e.mover$),c=y.useRef([]);(null===(e=c.current[o])||void 0===e?void 0:e.type)!==a[o].type&&(c.current[o]=eW(a[o]));let d=c.current[o],p=y.useRef(!1),u=(0,D.$0)(async e=>{if(!p.current&&void 0!==d&&i===R.X.RUNNING)try{p.current=!0;let[i,a]=await d.move({MAX_ROW:r,MAX_COL:s,pieces:n,playerId:o,clickedPos:e});(0,eA.Z)(i>=0&&i<r&&a>=0&&a<=s,()=>"[Unexpected moving] currentPlayer(".concat(o,"}), moving: (").concat(i,", ").concat(a,")")),t({type:l.MOVE,payload:{r:i,c:a}})}catch(e){console.error("Failed to move:",e)}finally{p.current=!1,await e$(50)}}),h=j(d.type);return y.useEffect(()=>{if(!h||i!==R.X.RUNNING)return;let e=setTimeout(()=>void u(),0);return()=>clearTimeout(e)},[o,h,i,u]),{move:u}},ez=e=>{let{overlay:t,className:i}=e,r=C(e=>e.MAX_ROW$),s=C(e=>e.pieces$),n=C(e=>e.status$),a=C(e=>e.players$),{borderColor:o}=C(e=>e.preference$),l=y.useRef(null),c=(0,M.xv)(o),d=eL(),p=(0,D.$0)((e,t)=>{e>=0&&e<r&&t>=0&&t<r&&d.move({r:e,c:t})}),u=(0,D.$0)(e=>a[e].preference),h=(0,D.$0)(async()=>{await (null==m?void 0:m.draw(s))}),[m,v]=y.useState(null);return y.useEffect(()=>{let e=new e_(u),t=new eM({canvas:l.current,lines:15,pieces:S.aV.of(),pieceDrawer:e,listeners:{onClick:p}});return v(t),()=>t.destroy()},[p,u]),y.useEffect(()=>{null!=m&&(m.reset({canvas:l.current,GOMOKU_SIZE:r,styles:{gridLineColor:c}}),h())},[m,r,c,h]),y.useEffect(()=>{null==m||m.draw(s)},[m,s]),(0,g.jsxs)("div",{className:(0,X.cx)(eY.container,i),children:[(0,g.jsx)("div",{className:(0,X.cx)(eY.overlay,n===R.X.PENDING&&eY.overlayPending,n===R.X.RUNNING&&eY.overlayRunning,n===R.X.PAUSED&&eY.overlayPaused,n===R.X.END&&eY.overlayEnd),children:t},"overlay"),(0,g.jsx)("canvas",{ref:l})]})},eH={finished:(0,X.F4)({"0%":{transform:"translate(0, -100px)"},"80%":{transform:"translate(0, 20px)"},"90%":{transform:"translate(0, -10px)"},"95%":{transform:"translate(0, 2px)"},"100%":{transform:"translate(0, 0)"}})},eY={container:(0,X.iv)({position:"relative",boxSizing:"content-box",display:"inline-block",width:"100%",height:"100%",padding:0,border:0,margin:0,fontFamily:"Consolas, 'Source Code Pro', 'Roboto Mono', monospace, sans-serif"}),overlay:(0,X.iv)({zIndex:2,position:"absolute",top:0,left:0,right:0,bottom:0,display:"none",width:"100%",height:"100%",overflow:"hidden",background:h.colorBgOverlay}),overlayPending:(0,X.iv)({display:"block",backdropFilter:"blur(1px)"}),overlayRunning:(0,X.iv)({display:"none"}),overlayPaused:(0,X.iv)({display:"block",backdropFilter:"blur(4px)"}),overlayEnd:(0,X.iv)({display:"block",backdropFilter:"blur(4px)",color:h.colorOverlayEnd,animation:"1s 0s ".concat(eH.finished," ease-in-out")})};var eK=i(9171),eQ=i(41616),eJ=i(70655),e0=i(1849);class e1 extends y.Component{shouldComponentUpdate(e){let t=this.props;return t.status!==e.status||t.winner!==e.winner||t.attemptTick!==e.attemptTick||t.players!==e.players}render(){let{start:e,resume:t,restart:i}=this,{status:r,players:s}=this.props,n=s[this.props.winner];switch(r){case R.X.PENDING:return(0,g.jsx)("div",{className:e2.overlay,children:(0,g.jsx)(L.Z,{className:e2.button,variant:"contained",color:"inherit",startIcon:(0,g.jsx)(eJ.Z,{}),onClick:e,children:"Start"})});case R.X.PAUSED:return(0,g.jsx)("div",{className:e2.overlay,children:(0,g.jsx)(L.Z,{className:e2.button,variant:"contained",color:"inherit",startIcon:(0,g.jsx)(eQ.Z,{}),onClick:t,children:"Resume"})});case R.X.END:return(0,g.jsx)("div",{className:e2.overlay,children:(0,g.jsxs)("div",{className:e2.finishedBanner,children:[void 0!==n?(0,g.jsxs)("div",{className:e2.blessing,children:[(0,g.jsx)("div",{className:e2.winner,children:(0,g.jsx)("span",{className:e2.winnerAvatar,style:{background:(0,M.l9)(n.preference.pieceFillStyle),backgroundSize:"cover"}},"avatar")}),"win\uD83C\uDF89"]}):(0,g.jsx)("p",{children:"Draw!"}),(0,g.jsx)(L.Z,{className:e2.button,variant:"contained",color:"inherit",startIcon:(0,g.jsx)(e0.Z,{}),onClick:i,children:"New"})]})});default:return(0,g.jsx)(y.Fragment,{})}}componentDidUpdate(e){let t=this.props.attemptTick>0,i=this.props.status;if(e.status!==i&&i===R.X.END&&t){let e=this.props.players[this.props.winner];void 0!==e&&this.props.throwConfetti()}}constructor(...e){super(...e),this.start=()=>{let{dispatchGomokuAction:e}=this.props;e({type:l.START})},this.resume=()=>{let{dispatchGomokuAction:e}=this.props;e({type:l.RESUME})},this.restart=()=>{let{dispatchGomokuAction:e}=this.props;e({type:l.RESTART})}}}e1.displayName="$GameOverlay",e1.propTypes={status:f().number.isRequired,winner:f().number.isRequired,attemptTick:f().number.isRequired,players:f().array.isRequired,dispatchGomokuAction:f().func.isRequired,throwConfetti:f().func.isRequired};let e2={overlay:(0,X.iv)({position:"relative",display:"flex",alignItems:"center",justifyContent:"center",height:"100%",width:"100%",userSelect:"none"}),confettiCanvas:(0,X.iv)({top:0,bottom:0,left:0,right:0,width:"100%",height:"100%"}),button:(0,X.iv)({color:h.colorButton,"&&, &&:hover":{boxShadow:"4px 4px 16px 0px hsl(0deg 0% 0% / 0.75)"}}),finishedBanner:(0,X.iv)({position:"relative",display:"flex",flexDirection:"column",justifyContent:"center",padding:0,margin:0,fontSize:32}),blessing:(0,X.iv)({display:"flex",alignItems:"center",marginBottom:"1rem"}),winner:(0,X.iv)({display:"flex",flexDirection:"column",alignItems:"center",marginRight:16}),winnerAvatar:(0,X.iv)({display:"inline-block",width:32,height:32,borderRadius:"50%"})},e4=()=>{let e=N(),t=C(e=>e.status$),i=C(e=>e.winner$),r=C(e=>e.attemptTick$),s=C(e=>e.players$),n=(0,eK.D)();return(0,g.jsx)(e1,{status:t,winner:i,attemptTick:r,players:s,dispatchGomokuAction:e,throwConfetti:n})};var e5=i(44993),e3=i(51334),e6=i(94229),e9=i(93946);let e8=Object.fromEntries([5,7,9,11,13,15,17,19,21,23,25].map(e=>[e,"".concat(e,"x").concat(e)])),e7=e=>Number(e),te=["size","background","border"],tt={size:{label:"Size",FormItemRenderer:e=>{let t=C(e=>e.status$),i=t!==R.X.PENDING;return(0,g.jsx)(em,{...e,disabled:i,choices:e8,normalize:e7})}},background:{label:"Background",FormItemRenderer:e=>{let t=C(e=>e.status$),i=t===R.X.END;return(0,g.jsx)(el,{...e,disabled:i})}},border:{label:"Board",FormItemRenderer:e=>{let t=C(e=>e.status$),i=t===R.X.END;return(0,g.jsx)(ed,{...e,disabled:i})}}};class ti extends y.Component{shouldComponentUpdate(e){let t=this.props;return!(0,B.Z)(t.data,e.data)}render(){let{onChange:e}=this,{data:t}=this.props;return(0,g.jsx)(F,{data:t,items:tt,itemsOrder:te,classes:ts,onChange:e})}constructor(...e){super(...e),this.onChange=e=>{this.props.onChange(e)}}}ti.displayName="GameBaseSettingsRenderer",ti.propTypes={data:f().object.isRequired,onChange:f().func.isRequired};let tr={keys:te,FormItemGroupRenderer:ti},ts={formItem:(0,X.iv)({margin:"1rem 1rem",alignItems:"center"}),label:(0,X.iv)({minWidth:"6rem"})},tn=e=>{let t=N(),i=C(e=>e.status$),r=C(e=>e.MAX_ROW$),{boardBackground:s,borderColor:n}=C(e=>e.preference$),[a,o]=y.useState(!1),c=y.useMemo(()=>({size:_.MAX_ROW,background:_.preference.boardBackground,border:_.preference.borderColor}),[]),d=y.useMemo(()=>({size:r,background:s,border:n}),[r,s,n]),p=y.useMemo(()=>[tr],[]),u=i===R.X.END,h={onOpenDialog:(0,D.$0)(()=>o(!0)),onRealTimeChange:(0,D.$0)(e=>{r!==e.size&&t({type:l.RESET,payload:{MAX_ROW:e.size,MAX_COL:e.size}}),(s!==e.background||n!==e.border)&&t({type:l.MODIFY_PREFERENCE,payload:{boardBackground:e.background,borderColor:e.border}})}),onSave:e=>{h.onRealTimeChange(e),o(!1)},onDiscard:(0,D.$0)(e=>{h.onRealTimeChange(e),o(!1)})},{WakeBtn:m=ta}=e;return(0,g.jsxs)("div",{className:(0,X.cx)(to.container,e.className),children:[(0,g.jsx)(m,{onWakeUp:h.onOpenDialog}),a&&(0,g.jsx)(H,{container:e.containerRef.current,initialData:d,factoryData:c,isResetAvailable:!u,formItemGroups:p,classes:tl,onSave:h.onSave,onDiscard:h.onDiscard,onRealTimeChange:h.onRealTimeChange})]})},ta=e=>(0,g.jsx)(e9.Z,{size:"small",className:to.wakeBtn,onClick:e.onWakeUp,children:(0,g.jsx)(e6.Z,{})}),to={container:(0,X.iv)({}),wakeBtn:(0,X.iv)({"> svg":{width:18,height:18}})},tl={dialog:(0,X.iv)({minWidth:240,minHeight:400})};class tc extends y.Component{shouldComponentUpdate(e,t){let i=this.props,r=this.state;return r.isRestartDialogVisible!==t.isRestartDialogVisible||i.containerRef!==e.containerRef||i.status!==e.status||i.mover!==e.mover||i.pieces!==e.pieces}render(){let{flip:e,retract:t,restart:i,start:r,closeRestartDialog:s}=this,{containerRef:n,status:a,mover:o,pieces:l}=this.props,{isRestartDialogVisible:c}=this.state,d=a!==R.X.PENDING,p=(a===R.X.RUNNING||a===R.X.END)&&l.some(e=>e.p===o),u=a===R.X.PENDING;return(0,g.jsxs)("div",{className:td.toolbar,children:[(0,g.jsxs)("div",{className:(0,X.cx)(td.item,td.buttons),children:[(0,g.jsx)(L.Z,{variant:"contained",color:"inherit",size:"small",startIcon:(0,g.jsx)(e0.Z,{}),disabled:!d,onClick:r,children:(0,g.jsx)("span",{className:td.buttonText,children:"New"})}),(0,g.jsx)(L.Z,{variant:"contained",color:"inherit",size:"small",startIcon:(0,g.jsx)(e5.Z,{}),disabled:!p,onClick:t,children:(0,g.jsx)("span",{className:td.buttonText,children:"Retract"})}),(0,g.jsx)(L.Z,{variant:"contained",color:"inherit",size:"small",startIcon:(0,g.jsx)(e3.Z,{}),disabled:!u,onClick:e,children:(0,g.jsx)("span",{className:td.buttonText,children:"Flip"})}),(0,g.jsx)(tn,{containerRef:n})]}),(0,g.jsxs)(Z.Z,{container:n.current,open:c,onClose:s,"aria-labelledby":"confirm-to-restart",children:[(0,g.jsx)(V.Z,{children:"Are you sure you want to start a new game?"}),(0,g.jsxs)(W.Z,{className:td.dialogActions,children:[(0,g.jsx)(L.Z,{color:"inherit",onClick:s,children:"Cancel"}),(0,g.jsx)(L.Z,{color:"primary",onClick:i,children:"Confirm"})]})]})]})}constructor(e){super(e),this.flip=()=>{let{dispatchGomokuAction:e}=this.props;e({type:l.FLIP_PLAYER})},this.retract=()=>{let{dispatchGomokuAction:e}=this.props;e({type:l.RETRACT})},this.restart=()=>{let{dispatchGomokuAction:e}=this.props;e({type:l.RESTART}),this.setState({isRestartDialogVisible:!1})},this.start=()=>{let{status:e,dispatchGomokuAction:t}=this.props;e===R.X.PENDING||e===R.X.END?t({type:l.RESTART}):this.setState({isRestartDialogVisible:!0})},this.closeRestartDialog=()=>{this.setState({isRestartDialogVisible:!1})},this.state={isRestartDialogVisible:!1}}}tc.displayName="$GameToolbar",tc.propTypes={containerRef:f().object.isRequired,status:f().number.isRequired,mover:f().number.isRequired,pieces:f().any.isRequired,dispatchGomokuAction:f().func.isRequired};let td={toolbar:(0,X.iv)({display:"block",maxWidth:"min(90vw, 400px)",margin:"auto"}),item:(0,X.iv)({display:"flex",flexWrap:"wrap",alignItems:"center",justifyContent:"flex-start",margin:"1rem 0"}),buttons:(0,X.iv)({justifyContent:"space-around",color:h.colorButton,"> button":{display:"flex",justifyContent:"spaceBetween",alignItems:"center",margin:"0 4px"}}),buttonText:(0,X.iv)({lineHeight:1.1}),dialogActions:(0,X.iv)({color:h.colorButton})},tp=e=>{let t=N(),i=C(e=>e.status$),r=C(e=>e.mover$),s=C(e=>e.pieces$);return(0,g.jsx)(tc,{status:i,mover:r,pieces:s,containerRef:e.containerRef,dispatchGomokuAction:t})},tu=()=>{let e=N(),t=y.useRef(null),i=th();return(0,D.TK)(()=>e({type:l.PAUSE}),[e]),(0,g.jsxs)("div",{ref:t,className:i.container,children:[(0,g.jsxs)("div",{className:i.header,children:[(0,g.jsx)(eT,{containerRef:t}),(0,g.jsx)(tp,{containerRef:t})]}),(0,g.jsx)("div",{className:i.main,children:(0,g.jsx)(ez,{overlay:(0,g.jsx)(e4,{})})})]})},th=()=>{let{boardBackground:e}=C(e=>e.preference$);return{container:(0,X.iv)({boxSizing:"border-box",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",width:"100%"}),header:(0,X.iv)({boxSizing:"border-box",display:"flex",flexDirection:"column",justifyContent:"center",width:"100%",padding:"2vmin"}),main:(0,X.iv)({boxSizing:"border-box",height:"96vmin",width:"96vmin",background:(0,M.l9)(e),backgroundSize:"cover","@media (min-width: 1367px)":{width:"60vmin",height:"60vmin"}})}};var tm=i(5354);let tg={[u.colorBgOverlay]:"linear-gradient(45deg, hsl(30, 20%, 90%, 0.2), hsl(210, 20%, 100%, 0.3))",[u.colorButton]:"hsla(0deg, 0%, 80%, 1)",[u.colorOverlayEnd]:"#ff00ff",[u.colorPlayerName]:"hsla(30deg, 60%, 50%, 1)",[u.colorPlayerType]:"hsla(0deg, 0%, 100%, 0.6)",[u.colorThinkingIcon]:"hsla(0deg, 0%, 100%, 0.6)",[u.colorVersus]:"hsla(0deg, 0%, 100%, 0.6)",[u.colorWinnerName]:"hsla(30deg, 80%, 50%, 1)"},tv={[u.colorBgOverlay]:"linear-gradient(45deg, hsl(30, 20%, 90%, 0.2), hsl(210, 20%, 100%, 0.3))",[u.colorButton]:"hsla(0deg, 0%, 20%, 1)",[u.colorOverlayEnd]:"#ff00ff",[u.colorPlayerName]:"hsla(30deg, 60%, 50%, 1)",[u.colorPlayerType]:"hsla(0deg, 0%, 10%, 1)",[u.colorThinkingIcon]:"hsla(0deg, 0%, 10%, 1)",[u.colorVersus]:"hsla(0deg, 0%, 10%, 1)",[u.colorWinnerName]:"hsla(30deg, 80%, 50%, 1)"},tf=e=>{let t=(0,tm.mY)(e=>e.theme$),i=C(e=>e.status$),r=(0,X.cx)(ty.common,t===eD.Q2.light&&ty.light,t===eD.Q2.darken&&ty.darken,i===R.X.PENDING&&ty.statusPending,i===R.X.PAUSED&&ty.statusPaused,i===R.X.END&&ty.statusEnd);return(0,g.jsx)("div",{className:r,children:e.children})},ty={common:(0,X.iv)({display:"block",transform:"scale(1)",caretColor:"transparent",background:"transparent"}),light:(0,X.iv)(tv),darken:(0,X.iv)(tg),statusPending:(0,X.iv)({"&&":{}}),statusPaused:(0,X.iv)({"&&":{}}),statusEnd:(0,X.iv)({"&&":{}})},tx=e=>(0,g.jsx)(q,{storageKey:e.storageKey,initialData:e.initialState,children:(0,g.jsx)(tf,{children:(0,g.jsx)(tu,{})})});tx.propTypes={storageKey:f().string.isRequired};var tb=i(28514);class tk extends y.PureComponent{render(){return(0,g.jsx)(tb.Vj,{title:"Gomoku Game",children:(0,g.jsx)(tx,{storageKey:"@kyokuya/gomoku-game/context0/"})})}}tk.displayName="GomokuGamePage"},74243:function(e,t,i){var r={"./post/algorithm/dlx/sudoku-solver":[15051,51],"./post/algorithm/dlx/sudoku-solver.tsx":[15051,51],"./post/game/sudoku":[71247,596,724,997,564,747,185,247],"./post/game/sudoku.tsx":[71247,596,724,997,564,747,185,247],"./util/sudoku":[34388,388],"./util/sudoku.ts":[34388,388]};function s(e){if(!i.o(r,e))return Promise.resolve().then(function(){var t=Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t});var t=r[e],s=t[0];return Promise.all(t.slice(1).map(i.e)).then(function(){return i(s)})}s.keys=function(){return Object.keys(r)},s.id=74243,e.exports=s}},function(e){e.O(0,[596,554,724,564,708,774,888,179],function(){return e(e.s=40193)}),_N_E=e.O()}]);