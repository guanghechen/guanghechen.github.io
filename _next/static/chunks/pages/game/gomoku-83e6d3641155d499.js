(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[921],{40193:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/game/gomoku",function(){return n(32140)}])},26692:function(e,t,n){"use strict";t.Z=function e(t,n){if(t===n)return!0;if(t&&n&&"object"==typeof t&&"object"==typeof n){if(t.constructor!==n.constructor)return!1;if(Array.isArray(t)){if(t.length!==n.length)return!1;for(let r=0;r<t.length;++r)if(!e(t[r],n[r]))return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();let r=Object.keys(t);if(r.length!==Object.keys(n).length)return!1;for(let e=0;e<r.length;++e)if(!Object.prototype.hasOwnProperty.call(n,r[e]))return!1;for(let i=0;i<r.length;++i){let a=r[i];if(("_owner"!==a||!t.$$typeof)&&!e(t[a],n[a]))return!1}return!0}return Number.isNaN(t)&&Number.isNaN(n)}},9171:function(e,t,n){"use strict";n.d(t,{D:function(){return s}});var r=n(4844),i=n(95050),a=n(67294);let o=[["#ffbe0b","#fb5607","#ff006e","#8338ec","#3a86ff"],["#9b5de5","#f15bb5","#fee440","#00bbf9","#00f5d4"]],l=()=>{let e=o.length;return o[Math.min(e-1,Math.floor(Math.random()*e))]},s=()=>{let e=a.useRef(!1),t=a.useRef(null);a.useEffect(()=>(t.current=new i.Z,()=>{t.current=null}),[]);let n=(0,r.$0)(async()=>{if(null==t.current)return;let n=t.current,r=l(),i=window.screen.width<=900;e.current=!0;try{await n.addConfetti({confettiColors:r,confettiRadius:i?4:8,confettiNumber:i?100:300})}finally{e.current=!1}});return n}},4844:function(e,t,n){"use strict";n.d(t,{NY:function(){return a},$0:function(){return o},nu:function(){return l}});var r=n(67294),i=n(26692);function a(e,t){let n=r.useRef(0),a=r.useRef(t);return(0,i.Z)(a.current,t)||(n.current+=1),a.current=t,r.useMemo(e,[n.current])}function o(e){let t=r.useRef(e);return r.useLayoutEffect(()=>{t.current=e}),r.useCallback(function(){for(var e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];let i=t.current;return i(...n)},[])}function l(e){let[t,n]=r.useState(e);return r.useEffect(()=>n(e),[e]),[t,n]}},47289:function(e,t,n){"use strict";n.d(t,{T:function(){return s}});var r=n(85893),i=n(1879),a=n(24729),o=n(45697),l=n.n(o);n(67294);let s=e=>{let t=(0,i.AA)(e=>e.state.title),n=(0,i.AA)(e=>e.state.description),o=(0,i.AA)(e=>e.state.author.name),{description:l=n,title:s}=e;return(0,r.jsxs)(a.ql,{children:[(0,r.jsxs)("title",{children:[s," | ",t]}),(0,r.jsx)("meta",{name:"viewport",content:"initial-scale=1.0, width=device-width"},"viewport"),(0,r.jsx)("meta",{name:"author",content:o},"author"),(0,r.jsx)("meta",{name:"description",content:l},"description"),(0,r.jsx)("meta",{property:"og:title",content:s},"og:title"),(0,r.jsx)("meta",{property:"og:description",content:l},"og:description"),(0,r.jsx)("meta",{property:"og:type",content:"website"},"og:type")]})};s.propTypes={title:l().string.isRequired,description:l().string}},58695:function(e,t,n){"use strict";n.d(t,{iA:function(){return p},f$:function(){return i}}),(r=i||(i={})).PENDING="pending",r.RUNNING="running",r.PAUSED="paused",r.FINISHED="finished";var r,i,a=n(67294),o=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:i.PENDING,r=a.useRef(-1),o=a.useRef(n),l=a.useRef(t),s=o.current;switch(o.current=e,e){case i.PENDING:return 0;case i.RUNNING:switch(s){case i.PENDING:return l.current=0,r.current=Date.now(),0;case i.RUNNING:return l.current+Date.now()-r.current;case i.PAUSED:return r.current=Date.now(),l.current;case i.FINISHED:return l.current=0,r.current=Date.now(),0;default:return l.current}case i.PAUSED:case i.FINISHED:return s===i.RUNNING&&(l.current+=Date.now()-r.current),l.current;default:throw TypeError("[usedRecordTime] expect a GameRunningState, but got (".concat(e,")"))}},l=n(85893),s=n(27484),c=n.n(s),d=n(1646),u=n.n(d);function p(e){let{gameStatus:t,delay:n=1e3,format:r="HH:mm:ss",className:i,style:s,initialUsedTime:d,initialStatus:u,onUsedTimeChange:p}=e,h=o(t,d,u),f=c().duration(h).format(r),[,m]=a.useState(0);return a.useEffect(()=>{let e,r;if("running"!==t)return;let i=n-h%n,a=()=>m(e=>e+1);return e=setTimeout(()=>{e=void 0,a(),r=setInterval(a,n)},i),()=>{void 0!==e&&clearTimeout(e),void 0!==r&&clearInterval(r)}},[t,n]),a.useEffect(()=>{null==p||p(h)},[h,p]),(0,l.jsx)("span",{className:i,style:s,children:f})}c().extend(u()),p.displayName="ElapsedTimer"},64712:function(e,t,n){"use strict";n.d(t,{V:function(){return s}});var r=n(85893),i=n(1879),a=n(47289),o=n(67294),l=n(53673);let s=e=>{let t=(0,i.AA)(e=>e.state.author),n=(0,i.AA)(e=>e.state.copyright);return(0,r.jsxs)(o.Fragment,{children:[(0,r.jsx)(a.T,{title:e.title,description:e.description}),(0,r.jsxs)("div",{className:l.container,children:[(0,r.jsx)("header",{className:l.header,children:(0,r.jsx)("h1",{children:e.title})}),(0,r.jsx)("main",{className:l.main,children:(0,r.jsx)("div",{className:l.content,children:e.children})}),(0,r.jsx)("footer",{className:l.footer,children:(0,r.jsxs)("div",{className:l.copyright,children:[(0,r.jsxs)("span",{children:["\xa9 ",n.date," ",t.name]},"date"),(0,r.jsx)("span",{children:t.motto},"motto")]})})]})]})}},32140:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return tr}});var r,i,a,o,l,s,c,d=n(85893),u=n(45697),p=n.n(u),h=n(67294);(r=o||(o={})).FLIP_PLAYER="@gomoku/flip-player",r.MODIFY_PLAYER="@gomoku/modify-player",r.MODIFY_PREFERENCE="@gomoku/modify-preference",r.MOVE="@gomoku/move",r.PAUSE="@gomoku/pause",r.RESET="@gomoku/reset",r.RESTART="@gomoku/restart",r.RESUME="@gomoku/resume",r.RETRACT="@gomoku/retract",r.START="@gomoku/start",(i=l||(l={})).MOVE="move",i.RETRACT="retract",(a=s||(s={})).HUMAN="human",a.COMPUTER="computer",a.STUPID_COMPUTER="stupid-computer";var f=n(46528),m=n(21446),g=n(5967),v=n(58695),y=n(93513),k=n(26812);let x=k.a7.rightHalf;function N(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:5,i=new Int32Array(t*n).fill(-1);for(let{r:n,c:r,p:a}of e)i[n*t+r]=a;for(let e of x){let[l,s]=k.bs[e];for(let e=0;e<t;++e)for(let c=0;c<n;++c){var a,o;let d=i[e*t+c];if(d<0)continue;let u=1;for(let r=e+l,p=c+s;a=r,o=p,a>=0&&a<t&&o>=0&&o<n&&i[r*t+p]===d;r+=l,p+=s)u+=1;if(u>=r){if(0!==d&&1!==d)throw Error("[checkWinner] Bad player(".concat(d,") on piece (").concat(e,", ").concat(c,")."));return d}}}return -1}let C="[gomoku reducer]";function b(e){var t,n,r,i,a,o,s,c,d,u,p,h,m;let g=arguments.length>1&&void 0!==arguments[1]?arguments[1]:S,{MAX_ROW:y=g.MAX_ROW,MAX_COL:k=g.MAX_COL,instructions:x=g.instructions.slice(),gameTick:C=g.gameTick}={...e},b=function(e){let t=[];for(let n of e)switch(n.type){case l.RETRACT:t.splice(t.length-n.payload,n.payload);break;case l.MOVE:{let{r:e,c:r,p:i}=n.payload;t.push({r:e,c:r,p:i})}}return t}(x),_=N(b,y,k),w=1&b.length,I=_<0?x.length>0?v.f$.PAUSED:v.f$.PENDING:v.f$.FINISHED,[E,R]=g.players,[j,P]=null!==(a=null==e?void 0:e.players)&&void 0!==a?a:[];return{MAX_ROW:y,MAX_COL:k,gameStatus:I,winner:_,mover:w,pieces:b,instructions:x,gameTick:C,attemptTick:0,forceRenderTick:0,players:[{name:null!==(o=null==j?void 0:j.name)&&void 0!==o?o:E.name,type:null!==(s=null==j?void 0:j.type)&&void 0!==s?s:E.type,preference:{pieceFillStyle:null!==(c=null==j?void 0:null===(t=j.preference)||void 0===t?void 0:t.pieceFillStyle)&&void 0!==c?c:E.preference.pieceFillStyle,pieceStrokeStyle:null!==(d=null==j?void 0:null===(n=j.preference)||void 0===n?void 0:n.pieceStrokeStyle)&&void 0!==d?d:E.preference.pieceStrokeStyle}},{name:null!==(u=null==P?void 0:P.name)&&void 0!==u?u:R.name,type:null!==(p=null==P?void 0:P.type)&&void 0!==p?p:R.type,preference:{pieceFillStyle:null!==(h=null==P?void 0:null===(r=P.preference)||void 0===r?void 0:r.pieceFillStyle)&&void 0!==h?h:R.preference.pieceFillStyle,pieceStrokeStyle:null!==(m=null==P?void 0:null===(i=P.preference)||void 0===i?void 0:i.pieceStrokeStyle)&&void 0!==m?m:R.preference.pieceStrokeStyle}}],preference:(0,f.wT)(g.preference,null==e?void 0:e.preference)}}let S={MAX_ROW:15,MAX_COL:15,gameStatus:v.f$.PENDING,winner:-1,mover:0,pieces:[],instructions:[],gameTick:0,attemptTick:0,forceRenderTick:0,players:[{name:"guanghechen",type:s.COMPUTER,preference:{pieceFillStyle:{prefer:"image",imageUrl:"/asset/img/gomoku/guanghechen.jpg"}}},{name:"wulala",type:s.HUMAN,preference:{pieceFillStyle:{prefer:"image",imageUrl:"/asset/img/gomoku/wulala.jpg"}}}],preference:{borderColor:{r:255,g:255,b:255,a:1},locatePointColor:{r:51,g:51,b:51,a:1},boardBackground:{prefer:"color",color:{r:230,g:226,b:222,a:1},imageUrl:"/asset/img/gomoku/board.jpg"}}},[_,w]=(0,m.oS)("GomokuContextType",{state:b(),dispatch:()=>{throw Error("[GomokuContextType] dispatch is not available yet.")}}),I=(0,g.im)({version:"2022-10-24",ContextName:"GomokuContext",ContextType:_,useContext:w,initState:b,reducer:(e,t)=>{let{gameStatus:n}=e;switch(t.type){case o.FLIP_PLAYER:{if(n!==v.f$.PENDING)return e;let[t,r]=e.players;return{...e,players:[r,t],forceRenderTick:e.forceRenderTick+1}}case o.MODIFY_PLAYER:{if(n===v.f$.FINISHED)return e;let r=t.payload;if(0!==r.id&&1!==r.id)return console.error(C,"bad action:",t),e;let i=e.players[r.id],a=(0,y.Uy)(i,e=>{r.name&&(e.name=r.name),r.type&&(e.type=r.type),r.preference&&(r.preference.pieceFillStyle&&(e.preference.pieceFillStyle=r.preference.pieceFillStyle),r.preference.pieceStrokeStyle&&(e.preference.pieceStrokeStyle=r.preference.pieceStrokeStyle))});return a===i?e:{...e,players:e.players.map((e,t)=>t===r.id?a:e),forceRenderTick:e.forceRenderTick+1}}case o.MODIFY_PREFERENCE:{if(n===v.f$.FINISHED)return e;let{preference:r}=t.payload;return{...e,preference:{...e.preference,...r},forceRenderTick:e.forceRenderTick+1}}case o.MOVE:{if(n!==v.f$.RUNNING)return e;let{r,c:i}=t.payload;if(e.pieces.some(e=>e.r===r&&e.c===i))return e;let{MAX_ROW:a,MAX_COL:o,mover:s}=e,c={r,c:i,p:s},d=[...e.pieces,c],u=N(d,a,o),p=u>=0||d.length===a*o;return{...e,gameStatus:p?v.f$.FINISHED:n,winner:u,pieces:d,mover:1^s,attemptTick:e.attemptTick+1,instructions:[...e.instructions,{type:l.MOVE,payload:c,timestamp:new Date().toISOString()}]}}case o.PAUSE:if(n===v.f$.RUNNING)return(0,y.Uy)(e,e=>{e.gameStatus=v.f$.PAUSED});return e;case o.RESET:if(n===v.f$.PENDING){var r;let{MAX_ROW:n=e.MAX_ROW,MAX_COL:i=e.MAX_COL}=null!==(r=t.payload)&&void 0!==r?r:{};return{...e,MAX_ROW:n,MAX_COL:i,winner:-1,mover:0,pieces:[],instructions:[],gameTick:e.gameTick+1,attemptTick:0}}return e;case o.RESTART:if(n!==v.f$.PENDING)return{...e,gameStatus:v.f$.PENDING,winner:-1,mover:0,pieces:[],instructions:[],gameTick:e.gameTick+1,attemptTick:0};return e;case o.RESUME:if(n===v.f$.PAUSED)return(0,y.Uy)(e,e=>{e.gameStatus=v.f$.RUNNING});return e;case o.RETRACT:if(n===v.f$.RUNNING||n===v.f$.FINISHED){let t=e.pieces.length-1;for(;t>=0&&e.pieces[t].p!==e.mover;--t);if(t<0)return e;let n=e.pieces.length-t,r=e.pieces.slice(0,e.pieces.length-n),i=1&r.length;return{...e,gameStatus:v.f$.RUNNING,pieces:r,winner:-1,mover:i,attemptTick:e.attemptTick+1,instructions:e.instructions.concat({type:l.RETRACT,payload:n,timestamp:new Date().toISOString()})}}return e;case o.START:if(n===v.f$.PENDING)return(0,y.Uy)(e,e=>{e.gameStatus=v.f$.RUNNING});return e;default:return console.error(C,"bad action:",t),e}},serialize:e=>(0,f.ei)(e,["MAX_ROW","MAX_COL","winner","instructions","gameTick","players","preference"])});var E=n(4844),R=n(18872),j=n(94054),P=n(72890),T=n(74750),A=n(36872),M=n(83321),D=n(30780),O=n(52091);let U=e=>{let{background:t,onBackgroundChange:n,onVisibleChange:r}=e,i={onPickerClicked:m.UW,onClosePicker:(0,E.$0)(e=>r(!1)),onPreferChange:(0,E.$0)((e,r)=>{let i={prefer:r,imageUrl:t.imageUrl,color:t.color};n(i)}),onColorChange:(0,E.$0)(e=>{let r={prefer:"color",imageUrl:t.imageUrl,color:e.rgb};n(r)}),onImageChange:e=>{let r=e.target.files;if(null!==r){let e=new FileReader;e.readAsDataURL(r[0]),e.onload=e=>{var r;let i=null===(r=e.target)||void 0===r?void 0:r.result;if(null!=i){let e={prefer:"image",color:t.color,imageUrl:String(i)};n(e)}}}}},a=$(e.visible,t.prefer),o=h.useId();return(0,d.jsxs)("div",{className:(0,R.cx)(O.popover,a,e.className),onClick:i.onPickerClicked,children:[(0,d.jsx)("div",{className:O.cover,onClick:i.onClosePicker}),(0,d.jsxs)("div",{className:O.backgroundPicker,children:[(0,d.jsx)("div",{className:O.backgroundPrefer,children:(0,d.jsx)(j.Z,{style:{display:"flex",justifyContent:"center"},children:(0,d.jsxs)(P.Z,{className:O.backgroundRadioGroup,value:t.prefer,onChange:i.onPreferChange,children:[(0,d.jsx)(T.Z,{value:"color",control:(0,d.jsx)(A.Z,{}),label:"color"}),(0,d.jsx)(T.Z,{value:"image",control:(0,d.jsx)(A.Z,{}),label:"image"})]})})}),(0,d.jsxs)("div",{children:[(0,d.jsx)("div",{className:O.colorPickerWrapper,onDoubleClick:i.onClosePicker,children:(0,d.jsx)(D.xS,{className:O.colorPicker,color:t.color,onChange:i.onColorChange})}),(0,d.jsxs)("div",{className:O.imagePickerWrapper,children:[(0,d.jsx)("input",{type:"file",accept:"image/*",id:o,style:{display:"none"},multiple:!1,onChange:i.onImageChange}),(0,d.jsx)("label",{htmlFor:o,children:(0,d.jsx)(M.Z,{className:O.imageUploadBtn,variant:"contained",component:"span",children:(0,d.jsx)("img",{alt:"background",src:t.imageUrl})})})]})]})]})]})},$=(e,t)=>h.useMemo(()=>(0,R.iv)({display:e?"block":"none",visibility:e?"visible":"hidden",[".".concat(O.imagePickerWrapper)]:{display:"image"===t?"flex":"none"},[".".concat(O.colorPickerWrapper)]:{display:"color"===t?"block":"none"}}),[e,t]);var F=n(36074);let Z=e=>{let{color:t,onColorChange:n,onVisibleChange:r}=e,i={onClosePicker:(0,E.$0)(()=>r(!1)),onColorChange:(0,E.$0)(e=>{n(e.rgb)})},a=G(e.visible);return(0,d.jsxs)("div",{className:(0,R.cx)(F.popover,a,e.className),children:[(0,d.jsx)("div",{className:F.cover,onClick:i.onClosePicker}),(0,d.jsx)("div",{className:F.picker,onDoubleClick:i.onClosePicker,children:(0,d.jsx)(D.xS,{className:F.colorPicker,color:t,onChange:i.onColorChange})})]})},G=e=>h.useMemo(()=>(0,R.iv)({display:e?"block":"none",visibility:e?"visible":"hidden"}),[e]);var B=n(8802);let H=e=>{let[t,n]=h.useState(!1),r={onAvatarClick:(0,E.$0)(e=>{e.stopPropagation(),n(!0)})},i=L(e.position,e.avatar,e.disabled,e.thinking,e.running);return(0,d.jsxs)("div",{className:(0,R.cx)(i.container,e.className),onClick:e.onEdit,children:[(0,d.jsxs)("div",{className:i.userWrapper,children:[(0,d.jsx)("span",{className:i.name,children:e.name}),(0,d.jsx)("span",{className:i.type,children:e.type})]}),(0,d.jsx)("div",{className:i.avatar,onClick:r.onAvatarClick,children:(0,d.jsx)(B.Z,{className:i.thinkingIcon})}),(0,d.jsx)(U,{className:i.picker,visible:t,background:e.avatar,onVisibleChange:n,onBackgroundChange:e.onAvatarChange})]})},L=(e,t,n,r,i)=>h.useMemo(()=>(0,f.ZC)({container:{position:"relative",display:"flex",flexDirection:"left"===e?"row":"row-reverse",justifyContent:"flex-end",alignItems:"center",lineHeight:"16px",cursor:n?"default":"pointer"},avatar:{position:"relative",width:32,height:32,borderRadius:"50%",margin:"left"===e?"0 0 0 6px":"0 6px 0 0",background:(0,f.l9)(t),backgroundSize:"cover"},userWrapper:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"left"===e?"flex-end":"flex-start",lineHeight:"16px"},name:{display:"flex",alignItems:"center",color:"#4682b4",fontSize:16,userSelect:"none"},thinkingIcon:{"&&":{position:"absolute",top:0,left:"left"===e?void 0:-20,right:"left"===e?-20:void 0,display:"inline-block",visibility:r?"visible":"hidden",transition:"translate(0, -50%)",width:16,height:16,color:"#69696e",userSelect:"none",animation:i?"1s ease-in 0s ".concat(W.thinkingIcon," infinite alternate both"):void 0}},type:{margin:"4px 0",fontSize:14,userSelect:"none"},picker:{"&&":"left"===e?{top:48,left:16}:{top:48,left:"unset",right:16}}}),[e,t,n,r,i]),W={thinkingIcon:(0,R.F4)({"0%":{transform:"rotate(-30deg) scale(1.0)"},"50%":{transform:"rotate(0deg) scale(1.2)"},"100%":{transform:"rotate(30deg) scale(1.0)"}})};function z(e){var t,n,r;let{data:i,items:a,itemsOrder:o,colon:l=":",onChange:s}=e,c={formItem:(0,R.cx)(q.formItem,null===(t=e.classes)||void 0===t?void 0:t.formItem),label:(0,R.cx)(q.label,null===(n=e.classes)||void 0===n?void 0:n.label),content:(0,R.cx)(q.content,null===(r=e.classes)||void 0===r?void 0:r.content)},u=o.map((e,t)=>{let n=a[e];return(0,d.jsxs)("div",{className:c.formItem,children:[(0,d.jsxs)("div",{className:c.label,children:[n.label,l]}),(0,d.jsx)("div",{className:c.content,children:(0,d.jsx)(X,{name:e,value:i[e],disabled:n.disabled,required:n.required,ContentRenderer:n.ContentRenderer,onChange:s})})]},t)});return(0,d.jsx)(h.Fragment,{children:u})}function X(e){let{ContentRenderer:t}=e,n=(0,E.$0)(t=>{e.onChange({[e.name]:t})});return(0,d.jsx)(t,{value:e.value,disabled:e.disabled,required:e.required,onChange:n})}let q=(0,f.ZC)({formItem:{display:"flex",alignItems:"flex-start"},label:{flex:"0 1 auto",display:"inline-flex",justifyContent:"flex-end",alignItems:"flex-start",marginRight:8,userSelect:"none",height:"100%"},content:{flex:"1 1 auto",display:"inline-flex",justifyContent:"flex-start",alignItems:"flex-start",height:"100%"}});var Y=n(26692),K=n(78262),V=n(9581),J=n(31425);function Q(e){var t,n,r;let[i]=h.useState(e.initialData),[a,o]=h.useState(i),l=null!==(n=e.factoryData)&&void 0!==n?n:i,s=(0,Y.Z)(i,a),c=(0,Y.Z)(l,a),u=(null===(r=e.isResetAvailable)||void 0===r||r)&&!c,p={onConfirm:(0,E.$0)(()=>e.onSave(a)),onDiscard:(0,E.$0)(()=>e.onDiscard(i)),onChange:(0,E.$0)(t=>{var n;let r={...a,...t};o(r),null===(n=e.onRealTimeChange)||void 0===n||n.call(e,r)}),onReset:(0,E.$0)(()=>{var t;let n={...l};o(n),null!=e.onReset?e.onReset():null===(t=e.onRealTimeChange)||void 0===t||t.call(e,n)}),onClose:(0,E.$0)(()=>{s&&e.onDiscard(i)})},f=h.useRef(p.onDiscard);h.useEffect(()=>{let e=()=>f.current();return window.addEventListener("beforeunload",e),()=>window.removeEventListener("beforeunload",e)},[]);let m=e.formGroups.map((e,t)=>(0,d.jsx)(ee,{data:a,keys:e.keys,Component:e.Component,onChange:p.onChange},t));return(0,d.jsxs)(K.Z,{"aria-labelledby":"edit-player",container:e.container,open:!0,onClose:p.onClose,children:[(0,d.jsx)(V.Z,{className:(0,R.cx)(et.dialog,null===(t=e.classes)||void 0===t?void 0:t.dialog),children:m}),(0,d.jsxs)(J.Z,{children:[null!=e.factoryData&&(0,d.jsx)(M.Z,{color:"inherit",disabled:!u,onClick:p.onReset,children:"Reset"}),(0,d.jsx)(M.Z,{color:"inherit",onClick:p.onDiscard,children:"Discard"}),(0,d.jsx)(M.Z,{color:"primary",disabled:s,onClick:p.onConfirm,children:"Save"})]})]})}function ee(e){let{Component:t,onChange:n}=e,r=(0,m.OU)(e.data,e.keys);return h.useMemo(()=>(0,d.jsx)(t,{data:r,onChange:n}),[t,r,n])}let et=(0,f.ZC)({dialog:{minWidth:240,minHeight:300}}),en=e=>{let{componentName:t}=e,n=e=>{let{value:t,disabled:n}=e,[r,i]=h.useState(!1),a={onTogglePickerVisible:(0,E.$0)(()=>{n||i(e=>!e)}),onBackgroundChange:(0,E.$0)(t=>{n||e.onChange(t)})},o=er(t,n);return(0,d.jsxs)("div",{className:o.container,children:[(0,d.jsx)("div",{className:o.swatch,onClick:a.onTogglePickerVisible,children:(0,d.jsx)("div",{className:o.colorSquare})}),(0,d.jsx)(U,{className:o.picker,visible:r,background:t,onVisibleChange:i,onBackgroundChange:a.onBackgroundChange})]})};return n.displayName=null!=t?t:"FormItemBackground",n},er=(e,t)=>(0,f.ZC)({container:{display:"flex",alignItems:"center",caretColor:"transparent"},swatch:{display:"inline-block",padding:3,border:"1px solid rgba(0,0,0,.2)",borderRadius:"1px",background:"#fff",cursor:t?"default":"pointer"},colorSquare:"image"===e.prefer?{width:32,height:32,borderRadius:2,background:(0,f.l9)(e),backgroundSize:"cover"}:{width:32,height:12,borderRadius:2,background:(0,f.l9)(e),backgroundSize:"cover"},picker:{"&&":{left:30}}}),ei=e=>{let{componentName:t}=e,n=e=>{let{value:t,disabled:n}=e,[r,i]=h.useState(!1),a={onTogglePickerVisible:(0,E.$0)(()=>{n||i(e=>!e)}),onColorChange:(0,E.$0)(t=>{n||e.onChange(t)})},o=ea(t,n);return(0,d.jsxs)("div",{className:o.container,children:[(0,d.jsx)("div",{className:o.swatch,onClick:a.onTogglePickerVisible,children:(0,d.jsx)("div",{className:o.colorSquare})}),(0,d.jsx)(Z,{className:o.picker,visible:r,color:t,onVisibleChange:i,onColorChange:a.onColorChange})]})};return n.displayName=null!=t?t:"FormItemColor",n},ea=(e,t)=>(0,f.ZC)({container:{display:"flex",alignItems:"center",caretColor:"transparent"},swatch:{display:"inline-block",padding:3,border:"1px solid rgba(0,0,0,.2)",borderRadius:"1px",background:"#fff",cursor:t?"default":"pointer"},colorSquare:{width:32,height:12,borderRadius:2,backgroundColor:(0,f.xv)(e)},picker:{"&&":{left:30}}});var eo=n(55819),el=n(45018);let es=e=>{let{choices:t,componentName:n,normalize:r=e=>e}=e,i=Array.isArray(t)?t.map(e=>(0,d.jsx)(eo.Z,{value:e,children:e},e)):Object.keys(t).map(e=>(0,d.jsx)(eo.Z,{value:e,children:t[e]},e)),a=e=>{let t={onChange:(0,E.$0)(t=>{let n=r(t.target.value);e.onChange(n)})};return(0,d.jsx)(el.Z,{variant:"standard",required:e.required,disabled:e.disabled,value:e.value,onChange:t.onChange,children:i})};return a.displayName=null!=n?n:"FormItemEnum",a};var ec=n(98271);let ed=e=>{let{componentName:t}=e,n=e=>{let[t,n]=(0,E.nu)(e.value),r={onChange:(0,E.$0)(e=>{n(e.target.value)}),onBlur:(0,E.$0)(()=>{e.onChange(t)})};return(0,d.jsx)(ec.Z,{variant:"standard",disabled:e.disabled,required:e.required,value:t,onChange:r.onChange,onBlur:r.onBlur})};return n.displayName=null!=t?t:"FormItemString",n},eu=["name","type","pieceFill"],ep={keys:eu,Component:e=>{let t=w(e=>e.state.gameStatus),n=t===v.f$.PENDING,r=t===v.f$.FINISHED,i=h.useMemo(()=>({name:{label:"Name",disabled:r,ContentRenderer:ed({componentName:"GomokuSettingPlayerName"})},type:{label:"Type",disabled:!n,ContentRenderer:es({componentName:"GomokuSettingPlayerType",choices:[s.HUMAN,s.COMPUTER,s.STUPID_COMPUTER]})},pieceFill:{label:"Avatar",disabled:r,ContentRenderer:en({componentName:"GomokuSettingPlayerAvatar"})}}),[n,r]);return(0,d.jsx)(z,{data:e.data,items:i,itemsOrder:eu,classes:eh,onChange:e.onChange})}},eh=(0,f.ZC)({formItem:{margin:"1rem 1rem",alignItems:"center"},label:{minWidth:"6rem"}}),ef=e=>{let{playerId:t}=e,n=w(e=>e.dispatch),r=w(e=>e.state.gameStatus),i=w(e=>e.state.players[t]),a=h.useMemo(()=>{let e=S.players[t];return{name:e.name,type:e.type,pieceFill:e.preference.pieceFillStyle,pieceStroke:e.preference.pieceStrokeStyle}},[t]),l=h.useMemo(()=>({name:i.name,type:i.type,pieceFill:i.preference.pieceFillStyle,pieceStroke:i.preference.pieceStrokeStyle}),[i]),s=h.useMemo(()=>[ep],[]),c=r===v.f$.FINISHED,u={onRealTimeChange:(0,E.$0)(e=>{n({type:o.MODIFY_PLAYER,payload:{id:t,type:e.type,name:e.name,preference:(0,f.S4)({pieceFillStyle:e.pieceFill,pieceStrokeStyle:e.pieceStroke})}})}),onSave:t=>{u.onRealTimeChange(t),e.onClose()},onDiscard:(0,E.$0)(t=>{u.onRealTimeChange(t),e.onClose()})};return(0,d.jsx)(h.Fragment,{children:e.visible&&(0,d.jsx)(Q,{container:e.containerRef.current,initialData:l,factoryData:a,isResetAvailable:!c,formGroups:s,classes:em,onSave:u.onSave,onDiscard:u.onDiscard,onRealTimeChange:u.onRealTimeChange})})},em=(0,f.ZC)({dialog:{minWidth:240,minHeight:400}}),eg=e=>{let t=w(e=>e.dispatch),n=w(e=>e.state.gameStatus),r=w(e=>e.state.mover),[i,a]=w(e=>e.state.players),[l,s]=h.useState(null),c=n===v.f$.RUNNING,u=n===v.f$.PENDING,p={onCancel:(0,E.$0)(()=>s(null)),onEditPlayer0:(0,E.$0)(()=>s(0)),onEditPlayer1:(0,E.$0)(()=>s(1)),onPlayer0AvatarChange:(0,E.$0)(e=>{t({type:o.MODIFY_PLAYER,payload:{id:0,preference:{pieceFillStyle:e}}})}),onPlayer1AvatarChange:(0,E.$0)(e=>{t({type:o.MODIFY_PLAYER,payload:{id:1,preference:{pieceFillStyle:e}}})})},f=ev();return(0,d.jsxs)("div",{className:f.container,children:[(0,d.jsx)(H,{position:"left",className:f.player0,name:i.name,type:i.type,avatar:i.preference.pieceFillStyle,disabled:!u,running:c,thinking:0===r,onEdit:p.onEditPlayer0,onAvatarChange:p.onPlayer0AvatarChange},"player0"),(0,d.jsx)("span",{className:f.versus,children:"VS"}),(0,d.jsx)(H,{position:"right",className:f.player1,name:a.name,type:a.type,avatar:a.preference.pieceFillStyle,disabled:!u,running:c,thinking:1===r,onEdit:p.onEditPlayer1,onAvatarChange:p.onPlayer1AvatarChange},"player1"),null!=l&&(0,d.jsx)(ef,{containerRef:e.containerRef,visible:!0,playerId:l,onClose:p.onCancel})]})},ev=()=>(0,f.ZC)({container:{display:"flex",alignItems:"center",maxWidth:"min(90vw, 400px)",height:"3rem",width:"100%",margin:"auto"},player0:{flex:"1 1 0",display:"flex"},player1:{flex:"1 1 0",display:"flex"},versus:{flex:"0 0 auto",margin:"0 36px"}});var ey=n(82729),ek=n(96374);class ex{init(e){var t;this.canvas=e,window.addEventListener("resize",this.onresize),null===(t=this.canvas)||void 0===t||t.addEventListener("click",this.onclick),this.onresize()}reset(e){null!=e.GOMOKU_SIZE&&(this.GOMOKU_SIZE=e.GOMOKU_SIZE),null!=e.pieceDrawer&&(this.pieceDrawer=e.pieceDrawer),null!=e.styles&&(this.styles={...this.styles,...e.styles}),this.canvas!==e.canvas&&(console.log("destroying canvas"),this.destroy(),this.init(e.canvas)),this.onresize()}destroy(){var e;window.removeEventListener("resize",this.onresize),null===(e=this.canvas)||void 0===e||e.removeEventListener("click",this.onclick)}async draw(e){let{_drawingStatus:t}=this;if(t.drawing){t.requesting=!0,t.requestData=[e];return}t.drawing=!0,this.pieces=e;try{let{canvas:e,bufferCanvas:t}=this,n=null==e?void 0:e.getContext("2d");if(null==e||null==n)return;let{width:r,height:i}=e;t.width=r,t.height=i;let a=t.getContext("2d");null!=a?(a.clearRect(0,0,r,i),await this._drawAll(a),n.clearRect(0,0,r,i),n.drawImage(t,0,0)):(n.clearRect(0,0,r,i),await this._drawAll(n))}finally{t.drawing=!1,t.requesting&&(t.requesting=!1,await this.draw(...t.requestData))}}async _drawAll(e){this._drawBoard(e),this._drawLocatePoints(e),await this._drawPieces(e),this._drawLastPlacedHighlight(e),this._drawActivatedCellHighlight(e)}_drawBoard(e){let{lineWidth:t,farTop:n,farRight:r,farBottom:i,farLeft:a,gridSize:o,styles:l}=this,s=o+t;e.lineWidth=t,e.strokeStyle=l.gridLineColor,e.beginPath();for(let t=n;t<=i;t+=s)e.moveTo(t,a),e.lineTo(t,r);for(let t=a;t<=r;t+=s)e.moveTo(n,t),e.lineTo(i,t);e.closePath(),e.stroke()}_drawLocatePoints(e){let{lineWidth:t,GOMOKU_SIZE:n,styles:r}=this,i=n-1>>1,a=i%4==0?4:i%4,o=t+6>>1;e.fillStyle=r.locatePointColor;for(let t=a;t+1<n;t+=4)for(let r=a;r+1<n;r+=4){let{x:n,y:i}=this.position(t,r);e.beginPath(),e.arc(n,i,o,0,ek.QA,!1),e.closePath(),e.stroke(),e.fill()}}async _drawPieces(e){if(null==this.pieceDrawer)return;let{GOMOKU_SIZE:t,pieceDrawer:n,pieceRadius:r,pieces:i}=this,a=[],o=[];for(let{r:e,c:n,p:r}of i)if(e>=0&&e<t&&n>=0&&n<t){let t=this.position(e,n);0===r?a.push(t):1===r&&o.push(t)}await Promise.allSettled([n.drawPieces(e,0,r,a),n.drawPieces(e,1,r,o)])}_drawLastPlacedHighlight(e){if(this.pieces.length<=0)return;let{GOMOKU_SIZE:t,pieces:n,pieceRadius:r,activateCell:i}=this,{r:a,c:o}=n[n.length-1];if((a!==i.r||o!==i.c)&&a>=0&&a<t&&o>=0&&o<t){let{x:t,y:n}=this.position(a,o);e.setLineDash([5,3]),e.lineWidth=1,e.strokeStyle="#c80000",e.beginPath(),e.arc(t,n,r+4,0,ek.QA,!1),e.closePath(),e.stroke(),e.setLineDash([])}}_drawActivatedCellHighlight(e){let{GOMOKU_SIZE:t,activateCell:n,pieceRadius:r}=this,{r:i,c:a}=n;if(i>=0&&i<t&&a>=0&&a<t){let{x:t,y:n}=this.position(i,a);e.setLineDash([5,3]),e.lineWidth=1,e.strokeStyle="blue",e.beginPath(),e.arc(t,n,r+4,0,ek.QA,!1),e.closePath(),e.stroke(),e.setLineDash([])}}locate(e,t){let{GOMOKU_SIZE:n,pieceRadius:r}=this,i=this.gridSize+this.lineWidth,a=e-this.farLeft,o=t-this.farTop,l=Math.floor(o/i),s=Math.floor(a/i),c=a-s*i,d=o-l*i;return 2*c>i&&(s+=1,c=i-c),2*d>i&&(l+=1,d=i-d),l>=0&&l<n&&s>=0&&s<n&&Math.abs(c)<=r&&Math.abs(d)<=r?{r:l,c:s}:{r:-1,c:-1}}position(e,t){let{lineWidth:n,gridSize:r,farLeft:i,farTop:a}=this,o=r+n;return{x:i+t*o,y:a+e*o}}updateActivateCell(e,t){this.activateCell.r=e,this.activateCell.c=t,this.draw(this.pieces)}constructor(e){var t,n,r,i,a;this.canvas=null,this.pieceDrawer=null,this.pieceRadius=0,this.gridSize=0,this.farTop=0,this.farRight=0,this.farBottom=0,this.farLeft=0,this.activateCell={r:-1,c:-1},this._drawingStatus={drawing:!1,requesting:!1,requestData:[[]]},this.onresize=()=>{let{canvas:e,GOMOKU_SIZE:t,lineWidth:n}=this;if(null==e)return;let r=e.parentElement;if(null!=r){var i;let a=Math.min(r.clientWidth,r.clientHeight),o=n*t,l=Math.floor((a-o)/(t+.2));if(l<12)throw TypeError("Canvas is not large enough. clientWidth(".concat(r.clientWidth,"), clientHeight(").concat(r.clientHeight,")"));e.width=a,e.height=a;let s=a-o-l*(t-1);this.farLeft=this.farTop=Math.floor(s/2),this.farRight=this.farBottom=a-(s-this.farLeft),this.gridSize=l;let c=Math.round((this.lineWidth+16)/2)+1;this.pieceRadius=null!==(i=this.__customPieceRadius)&&void 0!==i?i:Math.floor(Math.min(.4*l,Math.max(.3*this.gridSize,c))),this.draw(this.pieces)}},this.onclick=e=>{let{GOMOKU_SIZE:t}=this,{offsetX:n,offsetY:r}=e,{r:i,c:a}=this.locate(n,r);if(i>=0&&i<t&&a>=0&&a<t){var o,l;this.updateActivateCell(i,a),null===(l=(o=this.listeners).onClick)||void 0===l||l.call(o,i,a)}},this.GOMOKU_SIZE=e.lines,this.pieces=e.pieces,this.lineWidth=null!==(r=e.lineWidth)&&void 0!==r?r:1,this.pieceDrawer=e.pieceDrawer,this.listeners={...e.listeners},this.bufferCanvas=document.createElement("canvas"),this.styles={gridLineColor:null!==(i=null===(t=e.styles)||void 0===t?void 0:t.gridLineColor)&&void 0!==i?i:"#492d15",locatePointColor:null!==(a=null===(n=e.styles)||void 0===n?void 0:n.locatePointColor)&&void 0!==a?a:"#333333"},this.__customPieceRadius=e.pieceRadius,this.init(e.canvas)}}var eN=n(6260);class eC{drawPieces(e,t,n,r){let i=2*n,{pieceFillStyle:a,pieceStrokeStyle:o}=this.getPreferenceSettings(t),l=null!=o?(0,f.xv)(o):"";switch(l&&(e.strokeStyle=l),a.prefer){case"color":for(let{x:t,y:i}of((0,eN.Z)(null!=a.color,"[drawPiece] color is not defined"),e.fillStyle=(0,f.xv)(a.color),r))e.beginPath(),e.arc(t,i,n,0,ek.QA,!1),e.closePath(),e.stroke(),e.fill();return Promise.resolve();case"image":{(0,eN.Z)(null!=a.imageUrl,"[drawPiece] imageUrl is not defined");let t=document.createElement("img");return t.src=a.imageUrl,new Promise(a=>{t.onload=()=>{for(let{x:a,y:o}of r)e.save(),e.beginPath(),e.arc(a,o,n,0,ek.QA,!1),e.closePath(),e.clip(),e.drawImage(t,0,0,t.width,t.height,a-n,o-n,i,i),e.restore();a()}})}default:return Promise.resolve()}}constructor(e){this.getPreferenceSettings=e}}var eb=n(25289);class eS{get isRunning(){return this._running}request(e){if(!this._running){var t;this._running=!0,null===(t=this._worker)||void 0===t||t.postMessage(e)}}constructor(e){if(this._running=!1,this._worker=null,e.canUseDOM&&"undefined"!=typeof Worker){let{scriptURL:t,options:n,onResponse:r}=e,i=new Worker(t,n);i.onmessage=e=>{this._running=!1,r(e)},this._worker=i}}}(c||(c={})).MOVE="move";let e_=new class{run(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,{_tasks:r,_taskMap:i,_previousTaskHolder:a}=this;return new Promise((o,l)=>{this._taskId+=1;let s={id:this._taskId,type:e,data:t,status:"pending",resolve:o,reject:l};r.enqueue(s),i.set(s.id,s);let c=a.get(n);void 0!==c&&"pending"===c.status&&(c.status="canceled",c.resolve(null),s.id=c.id),a.set(n,s),this._schedule()})}_schedule(){let e;let t=this._workers.find(e=>!e.isRunning);if(void 0===t)return;let{_tasks:n}=this;for(;n.size>0&&"pending"!==(e=n.dequeue()).status;);(null==e?void 0:e.status)==="pending"&&(e.status="running",t.request({id:e.id,type:e.type,data:e.data}))}constructor(e){var t;let n=Math.max(1,Math.min(100,e.workerInstanceCount));this._requestId=0,this._taskId=0,this._tasks=new eb.T,this._taskMap=new Map,this._previousTaskHolder=new Map,this._tasks.init(),this._tasks.resize(null!==(t=e.MAX_TASK_NUMBER)&&void 0!==t?t:1e4),this._workers=Array(n).fill([]).map(()=>new eS({canUseDOM:e.canUseDOM,scriptURL:e.workerUrl,options:e.workerOptions,onResponse:e=>{let{id:t,data:n,error:r}=e.data,i=this._taskMap.get(t);switch((0,eN.Z)(void 0!==i,()=>"[Webworker] Cannot find the running task with id (".concat(t,")")),i.status){case"running":null===n?i.reject("[Webworker] Cannot solve the request. ".concat(r)):i.resolve(n),i.status="done";break;case"pending":case"done":throw Error("[Webworker] Bad task status (".concat(i.status,"). id (").concat(t,")"))}this._schedule()}}))}}({canUseDOM:ek.Nq,workerUrl:"/asset/js/webworker/gomoku.js",workerInstanceCount:1,MAX_TASK_NUMBER:10});async function ew(e){let t=await e_.run(c.MOVE,e);if(null===t)return[-1,-1];let{r:n,c:r}=t;return[n,r]}class eI{async move(e){let t=Date.now(),n=this._move(e),r=t+this.MINIMAL_THINKING_TIME-Date.now();return r>0&&await (0,f._v)(r),n}constructor(e){var t;let n=Math.min(3e5,null!==(t=e.MINIMAL_THINKING_TIME)&&void 0!==t?t:0);this.MINIMAL_THINKING_TIME=n}}class eE extends eI{async _move(e){let{MAX_ROW:t,MAX_COL:n,pieces:r,playerId:i}=e,[a,o]=await ew({MAX_ROW:t,MAX_COL:n,pieces:r,playerId:i,MAX_ADJACENT:this.MAX_ADJACENT,MAX_DISTANCE_OF_NEIGHBOR:this.MAX_DISTANCE_OF_NEIGHBOR});return[a,o]}constructor(e){super(e),this.type=s.COMPUTER,this.automatic=!0,this.MAX_ADJACENT=e.MAX_ADJACENT,this.MAX_DISTANCE_OF_NEIGHBOR=e.MAX_DISTANCE_OF_NEIGHBOR,this.scoreMap=e.scoreMap}}class eR extends eI{_move(e){if(null!=e.clickedPos){let{r:t,c:n}=e.clickedPos;return[t,n]}return[-1,-1]}constructor(...e){super(...e),this.type=s.HUMAN,this.automatic=!1}}var ej=n(66420);class eP extends eI{_move(e){let{MAX_ROW:t,MAX_COL:n}=e;if(e.pieces.length<=0)return[t>>1,n>>1];let r=e.pieces.slice();(0,ej.ZP)(r);let i=k.bs.slice();for(let e of((0,ej.ZP)(i),r))for(let[a,o]of i){let i=e.r+a,l=e.c+o;if(i>=0&&i<t&&l>=0&&l<n){if(r.some(e=>e.r===i&&e.c===l))continue;return[i,l]}}return[-1,-1]}constructor(...e){super(...e),this.type=s.STUPID_COMPUTER,this.automatic=!0}}let eT=e=>{switch(e.type){case s.HUMAN:return new eR({MINIMAL_THINKING_TIME:0});case s.COMPUTER:return new eE({MAX_ADJACENT:5,MAX_DISTANCE_OF_NEIGHBOR:2,MINIMAL_THINKING_TIME:300});case s.STUPID_COMPUTER:return new eP({MINIMAL_THINKING_TIME:300})}},eA=()=>{var e;let t=w(e=>e.dispatch),n=w(e=>e.state.gameStatus),r=w(e=>e.state.MAX_ROW),i=w(e=>e.state.MAX_COL),a=w(e=>e.state.pieces),l=w(e=>e.state.players),s=w(e=>e.state.mover),c=h.useRef([]);(null===(e=c.current[s])||void 0===e?void 0:e.type)!==l[s].type&&(c.current[s]=eT(l[s]));let d=c.current[s],u=h.useRef(!1),p=(0,E.$0)(async e=>{if(!u.current&&void 0!==d&&n===v.f$.RUNNING)try{u.current=!0;let[n,l]=await d.move({MAX_ROW:r,MAX_COL:i,pieces:a,playerId:s,clickedPos:e});(0,eN.Z)(n>=0&&n<r&&l>=0&&l<=i,()=>"[Unexpected moving] currentPlayer(".concat(s,"}), moving: (").concat(n,", ").concat(l,")")),t({type:o.MOVE,payload:{r:n,c:l}})}finally{u.current=!1,await (0,f._v)(50)}});return h.useEffect(()=>{if(n===v.f$.RUNNING&&d.automatic){let e=setTimeout(()=>void p(),0);return()=>clearTimeout(e)}},[d,p,n]),{move:p}};function eM(){let e=(0,ey._)(["\n      position: relative;\n      box-sizing: content-box;\n      display: inline-block;\n      width: 100%;\n      height: 100%;\n      padding: 0;\n      border: 0;\n      margin: 0;\n      font-family: Consolas, 'Source Code Pro', 'Roboto Mono', monospace, sans-serif;\n    "]);return eM=function(){return e},e}function eD(){let e=(0,ey._)(["\n      z-index: 2;\n      position: absolute;\n      top: 0;\n      left: 0;\n      right: 0;\n      bottom: 0;\n      display: none;\n      width: 100%;\n      height: 100%;\n      overflow: hidden;\n      background: linear-gradient(\n        45deg,\n        hsl(30deg 20% 90% / 0.2),\n        hsl(210deg 20% 100% / 0.3)\n      );\n    "]);return eD=function(){return e},e}function eO(){let e=(0,ey._)(["\n      && {\n        display: block;\n        backdrop-filter: blur(1px);\n      }\n    "]);return eO=function(){return e},e}function eU(){let e=(0,ey._)(["\n      && {\n        display: none;\n      }\n    "]);return eU=function(){return e},e}function e$(){let e=(0,ey._)(["\n      && {\n        display: block;\n        backdrop-filter: blur(4px);\n      }\n    "]);return e$=function(){return e},e}function eF(){let e=(0,ey._)(["\n      && {\n        display: block;\n        backdrop-filter: blur(4px);\n        color: #ff00ff;\n        animation: 1s 0s "," ease-in-out;\n      }\n    "]);return eF=function(){return e},e}function eZ(){let e=(0,ey._)(["\n    0% {\n      transform: translate(0, -100px);\n    }\n    80% {\n      transform: translate(0, 20px);\n    }\n    90% {\n      transform: translate(0, -10px);\n    }\n    95% {\n      transform: translate(0, 2px);\n    }\n    100% {\n      transform: translate(0, 0);\n    }\n  "]);return eZ=function(){return e},e}let eG=e=>{let{overlay:t,className:n}=e,r=w(e=>e.state.MAX_ROW),i=w(e=>e.state.pieces),a=w(e=>e.state.gameStatus),o=w(e=>e.state.players),l=w(e=>e.state.preference.borderColor),s=w(e=>e.state.forceRenderTick),c=h.useRef(null),u=eA(),p=(0,E.$0)((e,t)=>{e>=0&&e<r&&t>=0&&t<r&&u.move({r:e,c:t})}),m=(0,E.$0)(e=>o[e].preference),g=(0,E.$0)(async()=>{await (null==v?void 0:v.draw(i))}),[v,y]=h.useState(null);h.useEffect(()=>{let e=new eC(m),t=new ex({canvas:c.current,lines:15,pieces:[],pieceDrawer:e,listeners:{onClick:p}});return y(t),()=>t.destroy()},[p,m]);let k=(0,f.xv)(l);h.useEffect(()=>{null!=v&&(v.reset({canvas:c.current,GOMOKU_SIZE:r,styles:{gridLineColor:k}}),g())},[v,r,k,g]),h.useEffect(()=>{null==v||v.draw(i)},[v,i,s]);let x=eB();return(0,d.jsxs)("div",{className:(0,R.cx)(x.container,n),children:[(0,d.jsx)("div",{className:(0,R.cx)(x.overlay,x["overlay_".concat(a)]),children:t},"overlay"),(0,d.jsx)("canvas",{ref:c})]})},eB=()=>({container:(0,R.iv)(eM()),overlay:(0,R.iv)(eD()),["overlay_".concat(v.f$.PENDING)]:(0,R.iv)(eO()),["overlay_".concat(v.f$.RUNNING)]:(0,R.iv)(eU()),["overlay_".concat(v.f$.PAUSED)]:(0,R.iv)(e$()),["overlay_".concat(v.f$.FINISHED)]:(0,R.iv)(eF(),eH.finished)}),eH={finished:(0,R.F4)(eZ())};var eL=n(9171),eW=n(41616),ez=n(70655),eX=n(1849);let eq=()=>{let e=w(e=>e.dispatch),t=w(e=>e.state.attemptTick),n=w(e=>e.state.winner),r=w(e=>e.state.gameStatus),i=w(e=>e.state.players),a=i[n],l=t>0,s=(0,eL.D)();h.useEffect(()=>{l&&r===v.f$.FINISHED&&void 0!==a&&s()},[l,r,a,s]);let c=eY();return h.useMemo(()=>{switch(r){case v.f$.PENDING:return(0,d.jsx)("div",{className:c.overlay,children:(0,d.jsx)(M.Z,{className:c.button,variant:"contained",color:"primary",startIcon:(0,d.jsx)(ez.Z,{}),onClick:()=>e({type:o.START}),children:"Start"})});case v.f$.PAUSED:return(0,d.jsx)("div",{className:c.overlay,children:(0,d.jsx)(M.Z,{className:c.button,variant:"contained",color:"primary",startIcon:(0,d.jsx)(eW.Z,{}),onClick:()=>e({type:o.RESUME}),children:"Resume"})});case v.f$.FINISHED:return(0,d.jsx)("div",{className:c.overlay,children:(0,d.jsxs)("div",{className:c.finishedBanner,children:[void 0!==a?(0,d.jsxs)("div",{className:c.blessing,children:[(0,d.jsxs)("div",{className:c.winner,children:[(0,d.jsx)("span",{className:c.winnerAvatar,style:{background:(0,f.l9)(a.preference.pieceFillStyle),backgroundSize:"cover"}},"avatar"),(0,d.jsx)("span",{className:c.winnerName,children:a.name},"name")]}),"win\uD83C\uDF89"]}):(0,d.jsx)("p",{children:"Draw!"}),(0,d.jsx)(M.Z,{className:c.button,variant:"contained",color:"primary",startIcon:(0,d.jsx)(eX.Z,{}),onClick:()=>e({type:o.RESTART}),children:"New"})]})});default:return null}},[r,c,e,a])},eY=()=>h.useMemo(()=>(0,f.ZC)({overlay:{position:"relative",display:"flex",alignItems:"center",justifyContent:"center",height:"100%",width:"100%",userSelect:"none"},confettiCanvas:{top:0,bottom:0,left:0,right:0,width:"100%",height:"100%"},button:{"&&, &&:hover":{boxShadow:"4px 4px 16px 0px hsl(0deg 0% 0% / 0.75)"}},finishedBanner:{position:"relative",display:"flex",flexDirection:"column",justifyContent:"center",padding:0,margin:0,fontSize:32},blessing:{display:"flex",alignItems:"center",marginBottom:"1rem"},winner:{display:"flex",flexDirection:"column",alignItems:"center",marginRight:16},winnerAvatar:{display:"inline-block",width:32,height:32,borderRadius:"50%"},winnerName:{color:"#333",fontSize:12}}),[]);var eK=n(44993),eV=n(51334),eJ=n(94229),eQ=n(93946);let e0=["size","background","border"],e1={keys:e0,Component:e=>{let t=w(e=>e.state.gameStatus),n=t===v.f$.PENDING,r=t===v.f$.FINISHED,i=h.useMemo(()=>({size:{label:"Size",disabled:!n,ContentRenderer:es({componentName:"GomokuSettingBoardSize",choices:Object.fromEntries([5,7,9,11,13,15,17,19,21,23,25].map(e=>[e,"".concat(e,"x").concat(e)])),normalize:e=>Number(e)})},background:{label:"Background",disabled:r,ContentRenderer:en({componentName:"GomokuSettingBoardBackground"})},border:{label:"Board",disabled:r,ContentRenderer:ei({componentName:"GomokuSettingBoardColor"})}}),[n,r]);return(0,d.jsx)(z,{data:e.data,items:i,itemsOrder:e0,classes:e2,onChange:e.onChange})}},e2=(0,f.ZC)({formItem:{margin:"1rem 1rem",alignItems:"center"},label:{minWidth:"6rem"}}),e4=e=>{let t=w(e=>e.dispatch),n=w(e=>e.state.gameStatus),r=w(e=>e.state.MAX_ROW),i=w(e=>e.state.preference.boardBackground),a=w(e=>e.state.preference.borderColor),[l,s]=h.useState(!1),c=h.useMemo(()=>({size:S.MAX_ROW,background:S.preference.boardBackground,border:S.preference.borderColor}),[]),u=h.useMemo(()=>({size:r,background:i,border:a}),[r,i,a]),p=h.useMemo(()=>[e1],[]),m=n===v.f$.FINISHED,g={onOpenDialog:(0,E.$0)(()=>s(!0)),onRealTimeChange:(0,E.$0)(e=>{let n=[r!==e.size?{type:o.RESET,payload:{MAX_ROW:e.size,MAX_COL:e.size}}:void 0,i!==e.background||a!==e.border?{type:o.MODIFY_PREFERENCE,payload:{preference:{boardBackground:e.background,borderColor:e.border}}}:void 0].filter(f.it);t(n)}),onSave:e=>{g.onRealTimeChange(e),s(!1)},onDiscard:(0,E.$0)(e=>{g.onRealTimeChange(e),s(!1)})},{WakeBtn:y=e3}=e;return(0,d.jsxs)("div",{className:(0,R.cx)(e6.container,e.className),children:[(0,d.jsx)(y,{onWakeUp:g.onOpenDialog}),l&&(0,d.jsx)(Q,{container:e.containerRef.current,initialData:u,factoryData:c,isResetAvailable:!m,formGroups:p,classes:e9,onSave:g.onSave,onDiscard:g.onDiscard,onRealTimeChange:g.onRealTimeChange})]})},e3=e=>(0,d.jsx)(eQ.Z,{size:"small",className:e6.wakeBtn,onClick:e.onWakeUp,children:(0,d.jsx)(eJ.Z,{})}),e6=(0,f.ZC)({container:{},wakeBtn:{"> svg":{width:18,height:18}}}),e9=(0,f.ZC)({dialog:{minWidth:240,minHeight:400}}),e5=e=>{let t=w(e=>e.dispatch),n=w(e=>e.state.gameStatus),r=w(e=>e.state.mover),i=w(e=>e.state.pieces),[a,l]=h.useState(!1),s={flip:(0,E.$0)(()=>t({type:o.FLIP_PLAYER})),retract:(0,E.$0)(()=>t({type:o.RETRACT})),restart:(0,E.$0)(()=>{l(!1),t({type:o.RESTART})}),start:(0,E.$0)(()=>{n===v.f$.PENDING||n===v.f$.FINISHED?t({type:o.RESTART}):l(!0)}),closeDialog:(0,E.$0)(()=>l(!1))},c=e8(),u=n!==v.f$.PENDING,p=(n===v.f$.RUNNING||n===v.f$.FINISHED)&&i.some(e=>e.p===r),f=n===v.f$.PENDING;return(0,d.jsxs)("div",{className:c.toolbar,children:[(0,d.jsxs)("div",{className:(0,R.cx)(c.item,c.buttons),children:[(0,d.jsx)(M.Z,{variant:"contained",color:"inherit",size:"small",startIcon:(0,d.jsx)(eX.Z,{}),disabled:!u,onClick:s.start,children:(0,d.jsx)("span",{className:c.buttonText,children:"New"})}),(0,d.jsx)(M.Z,{variant:"contained",color:"inherit",size:"small",startIcon:(0,d.jsx)(eK.Z,{}),disabled:!p,onClick:s.retract,children:(0,d.jsx)("span",{className:c.buttonText,children:"Retract"})}),(0,d.jsx)(M.Z,{variant:"contained",color:"inherit",size:"small",startIcon:(0,d.jsx)(eV.Z,{}),disabled:!f,onClick:s.flip,children:(0,d.jsx)("span",{className:c.buttonText,children:"Flip"})}),(0,d.jsx)(e4,{containerRef:e.containerRef})]}),(0,d.jsxs)(K.Z,{container:e.containerRef.current,open:a,onClose:()=>l(!1),"aria-labelledby":"confirm-to-restart",children:[(0,d.jsx)(V.Z,{children:"Are you sure you want to start a new game?"}),(0,d.jsxs)(J.Z,{children:[(0,d.jsx)(M.Z,{color:"inherit",onClick:s.closeDialog,children:"Cancel"}),(0,d.jsx)(M.Z,{color:"primary",onClick:s.restart,children:"Confirm"})]})]})]})},e8=()=>(0,f.ZC)({toolbar:{display:"block",maxWidth:"min(90vw, 400px)",margin:"auto"},item:{display:"flex",flexWrap:"wrap",alignItems:"center",justifyContent:"flex-start",margin:"1rem 0"},buttons:{justifyContent:"space-around","> button":{display:"flex",justifyContent:"spaceBetween",alignItems:"center",margin:"0 4px"}},buttonText:{lineHeight:1.1}}),e7=()=>{let e=w(e=>e.dispatch),t=h.useRef(null),n=te();return h.useEffect(()=>{let t=()=>e({type:o.PAUSE});return window.addEventListener("beforeunload",t),()=>window.removeEventListener("beforeunload",t)},[e]),(0,d.jsxs)("div",{ref:t,className:n.container,children:[(0,d.jsxs)("div",{className:n.header,children:[(0,d.jsx)(eg,{containerRef:t}),(0,d.jsx)(e5,{containerRef:t})]}),(0,d.jsx)("div",{className:n.main,children:(0,d.jsx)(eG,{overlay:(0,d.jsx)(eq,{})})})]})},te=()=>{let e=w(e=>e.state.preference.boardBackground);return(0,f.ZC)({container:{boxSizing:"border-box",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",width:"100%"},header:{boxSizing:"border-box",display:"flex",flexDirection:"column",justifyContent:"center",width:"100%",padding:"2vmin"},main:{boxSizing:"border-box",height:"96vmin",width:"96vmin",background:(0,f.l9)(e),backgroundSize:"cover","@media (min-width: 1367px)":{width:"60vmin",height:"60vmin"}}})},tt=e=>(0,d.jsx)(I,{storageKey:e.storageKey,initialData:e.initialState,children:(0,d.jsx)(e7,{})});tt.propTypes={storageKey:p().string.isRequired};var tn=n(64712),tr=()=>{let e=h.useMemo(()=>({}),[]);return(0,d.jsx)(tn.V,{title:"Gomoku Game",children:(0,d.jsx)(tt,{initialState:e,storageKey:"@kyokuya/gomoku-game/context0/"})})}},52091:function(e){e.exports={popover:"BackgroundPicker_popover__cSgii",cover:"BackgroundPicker_cover__Y1CpN",backgroundPicker:"BackgroundPicker_backgroundPicker__DOggM",backgroundPrefer:"BackgroundPicker_backgroundPrefer__jFab2",backgroundRadioGroup:"BackgroundPicker_backgroundRadioGroup__oY5vu",imagePickerWrapper:"BackgroundPicker_imagePickerWrapper__YNNfB",colorPickerWrapper:"BackgroundPicker_colorPickerWrapper__ZeNE3",colorPicker:"BackgroundPicker_colorPicker__E4J19",imageUploadBtn:"BackgroundPicker_imageUploadBtn__A7M7_"}},36074:function(e){e.exports={popover:"ColorPicker_popover__6cHKC",cover:"ColorPicker_cover__AXb6n",picker:"ColorPicker_picker__zPF_T",colorPicker:"ColorPicker_colorPicker__EwDF5"}},53673:function(e){e.exports={container:"style_container__Bsvj4",header:"style_header__CMYSB",main:"style_main__uTDZM",footer:"style_footer__trG2Z",content:"style_content__yfqPk",copyright:"style_copyright__Vhp_p"}}},function(e){e.O(0,[742,564,524,774,888,179],function(){return e(e.s=40193)}),_N_E=e.O()}]);