(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[921],{40193:function(e,t,i){(window.__NEXT_P=window.__NEXT_P||[]).push(["/game/gomoku",function(){return i(24173)}])},9171:function(e,t,i){"use strict";i.d(t,{D:function(){return l}});var n=i(55402),r=i(95050),s=i(67294);let a=[["#ffbe0b","#fb5607","#ff006e","#8338ec","#3a86ff"],["#9b5de5","#f15bb5","#fee440","#00bbf9","#00f5d4"]],o=()=>{let e=a.length;return a[Math.min(e-1,Math.floor(Math.random()*e))]},l=()=>{let e=s.useRef(!1),t=s.useRef(null);s.useEffect(()=>(t.current=new r.Z,()=>{t.current=null}),[]);let i=(0,n.$0)(async()=>{if(null==t.current)return;let i=t.current,n=o(),r=window.screen.width<=900;e.current=!0;try{await i.addConfetti({confettiColors:n,confettiRadius:r?4:8,confettiNumber:r?100:300})}finally{e.current=!1}});return i}},24729:function(e,t,i){"use strict";i.d(t,{ql:function(){return s},Ee:function(){return c},rU:function(){return g},BD:function(){return d},yj:function(){return p}});var n=i(9008),r=i.n(n);let s=r();var a=i(25675),o=i.n(a),l=i(67294);class c extends l.PureComponent{render(){return l.createElement(o(),this.props)}}let d=[{regex:/^@kyokuya\/_demo\/([\s\S]+)$/,importFunc:e=>()=>i(74243)("./".concat(e[1]))}];var u=i(11163);let p=()=>{let{asPath:e}=(0,u.useRouter)();return l.useMemo(()=>{var t;let i=null!==(t=e.split("#")[1])&&void 0!==t?t:null;return{path:e,hash:i}},[e])};var h=i(41664),m=i.n(h);class g extends l.PureComponent{render(){return l.createElement(m(),{...this.props,legacyBehavior:!1})}}},34781:function(e,t,i){"use strict";i.d(t,{p:function(){return o},X:function(){return r}}),(n=r||(r={}))[n.PENDING=1]="PENDING",n[n.RUNNING=2]="RUNNING",n[n.PAUSED=4]="PAUSED",n[n.END=8]="END";var n,r,s=i(76955),a=i(43908);class o extends s.jz{constructor(e){super();let t=new s.ZM(e.status),i=new s.ZM(e.elapsedTime),n=Date.now(),o=(e,t)=>{let s=Date.now();if(t===r.RUNNING){let e=s-n;i.setState(t=>t+e)}else e===r.PENDING&&i.setState(0);n=s};t.subscribe({next:(e,t)=>o(e,t),complete:()=>{}});let l=(0,a.iP)(()=>{let e=t.getSnapshot();o(e,e)});this.status$=t,this.elapsedTime$=i,this._disposables.push(new s.JT(l))}}},49318:function(e,t,i){"use strict";i.d(t,{tm:function(){return r},OU:function(){return a},Qj:function(){return c}});var n=i(67294);function r(){let[e,t]=n.useState(!1);return n.useEffect(()=>{let e=setTimeout(()=>t(!0),800);return()=>clearTimeout(e)},[]),e}var s=i(43908);function a(e,t){let i=n.useRef(0),r=n.useRef(null),a=(0,s.ei)(e,t);return(null===r.current||o(r.current,a,t))&&(i.current+=1),r.current=a,n.useMemo(()=>r.current,[i.current])}let o=(e,t,i)=>{for(let n of i)if(e[n]===t[n])return!0;return!1};var l=i(60459);function c(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,[i,r]=n.useState(0);return n.useEffect(()=>{let i=null===e?document.documentElement:e.current;if(null==i)return;let n=(0,l.Ds)(()=>{let e=i.scrollTop,t=i.scrollHeight-i.clientHeight;r(e/t)},t);n();let s=i===document.documentElement?window:i;return s.addEventListener("scroll",n),()=>s.removeEventListener("scroll",n)},[e,t]),i}},36435:function(e,t,i){"use strict";i.d(t,{DV:function(){return d},TS:function(){return m},Tl:function(){return x}});var n=i(85893),r=i(18872),s=i(5354),a=i(24729),o=i(43908),l=i(49894),c=i(67294);let d=e=>{let t=(0,s.mY)(e=>e.author$);return(0,n.jsx)(l.Z,{className:(0,r.cx)(u.container,e.className),url:t.about,title:"about",onClick:o.UW,children:(0,n.jsx)(a.Ee,{alt:"avatar",src:t.avatar})})},u={container:(0,r.iv)({display:"inline-block",boxSizing:"border-box",transition:"all 0.3s",padding:0,borderRadius:"50%",margin:0,overflow:"hidden",background:"#88acdb",textAlign:"center",userSelect:"none","&&:hover":{transform:"scale(1.1) rotate(360deg)"},"&>img":{boxSizing:"border-box",display:"inline-block",width:"100%",height:"100%"}})};var p=i(45697),h=i.n(p);let m=e=>{let t=(0,s.mY)(e=>e.title$),i=(0,s.mY)(e=>e.description$),r=(0,s.mY)(e=>e.author$),{description:o=i,title:l}=e;return(0,n.jsxs)(a.ql,{children:[(0,n.jsxs)("title",{children:[l," | ",t]}),(0,n.jsx)("meta",{name:"viewport",content:"initial-scale=1.0, width=device-width"},"viewport"),(0,n.jsx)("meta",{name:"author",content:r.name},"author"),(0,n.jsx)("meta",{name:"description",content:o},"description"),(0,n.jsx)("meta",{property:"og:title",content:l},"og:title"),(0,n.jsx)("meta",{property:"og:description",content:o},"og:description"),(0,n.jsx)("meta",{property:"og:type",content:"website"},"og:type")]})};m.propTypes={title:h().string.isRequired,description:h().string};var g=i(94101),v=i(14651),f=i(24366);let x=e=>{let t=(0,s.O5)(),i=(0,s.mY)(e=>e.theme$),a=i===g.Q2.darken,o=c.useCallback(e=>{e.stopPropagation(),t({type:s.Jx.TOGGLE_THEME,payload:a?g.Q2.light:g.Q2.darken})},[t,a]),l=a?f.Z:v.Z;return(0,n.jsx)("div",{className:(0,r.cx)(y.container,e.className),children:(0,n.jsx)(l,{className:y.icon,onClick:o})})};x.propTypes={className:h().string};let y={container:(0,r.iv)({cursor:"pointer"}),icon:(0,r.iv)({height:24,width:24,color:"hsl(55deg, 40%, 60%)"})}},28514:function(e,t,i){"use strict";i.d(t,{Vj:function(){return v}}),s||(s={}),(n=a||(a={})).colorBgBody="--colorBgBody",n.colorBgHeader="--colorBgHeader",(r=o||(o={}))[r.colorBgBody="var(--colorBgBody)"]="colorBgBody",r[r.colorBgHeader="var(--colorBgHeader)"]="colorBgHeader";var n,r,s,a,o,l=i(85893),c=i(18872),d=i(94101),u=i(5354),p=i(36435),h=i(67294);let m={[a.colorBgBody]:"#4D4D4D",[a.colorBgHeader]:"#333333"},g={[a.colorBgBody]:"#EAEAEA",[a.colorBgHeader]:""},v=e=>{let t=(0,u.mY)(e=>e.author$),i=(0,u.mY)(e=>e.copyright$),n=(0,u.mY)(e=>e.theme$);return(0,l.jsxs)(h.Fragment,{children:[(0,l.jsx)(p.TS,{title:e.title,description:e.description}),(0,l.jsxs)("div",{className:f.container,"data-theme":n,children:[(0,l.jsxs)("header",{className:f.header,children:[(0,l.jsx)("h1",{className:f.title,children:e.title}),(0,l.jsxs)("div",{className:f.toolbarButtons,children:[(0,l.jsx)(p.Tl,{className:f.themeToggle}),(0,l.jsx)(p.DV,{className:f.authorAvatar})]})]}),(0,l.jsx)("main",{className:f.main,children:(0,l.jsx)("div",{className:f.content,children:e.children})}),(0,l.jsx)("footer",{className:f.footer,children:(0,l.jsxs)("div",{className:f.copyright,children:[(0,l.jsxs)("span",{children:["\xa9 ",i.date," ",t.name]},"date"),(0,l.jsx)("span",{children:t.motto},"motto")]})})]})]})},f={container:(0,c.iv)({['&[data-theme="'.concat(d.Q2.light,'"]')]:{...g},['&[data-theme="'.concat(d.Q2.darken,'"]')]:{...m},position:"relative",boxSizing:"border-box",display:"flex",flexDirection:"column",width:"100vw",minHeight:"100vh",background:o.colorBgBody}),header:(0,c.iv)({flex:"0 0 auto",alignItems:"center",display:"flex",boxSizing:"border-box",background:o.colorBgHeader}),title:(0,c.iv)({flex:"1 1 auto",color:"#696969",textAlign:"center",fontFamily:"'lucida grande', 'lucida sans unicode', lucida, helvetica, 'Hiragino Sans GB',\n          'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif",margin:"1rem 0"}),toolbarButtons:(0,c.iv)({flex:"0 0 auto",display:"flex",alignItems:"center"}),themeToggle:(0,c.iv)({marginRight:16,width:24,height:24}),authorAvatar:(0,c.iv)({marginRight:16,width:24,height:24}),main:(0,c.iv)({flex:"1 0 auto",boxSizing:"border-box",width:"100%",marginBottom:"2rem",background:o.colorBgBody}),footer:(0,c.iv)({flex:"0 0 auto",boxSizing:"border-box",width:"100%",padding:"1rem",lineHeight:"2",color:"hsla(0deg, 0%, 85%, 0.8)",background:"hsl(0deg, 0%, 20%)",fontSize:"max(0.8rem, 12px)",fontFamily:"'Andale Mono', 'lucida grande', 'lucida sans unicode', lucida, helvetica,\n        'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif",textShadow:"0 1px #333"}),content:(0,c.iv)({flex:"1 0 auto",boxSizing:"border-box",display:"flex",justifyContent:"center"}),copyright:(0,c.iv)({display:"flex",justifyContent:"space-between",maxWidth:400,margin:"auto",userSelect:"none"})}},49894:function(e,t,i){"use strict";i.d(t,{Z:function(){return g}});var n=i(85893),r=i(67294),s=i(18872),a=i(56517);let o={link:(0,s.iv)({padding:"0.2rem 0",color:a.TV.colorLink,textDecoration:"none",background:"linear-gradient(90deg, hsla(358deg, 100%, 62%, 0.8), hsla(048deg, 100%, 50%, 0.8), hsla(196deg, 100%, 53%, 0.8))",backgroundSize:"0 3px",backgroundRepeat:"no-repeat",backgroundPosition:"50% 100%",transition:"all 0.3s ease-in-out","&:visited":{color:a.TV.colorLink},"&&:hover":{color:a.TV.colorLinkHover,backgroundSize:"100% 3px",backgroundPositionX:0}})};class l extends r.PureComponent{render(){let{children:e,className:t,url:i,rel:r="noopener,noreferrer",target:a="_blank",title:l,...c}=this.props;return(0,n.jsx)("a",{...c,className:(0,s.cx)(o.link,t),href:i,title:l,target:a,rel:r,children:e})}}var c=i(24729);class d extends r.PureComponent{render(){let{children:e,className:t,url:i,title:r,...a}=this.props;return(0,n.jsx)(c.rU,{...a,className:(0,s.cx)(o.link,t),href:i,title:r,children:e})}}var u=i(45697),p=i.n(u);let h={url:p().string.isRequired,title:p().string,children:p().node,className:p().string,rel:p().string,style:p().object,target:p().string};class m extends r.PureComponent{render(){let{url:e,title:t,children:i}=this.props;return/^#/.test(e)?(0,n.jsx)("a",{title:t,href:e,children:i}):/^(\w+:[/]{2})/.test(e)?r.createElement(l,this.props):r.createElement(d,this.props)}}m.propTypes=h;var g=m},24173:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return tl}});var n,r,s,a,o,l,c,d=i(85893),u=i(45697),p=i.n(u),h=i(67294);let m="2023-06-10";(n=a||(a={})).FLIP_PLAYER="@gomoku/flip-player",n.MODIFY_PLAYER="@gomoku/modify-player",n.MODIFY_PREFERENCE="@gomoku/modify-preference",n.MOVE="@gomoku/move",n.PAUSE="@gomoku/pause",n.RESET="@gomoku/reset",n.RESTART="@gomoku/restart",n.RESUME="@gomoku/resume",n.RETRACT="@gomoku/retract",n.START="@gomoku/start",(r=o||(o={})).MOVE="move",r.RETRACT="retract",(s=l||(l={})).HUMAN="human",s.COMPUTER="computer",s.STUPID_COMPUTER="stupid-computer";var g=i(59976);let v=h.createContext(null);v.displayName="GomokuContextType";let f=()=>{let e=h.useContext(v);return e.dispatch},x=e=>{let t=h.useContext(v),i=e(t);return(0,g.vc)(i)};var y=i(34781),b=i(35369),k=i(26812);let N=k.a7.rightHalf,C=e=>e===l.COMPUTER||e===l.STUPID_COMPUTER;function w(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:5,r=new Int32Array(t*i).fill(-1);for(let{r:i,c:n,p:s}of e)r[i*t+n]=s;let s=(e,i)=>e*t+i,a=(e,n)=>e>=0&&e<t&&n>=0&&n<i;for(let e of N){let[o,l]=k.bs[e];for(let e=0;e<t;++e)for(let t=0;t<i;++t){let i=r[s(e,t)];if(i<0)continue;let c=1;for(let n=e+o,d=t+l;a(n,d)&&r[s(n,d)]===i;n+=o,d+=l)c+=1;if(c>=n){if(0!==i&&1!==i)throw Error("[checkWinner] Bad player(".concat(i,") on piece (").concat(e,", ").concat(t,")."));return i}}}return -1}class S{constructor(e){this.restart=()=>{let e=this.viewmodel,t=e.status$.getSnapshot();t!==y.X.PENDING&&(e.status$.next(y.X.PENDING),e.winner$.next(-1),e.mover$.next(0),e.pieces$.next(b.aV.of()),e.instructions$.next(b.aV.of()),e.gameTick$.setState(e=>e+1),e.attemptTick$.next(0))},this.reset=(e,t)=>{let i=this.viewmodel,n=i.status$.getSnapshot();n===y.X.PENDING&&(e&&i.MAX_ROW$.next(e),t&&i.MAX_COL$.next(t),i.status$.next(y.X.PENDING),i.winner$.next(-1),i.mover$.next(0),i.pieces$.next(b.aV.of()),i.instructions$.next(b.aV.of()),i.gameTick$.setState(e=>e+1),i.attemptTick$.next(0))},this.start=()=>{let e=this.viewmodel,t=e.status$.getSnapshot();t===y.X.PENDING&&e.status$.next(y.X.RUNNING)},this.pause=()=>{let e=this.viewmodel,t=e.status$.getSnapshot();t===y.X.RUNNING&&e.status$.next(y.X.PAUSED)},this.resume=()=>{let e=this.viewmodel,t=e.status$.getSnapshot();t===y.X.PAUSED&&e.status$.next(y.X.RUNNING)},this.move=(e,t)=>{let i=this.viewmodel,n=i.status$.getSnapshot();if(n!==y.X.RUNNING)return;let r=i.pieces$.getSnapshot();if(r.some(i=>i.r===e&&i.c===t))return;let s=i.MAX_ROW$.getSnapshot(),a=i.MAX_COL$.getSnapshot(),l=i.mover$.getSnapshot(),c={r:e,c:t,p:l},d=r.push(c),u=w(d,s,a),p=u>=0||d.size===s*a;p&&i.status$.next(y.X.END),i.winner$.next(u),i.pieces$.next(d),i.mover$.next(1^l),i.attemptTick$.setState(e=>e+1),i.instructions$.setState(e=>e.push({type:o.MOVE,payload:c,timestamp:new Date().toISOString()}))},this.retract=()=>{let e=this.viewmodel,t=e.status$.getSnapshot();if(t!==y.X.RUNNING&&t!==y.X.END)return;let i=e.mover$.getSnapshot(),n=e.pieces$.getSnapshot(),r=n.findLastIndex(e=>e.p===i);if(r<0)return;let s=n.size-r,a=n.slice(0,r),l=1&a.size;e.status$.next(y.X.RUNNING),e.pieces$.next(a),e.winner$.next(-1),e.mover$.next(l),e.attemptTick$.setState(e=>e+1),e.instructions$.setState(e=>e.push({type:o.RETRACT,payload:s,timestamp:new Date().toISOString()}))},this.flipPlayer=()=>{let e=this.viewmodel,t=e.status$.getSnapshot();if(t!==y.X.PENDING)return;let[i,n]=e.players$.getSnapshot();e.players$.next([n,i])},this.modifyPlayer=e=>{var t,i,n,r;let s=this.viewmodel,a=s.status$.getSnapshot();if(a===y.X.END)return;if(0!==e.id&&1!==e.id){console.error("[Bad action] modifyPlayer",e);return}let o=s.players$.getSnapshot()[e.id],l={name:e.name||o.name,type:e.type||o.type,preference:{pieceFillStyle:null!==(n=null===(t=e.preference)||void 0===t?void 0:t.pieceFillStyle)&&void 0!==n?n:o.preference.pieceFillStyle,pieceStrokeStyle:null!==(r=null===(i=e.preference)||void 0===i?void 0:i.pieceStrokeStyle)&&void 0!==r?r:o.preference.pieceStrokeStyle}};s.players$.setState(t=>t.map((t,i)=>i===e.id?l:t))},this.modifyPreference=e=>{let t=this.viewmodel,i=t.status$.getSnapshot();i!==y.X.END&&t.preference$.setState(t=>({...t,...e}))},this.viewmodel=e.viewmodel}}var R=i(60459),E=i(55402),j=i(43908),T=i(45684),P=i(13339);function I(e){var t,i,n,r,s,a,l,c,d,u,p,h,m;let g=arguments.length>1&&void 0!==arguments[1]?arguments[1]:M,{MAX_ROW:v=g.MAX_ROW,MAX_COL:f=g.MAX_COL,instructions:x=g.instructions.slice(),gameTick:b=g.gameTick}={...e},k=function(e){let t=[];for(let i of e)switch(i.type){case o.RETRACT:t.splice(t.length-i.payload,i.payload);break;case o.MOVE:{let{r:e,c:n,p:r}=i.payload;t.push({r:e,c:n,p:r})}}return t}(x),N=w(k,v,f),C=1&k.length,S=N<0?x.length>0?y.X.PAUSED:y.X.PENDING:y.X.END,[R,E]=g.players,[T,P]=null!==(s=null==e?void 0:e.players)&&void 0!==s?s:[];return{elapsedTime:0,MAX_ROW:v,MAX_COL:f,status:S,winner:N,mover:C,pieces:k,instructions:x,gameTick:b,attemptTick:0,players:[{name:null!==(a=null==T?void 0:T.name)&&void 0!==a?a:R.name,type:null!==(l=null==T?void 0:T.type)&&void 0!==l?l:R.type,preference:{pieceFillStyle:null!==(c=null==T?void 0:null===(t=T.preference)||void 0===t?void 0:t.pieceFillStyle)&&void 0!==c?c:R.preference.pieceFillStyle,pieceStrokeStyle:null!==(d=null==T?void 0:null===(i=T.preference)||void 0===i?void 0:i.pieceStrokeStyle)&&void 0!==d?d:R.preference.pieceStrokeStyle}},{name:null!==(u=null==P?void 0:P.name)&&void 0!==u?u:E.name,type:null!==(p=null==P?void 0:P.type)&&void 0!==p?p:E.type,preference:{pieceFillStyle:null!==(h=null==P?void 0:null===(n=P.preference)||void 0===n?void 0:n.pieceFillStyle)&&void 0!==h?h:E.preference.pieceFillStyle,pieceStrokeStyle:null!==(m=null==P?void 0:null===(r=P.preference)||void 0===r?void 0:r.pieceStrokeStyle)&&void 0!==m?m:E.preference.pieceStrokeStyle}}],preference:(0,j.wT)(g.preference,null==e?void 0:e.preference)}}let M={MAX_ROW:15,MAX_COL:15,status:y.X.PENDING,elapsedTime:0,winner:-1,mover:0,pieces:[],instructions:[],gameTick:0,attemptTick:0,players:[{name:"guanghechen",type:l.COMPUTER,preference:{pieceFillStyle:{prefer:"image",imageUrl:"/asset/img/gomoku/guanghechen.jpg"}}},{name:"wulala",type:l.HUMAN,preference:{pieceFillStyle:{prefer:"image",imageUrl:"/asset/img/gomoku/wulala.jpg"}}}],preference:{borderColor:{r:255,g:255,b:255,a:1},locatePointColor:{r:51,g:51,b:51,a:1},boardBackground:{prefer:"color",color:{r:230,g:226,b:222,a:1},imageUrl:"/asset/img/gomoku/board.jpg"}}};var _=i(73935);class A extends y.p{constructor(e){super(e),this.getSnapshot=()=>({status:this.status$.getSnapshot(),elapsedTime:this.elapsedTime$.getSnapshot(),MAX_ROW:this.MAX_ROW$.getSnapshot(),MAX_COL:this.MAX_COL$.getSnapshot(),winner:this.winner$.getSnapshot(),mover:this.mover$.getSnapshot(),pieces:Array.from(this.pieces$.getSnapshot()),instructions:Array.from(this.instructions$.getSnapshot()),gameTick:this.gameTick$.getSnapshot(),attemptTick:this.attemptTick$.getSnapshot(),players:this.players$.getSnapshot(),preference:this.preference$.getSnapshot()}),this.dispatch=e=>{let t=D[e.type];t?(0,_.unstable_batchedUpdates)(()=>{t(this._controller,e)}):console.error(this.constructor.name,"Bad action:",e)},this.MAX_ROW$=new g.ZM(e.MAX_ROW),this.MAX_COL$=new g.ZM(e.MAX_COL),this.winner$=new g.ZM(e.winner),this.mover$=new g.ZM(e.mover),this.pieces$=new g.ZM(b.aV.of(...e.pieces)),this.instructions$=new g.ZM(b.aV.of(...e.instructions)),this.gameTick$=new g.ZM(e.gameTick),this.attemptTick$=new g.ZM(e.attemptTick),this.players$=new g.ZM(e.players),this.preference$=new g.ZM(e.preference);let t=new S({viewmodel:this});this._controller=t}}let D={[a.RESTART]:e=>{e.restart()},[a.RESET]:(e,t)=>{var i;let{MAX_ROW:n,MAX_COL:r}=null!==(i=t.payload)&&void 0!==i?i:{};e.reset(n,r)},[a.START]:e=>{e.start()},[a.PAUSE]:e=>{e.pause()},[a.RESUME]:e=>{e.resume()},[a.RETRACT]:e=>{e.retract()},[a.MOVE]:(e,t)=>{let{r:i,c:n}=t.payload;e.move(i,n)},[a.FLIP_PLAYER]:e=>{e.flipPlayer()},[a.MODIFY_PLAYER]:(e,t)=>{let i=t.payload;e.modifyPlayer(i)},[a.MODIFY_PREFERENCE]:(e,t)=>{let i=t.payload;e.modifyPreference(i)}},$=e=>{let{storageKey:t,LoadingComponent:i=T.gb}=e,[n,r]=h.useState(void 0),s=h.useMemo(()=>t?(0,P.Yu)(t):void 0,[t]),a=h.useRef(e.initialData);return(h.useEffect(()=>{e();async function e(){let e=await a.current;if(s){let t=await s.load();null==t||t.version!==m?r(new A(I(e))):r(new A(I({...t.data,...e})))}else r(new A(I(e)))}},[s]),h.useEffect(()=>{if(n)return()=>{console.log("[waw] unmounting gomoku viewmodel."),n.dispose()}},[n]),n)?(0,d.jsxs)(h.Fragment,{children:[(0,d.jsx)(v.Provider,{value:n,children:e.children}),s&&(0,d.jsx)(O,{viewmodel:n,storage:s,storageKey:t})]}):(0,d.jsx)(i,{})},O=e=>{let{viewmodel:t,storage:i,storageKey:n}=e,r=(0,g.sD)(t,["MAX_ROW$","MAX_COL$","winner$","instructions$","gameTick$","players$","preference$"]),s=h.useMemo(()=>(0,R.P2)(()=>{let e={MAX_ROW:t.MAX_ROW$.getSnapshot(),MAX_COL:t.MAX_COL$.getSnapshot(),winner:t.winner$.getSnapshot(),instructions:Array.from(t.instructions$.getSnapshot()),gameTick:t.gameTick$.getSnapshot(),players:Array.from(t.players$.getSnapshot()),preference:t.preference$.getSnapshot()};return j.kg.log("saving ".concat(n,". data:"),e),i.save({version:m,data:e})},200),[t,i,n]);return h.useEffect(()=>void s(),[s,r]),(0,E.i7)(()=>s.flushSync(),[],!1),(0,d.jsx)(h.Fragment,{})};var U=i(18872);function X(e){var t,i,n;let{data:r,items:s,itemsOrder:a,colon:o=":",onChange:l}=e,c={formItem:(0,U.cx)(B.formItem,null===(t=e.classes)||void 0===t?void 0:t.formItem),label:(0,U.cx)(B.label,null===(i=e.classes)||void 0===i?void 0:i.label),content:(0,U.cx)(B.content,null===(n=e.classes)||void 0===n?void 0:n.content)},u=a.map((e,t)=>{let i=s[e];return(0,d.jsxs)("div",{className:c.formItem,children:[(0,d.jsxs)("div",{className:c.label,children:[i.label,o]}),(0,d.jsx)("div",{className:c.content,children:(0,d.jsx)(G,{name:e,value:r[e],disabled:i.disabled,required:i.required,ContentRenderer:i.ContentRenderer,onChange:l})})]},t)});return(0,d.jsx)(h.Fragment,{children:u})}function G(e){let{ContentRenderer:t}=e,i=(0,E.$0)(t=>{e.onChange({[e.name]:t})});return(0,d.jsx)(t,{value:e.value,disabled:e.disabled,required:e.required,onChange:i})}let B={formItem:(0,U.iv)({display:"flex",alignItems:"flex-start"}),label:(0,U.iv)({flex:"0 1 auto",display:"inline-flex",justifyContent:"flex-end",alignItems:"flex-start",marginRight:8,userSelect:"none",height:"100%"}),content:(0,U.iv)({flex:"1 1 auto",display:"inline-flex",justifyContent:"flex-start",alignItems:"flex-start",height:"100%"})};var Z=i(26692),F=i(49318),L=i(78262),z=i(9581),q=i(31425),W=i(83321);function H(e){var t,i,n;let[r]=h.useState(e.initialData),[s,a]=h.useState(r),o=null!==(i=e.factoryData)&&void 0!==i?i:r,l=(0,Z.Z)(r,s),c=(0,Z.Z)(o,s),u=(null===(n=e.isResetAvailable)||void 0===n||n)&&!c,p={onConfirm:(0,E.$0)(()=>e.onSave(s)),onDiscard:(0,E.$0)(()=>e.onDiscard(r)),onChange:(0,E.$0)(t=>{var i;let n={...s,...t};a(n),null===(i=e.onRealTimeChange)||void 0===i||i.call(e,n)}),onReset:(0,E.$0)(()=>{var t;let i={...o};a(i),null!=e.onReset?e.onReset():null===(t=e.onRealTimeChange)||void 0===t||t.call(e,i)}),onClose:(0,E.$0)(()=>{l&&e.onDiscard(r)})};(0,E.TK)(()=>p.onDiscard(),[]);let m=e.formGroups.map((e,t)=>(0,d.jsx)(V,{data:s,keys:e.keys,Component:e.Component,onChange:p.onChange},t));return(0,d.jsxs)(L.Z,{"aria-labelledby":"edit-player",container:e.container,open:!0,onClose:p.onClose,children:[(0,d.jsx)(z.Z,{className:(0,U.cx)(Y.dialog,null===(t=e.classes)||void 0===t?void 0:t.dialog),children:m}),(0,d.jsxs)(q.Z,{children:[null!=e.factoryData&&(0,d.jsx)(W.Z,{color:"inherit",disabled:!u,onClick:p.onReset,children:"Reset"}),(0,d.jsx)(W.Z,{color:"inherit",onClick:p.onDiscard,children:"Discard"}),(0,d.jsx)(W.Z,{color:"primary",disabled:l,onClick:p.onConfirm,children:"Save"})]})]})}function V(e){let{Component:t,onChange:i}=e,n=(0,F.OU)(e.data,e.keys);return h.useMemo(()=>(0,d.jsx)(t,{data:n,onChange:i}),[t,n,i])}let Y={dialog:(0,U.iv)({minWidth:240,minHeight:300})};var K=i(94054),Q=i(72890),J=i(74750),ee=i(36872),et=i(30780);class ei extends h.PureComponent{render(){let{imageInputId:e,background:t,visible:i,className:n}=this.props,{onClosePicker:r,onColorChange:s,onImageChange:a,onPickerClicked:o,onPreferChange:l}=this;return(0,d.jsxs)("div",{className:(0,U.cx)(en.container,!i&&en.invisible,n),onClick:o,children:[(0,d.jsx)("div",{className:en.cover,onClick:r}),(0,d.jsxs)("div",{className:en.backgroundPicker,children:[(0,d.jsx)("div",{className:en.backgroundPrefer,children:(0,d.jsx)(K.Z,{style:{display:"flex",justifyContent:"center"},children:(0,d.jsxs)(Q.Z,{className:en.backgroundRadioGroup,value:t.prefer,onChange:l,children:[(0,d.jsx)(J.Z,{value:"color",control:(0,d.jsx)(ee.Z,{}),label:"color"}),(0,d.jsx)(J.Z,{value:"image",control:(0,d.jsx)(ee.Z,{}),label:"image"})]})})}),(0,d.jsxs)("div",{children:[(0,d.jsx)("div",{className:(0,U.cx)(en.colorPickerWrapper,"color"!==t.prefer&&en.invisible),onDoubleClick:r,children:(0,d.jsx)(et.xS,{className:en.colorPicker,color:t.color,onChange:s})}),(0,d.jsxs)("div",{className:(0,U.cx)(en.imagePickerWrapper,"image"!==t.prefer&&en.invisible),children:[(0,d.jsx)("input",{type:"file",accept:"image/*",id:e,style:{display:"none"},multiple:!1,onChange:a}),(0,d.jsx)("label",{htmlFor:e,children:(0,d.jsx)(W.Z,{className:en.imageUploadBtn,variant:"contained",component:"span",children:(0,d.jsx)("img",{alt:"background",src:t.imageUrl})})})]})]})]})]})}constructor(...e){super(...e),this.onClosePicker=()=>{this.props.onVisibleChange(!1)},this.onColorChange=e=>{let{background:t,onBackgroundChange:i}=this.props,n={prefer:"color",imageUrl:t.imageUrl,color:e.rgb};i(n)},this.onImageChange=e=>{let{background:t,onBackgroundChange:i}=this.props,n=e.target.files;if(null!==n){let e=new FileReader;e.readAsDataURL(n[0]),e.onload=e=>{var n;let r=null===(n=e.target)||void 0===n?void 0:n.result;if(null!=r){let e={prefer:"image",color:t.color,imageUrl:String(r)};i(e)}}}},this.onPickerClicked=e=>{e.stopPropagation()},this.onPreferChange=(e,t)=>{let{background:i,onBackgroundChange:n}=this.props,r={prefer:t,imageUrl:i.imageUrl,color:i.color};n(r)}}}ei.displayName="BackgroundPickerComponent",ei.propTypes={imageInputId:p().string.isRequired,background:p().any.isRequired,visible:p().bool.isRequired,className:p().string,onVisibleChange:p().func.isRequired,onBackgroundChange:p().func.isRequired};let en={container:(0,U.iv)({position:"absolute",zIndex:20,top:"20px"}),invisible:(0,U.iv)({"&&":{display:"none",visibility:"hidden"}}),cover:(0,U.iv)({position:"fixed",top:"0px",right:"0px",bottom:"0px",left:"0px",cursor:"default"}),backgroundPicker:(0,U.iv)({display:"flex",flexDirection:"column",minWidth:"220px",border:"1px solid #e6e6e6",borderRadius:"4px",boxShadow:"rgba(0, 0, 0, 0.15) 0px 0px 0px 1px, rgba(0, 0, 0, 0.15) 0px 8px 16px",background:"#fff"}),backgroundPrefer:(0,U.iv)({flex:"0 0 auto",borderBottom:"1px solid rgba(0, 0, 0, 0.15)",userSelect:"none"}),backgroundRadioGroup:(0,U.iv)({"&&":{display:"flex",flexDirection:"row",justifyContent:"center"}}),imagePickerWrapper:(0,U.iv)({boxSizing:"border-box",display:"flex",justifyContent:"center",alignItems:"center",width:"220px",height:"220px","& img":{display:"inline-block",width:"200px",height:"200px"}}),colorPickerWrapper:(0,U.iv)({display:"block"}),colorPicker:(0,U.iv)({border:"none !important",borderRadius:"0px !important",boxShadow:"none !important"}),imageUploadBtn:(0,U.iv)({"&&":{background:"none",padding:"0px",margin:"0px"}})},er=e=>{let{background:t,visible:i,className:n,onBackgroundChange:r,onVisibleChange:s}=e,a=h.useId();return(0,d.jsx)(ei,{imageInputId:a,background:t,visible:i,className:n,onBackgroundChange:r,onVisibleChange:s})};class es extends h.PureComponent{render(){let{color:e,visible:t,className:i}=this.props,{onColorChange:n,onClosePicker:r}=this;return(0,d.jsxs)("div",{className:(0,U.cx)(ea.container,!t&&ea.invisible,i),children:[(0,d.jsx)("div",{className:ea.cover,onClick:r}),(0,d.jsx)("div",{className:ea.picker,onDoubleClick:r,children:(0,d.jsx)(et.xS,{className:ea.colorPicker,color:e,onChange:n})})]})}constructor(...e){super(...e),this.onColorChange=e=>{this.props.onColorChange(e.rgb)},this.onClosePicker=()=>{this.props.onVisibleChange(!1)}}}es.displayName="ColorPicker",es.propTypes={visible:p().bool.isRequired,color:p().any.isRequired,className:p().string,onVisibleChange:p().func.isRequired,onColorChange:p().func.isRequired};let ea={container:(0,U.iv)({position:"absolute",zIndex:20,top:"20px",display:"block",visibility:"visible"}),invisible:(0,U.iv)({"&&":{display:"none",visibility:"hidden"}}),cover:(0,U.iv)({position:"fixed",top:0,right:0,bottom:0,left:0}),picker:(0,U.iv)({display:"flex",flexDirection:"column",minWidth:"220px",border:"1px solid #e6e6e6",borderRadius:"4px",boxShadow:"rgba(0, 0, 0, 0.15) 0px 0px 0px 1px, rgba(0, 0, 0, 0.15) 0px 8px 16px",background:"#fff"}),colorPicker:(0,U.iv)({border:"none !important",borderRadius:"0 !important",boxShadow:"none !important",caretColor:"transparent"})},eo=e=>{let{componentName:t}=e,i=e=>{let{value:t,disabled:i}=e,[n,r]=h.useState(!1),s={onTogglePickerVisible:(0,E.$0)(()=>{i||r(e=>!e)}),onBackgroundChange:(0,E.$0)(t=>{i||e.onChange(t)})},a=el(t,i);return(0,d.jsxs)("div",{className:a.container,children:[(0,d.jsx)("div",{className:a.swatch,onClick:s.onTogglePickerVisible,children:(0,d.jsx)("div",{className:a.colorSquare})}),(0,d.jsx)(er,{className:a.picker,visible:n,background:t,onVisibleChange:r,onBackgroundChange:s.onBackgroundChange})]})};return i.displayName=null!=t?t:"FormItemBackground",i},el=(e,t)=>({container:(0,U.iv)({display:"flex",alignItems:"center",caretColor:"transparent"}),swatch:(0,U.iv)({display:"inline-block",padding:3,border:"1px solid rgba(0,0,0,.2)",borderRadius:"1px",background:"#fff",cursor:t?"default":"pointer"}),colorSquare:(0,U.iv)("image"===e.prefer?{width:32,height:32,borderRadius:2,background:(0,j.l9)(e),backgroundSize:"cover"}:{width:32,height:12,borderRadius:2,background:(0,j.l9)(e),backgroundSize:"cover"}),picker:(0,U.iv)({"&&":{left:30}})}),ec=e=>{let{componentName:t}=e,i=e=>{let{value:t,disabled:i}=e,[n,r]=h.useState(!1),s={onTogglePickerVisible:(0,E.$0)(()=>{i||r(e=>!e)}),onColorChange:(0,E.$0)(t=>{i||e.onChange(t)})},a=ed(t,i);return(0,d.jsxs)("div",{className:a.container,children:[(0,d.jsx)("div",{className:a.swatch,onClick:s.onTogglePickerVisible,children:(0,d.jsx)("div",{className:a.colorSquare})}),(0,d.jsx)(es,{className:a.picker,visible:n,color:t,onVisibleChange:r,onColorChange:s.onColorChange})]})};return i.displayName=null!=t?t:"FormItemColor",i},ed=(e,t)=>({container:(0,U.iv)({display:"flex",alignItems:"center",caretColor:"transparent"}),swatch:(0,U.iv)({display:"inline-block",padding:3,border:"1px solid rgba(0,0,0,.2)",borderRadius:"1px",background:"#fff",cursor:t?"default":"pointer"}),colorSquare:(0,U.iv)({width:32,height:12,borderRadius:2,backgroundColor:(0,j.xv)(e)}),picker:(0,U.iv)({"&&":{left:30}})});var eu=i(55819),ep=i(45018);let eh=e=>{let{choices:t,componentName:i,normalize:n=e=>e}=e,r=Array.isArray(t)?t.map(e=>(0,d.jsx)(eu.Z,{value:e,children:e},e)):Object.keys(t).map(e=>(0,d.jsx)(eu.Z,{value:e,children:t[e]},e)),s=e=>{let t={onChange:(0,E.$0)(t=>{let i=n(t.target.value);e.onChange(i)})};return(0,d.jsx)(ep.Z,{variant:"standard",required:e.required,disabled:e.disabled,value:e.value,onChange:t.onChange,children:r})};return s.displayName=null!=i?i:"FormItemEnum",s};var em=i(98271);let eg=e=>{let{componentName:t}=e,i=e=>{let[t,i]=(0,E.nu)(e.value),n={onChange:(0,E.$0)(e=>{i(e.target.value)}),onBlur:(0,E.$0)(()=>{e.onChange(t)})};return(0,d.jsx)(em.Z,{variant:"standard",disabled:e.disabled,required:e.required,value:t,onChange:n.onChange,onBlur:n.onBlur})};return i.displayName=null!=t?t:"FormItemString",i},ev=["name","type","pieceFill"],ef={keys:ev,Component:e=>{let t=x(e=>e.status$),i=t===y.X.PENDING,n=t===y.X.END,r=h.useMemo(()=>({name:{label:"Name",disabled:n,ContentRenderer:eg({componentName:"GomokuSettingPlayerName"})},type:{label:"Type",disabled:!i,ContentRenderer:eh({componentName:"GomokuSettingPlayerType",choices:[l.HUMAN,l.COMPUTER,l.STUPID_COMPUTER]})},pieceFill:{label:"Avatar",disabled:n,ContentRenderer:eo({componentName:"GomokuSettingPlayerAvatar"})}}),[i,n]);return(0,d.jsx)(X,{data:e.data,items:r,itemsOrder:ev,classes:ex,onChange:e.onChange})}},ex={formItem:(0,U.iv)({margin:"1rem 1rem",alignItems:"center"}),label:(0,U.iv)({minWidth:"6rem"})},ey=e=>{let{playerId:t}=e,i=f(),n=x(e=>e.status$),r=x(e=>e.players$)[t],s=h.useMemo(()=>{let e=M.players[t];return{name:e.name,type:e.type,pieceFill:e.preference.pieceFillStyle,pieceStroke:e.preference.pieceStrokeStyle}},[t]),o=h.useMemo(()=>({name:r.name,type:r.type,pieceFill:r.preference.pieceFillStyle,pieceStroke:r.preference.pieceStrokeStyle}),[r]),l=h.useMemo(()=>[ef],[]),c=n===y.X.END,u={onRealTimeChange:(0,E.$0)(e=>{i({type:a.MODIFY_PLAYER,payload:{id:t,type:e.type,name:e.name,preference:(0,j.S4)({pieceFillStyle:e.pieceFill,pieceStrokeStyle:e.pieceStroke})}})}),onSave:t=>{u.onRealTimeChange(t),e.onClose()},onDiscard:(0,E.$0)(t=>{u.onRealTimeChange(t),e.onClose()})};return(0,d.jsx)(h.Fragment,{children:e.visible&&(0,d.jsx)(H,{container:e.containerRef.current,initialData:o,factoryData:s,isResetAvailable:!c,formGroups:l,classes:eb,onSave:u.onSave,onDiscard:u.onDiscard,onRealTimeChange:u.onRealTimeChange})})},eb={dialog:(0,U.iv)({minWidth:240,minHeight:400})};var ek=i(8802);let eN=e=>{let[t,i]=h.useState(!1),n={onAvatarClick:(0,E.$0)(e=>{e.stopPropagation(),i(!0)})},r=eC(e.position,e.avatar,e.disabled,e.thinking,e.running);return(0,d.jsxs)("div",{className:(0,U.cx)(r.container,e.className),onClick:e.onEdit,children:[(0,d.jsxs)("div",{className:r.userWrapper,children:[(0,d.jsx)("span",{className:r.name,children:e.name}),(0,d.jsx)("span",{className:r.type,children:e.type})]}),(0,d.jsx)("div",{className:r.avatar,onClick:n.onAvatarClick,children:(0,d.jsx)(ek.Z,{className:r.thinkingIcon})}),(0,d.jsx)(er,{className:r.picker,visible:t,background:e.avatar,onVisibleChange:i,onBackgroundChange:e.onAvatarChange})]})},eC=(e,t,i,n,r)=>h.useMemo(()=>({container:(0,U.iv)({position:"relative",display:"flex",flexDirection:"left"===e?"row":"row-reverse",justifyContent:"flex-end",alignItems:"center",lineHeight:"16px",cursor:i?"default":"pointer"}),avatar:(0,U.iv)({position:"relative",width:32,height:32,borderRadius:"50%",margin:"left"===e?"0 0 0 6px":"0 6px 0 0",background:(0,j.l9)(t),backgroundSize:"cover"}),userWrapper:(0,U.iv)({display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"left"===e?"flex-end":"flex-start",lineHeight:"16px"}),name:(0,U.iv)({display:"flex",alignItems:"center",color:"#4682b4",fontSize:16,userSelect:"none"}),thinkingIcon:(0,U.iv)({"&&":{position:"absolute",top:0,left:"left"===e?void 0:-20,right:"left"===e?-20:void 0,display:"inline-block",visibility:n?"visible":"hidden",transition:"translate(0, -50%)",width:16,height:16,color:"#69696e",userSelect:"none",animation:r?"1s ease-in 0s ".concat(ew.thinkingIcon," infinite alternate both"):void 0}}),type:(0,U.iv)({margin:"4px 0",fontSize:14,userSelect:"none"}),picker:(0,U.iv)({"&&":"left"===e?{top:48,left:16}:{top:48,left:"unset",right:16}})}),[e,t,i,n,r]),ew={thinkingIcon:(0,U.F4)({"0%":{transform:"rotate(-30deg) scale(1.0)"},"50%":{transform:"rotate(0deg) scale(1.2)"},"100%":{transform:"rotate(30deg) scale(1.0)"}})};class eS extends h.Component{render(){let{onCancel:e,onEditPlayer0:t,onEditPlayer1:i,onPlayer0AvatarChange:n,onPlayer1AvatarChange:r}=this,{containerRef:s,status:a,mover:o,players:l}=this.props,{editingPlayerId:c}=this.state,[u,p]=l,h=a===y.X.RUNNING,m=a===y.X.PENDING;return(0,d.jsxs)("div",{className:eR.container,children:[(0,d.jsx)(eN,{position:"left",className:eR.player0,name:u.name,type:u.type,avatar:u.preference.pieceFillStyle,disabled:!m,running:h,thinking:0===o,onEdit:t,onAvatarChange:n},"player0"),(0,d.jsx)("span",{className:eR.versus,children:"VS"}),(0,d.jsx)(eN,{position:"right",className:eR.player1,name:p.name,type:p.type,avatar:p.preference.pieceFillStyle,disabled:!m,running:h,thinking:1===o,onEdit:i,onAvatarChange:r},"player1"),null!=c&&(0,d.jsx)(ey,{containerRef:s,visible:!0,playerId:c,onClose:e})]})}shouldComponentUpdate(e,t){let i=this.props,n=this.state;return n.editingPlayerId!==t.editingPlayerId||i.containerRef!==e.containerRef||i.status!==e.status||i.mover!==e.mover||i.players!==e.players}constructor(e){super(e),this.onCancel=()=>{this.setState({editingPlayerId:null})},this.onEditPlayer0=()=>{this.setState({editingPlayerId:0})},this.onEditPlayer1=()=>{this.setState({editingPlayerId:1})},this.onPlayer0AvatarChange=e=>{let{dispatchGomokuAction:t}=this.props;t({type:a.MODIFY_PLAYER,payload:{id:0,preference:{pieceFillStyle:e}}})},this.onPlayer1AvatarChange=e=>{let{dispatchGomokuAction:t}=this.props;t({type:a.MODIFY_PLAYER,payload:{id:1,preference:{pieceFillStyle:e}}})},this.state={editingPlayerId:null}}}eS.displayName="DuelPlayersComponent",eS.propTypes={containerRef:p().object.isRequired,status:p().number.isRequired,mover:p().number.isRequired,players:p().array.isRequired,dispatchGomokuAction:p().func.isRequired};let eR={container:(0,U.iv)({display:"flex",alignItems:"center",maxWidth:"min(90vw, 400px)",height:"3rem",width:"100%",margin:"auto"}),player0:(0,U.iv)({flex:"1 1 0",display:"flex"}),player1:(0,U.iv)({flex:"1 1 0",display:"flex"}),versus:(0,U.iv)({flex:"0 0 auto",margin:"0 36px"})},eE=e=>{let t=f(),i=x(e=>e.status$),n=x(e=>e.mover$),r=x(e=>e.players$);return(0,d.jsx)(eS,{containerRef:e.containerRef,status:i,mover:n,players:r,dispatchGomokuAction:t})};var ej=i(94101);class eT{init(e){var t;this.canvas=e,window.addEventListener("resize",this.onresize),null===(t=this.canvas)||void 0===t||t.addEventListener("click",this.onclick),this.onresize()}reset(e){null!=e.GOMOKU_SIZE&&(this.GOMOKU_SIZE=e.GOMOKU_SIZE),null!=e.pieceDrawer&&(this.pieceDrawer=e.pieceDrawer),null!=e.styles&&(this.styles={...this.styles,...e.styles}),this.canvas!==e.canvas&&(console.log("destroying canvas"),this.destroy(),this.init(e.canvas)),this.onresize()}destroy(){var e;window.removeEventListener("resize",this.onresize),null===(e=this.canvas)||void 0===e||e.removeEventListener("click",this.onclick)}async draw(e){let{_drawingStatus:t}=this;if(t.drawing){t.requesting=!0,t.requestData=[e];return}t.drawing=!0,this.pieces=e;try{let{canvas:e,bufferCanvas:t}=this,i=null==e?void 0:e.getContext("2d");if(null==e||null==i)return;let{width:n,height:r}=e;t.width=n,t.height=r;let s=t.getContext("2d");null!=s?(s.clearRect(0,0,n,r),await this._drawAll(s),i.clearRect(0,0,n,r),i.drawImage(t,0,0)):(i.clearRect(0,0,n,r),await this._drawAll(i))}finally{t.drawing=!1,t.requesting&&(t.requesting=!1,await this.draw(...t.requestData))}}async _drawAll(e){this._drawBoard(e),this._drawLocatePoints(e),await this._drawPieces(e),this._drawLastPlacedHighlight(e),this._drawActivatedCellHighlight(e)}_drawBoard(e){let{lineWidth:t,farTop:i,farRight:n,farBottom:r,farLeft:s,gridSize:a,styles:o}=this,l=a+t;e.lineWidth=t,e.strokeStyle=o.gridLineColor,e.beginPath();for(let t=i;t<=r;t+=l)e.moveTo(t,s),e.lineTo(t,n);for(let t=s;t<=n;t+=l)e.moveTo(i,t),e.lineTo(r,t);e.closePath(),e.stroke()}_drawLocatePoints(e){let{lineWidth:t,GOMOKU_SIZE:i,styles:n}=this,r=i-1>>1,s=r%4==0?4:r%4,a=t+6>>1;e.fillStyle=n.locatePointColor;for(let t=s;t+1<i;t+=4)for(let n=s;n+1<i;n+=4){let{x:i,y:r}=this.position(t,n);e.beginPath(),e.arc(i,r,a,0,ej.QA,!1),e.closePath(),e.stroke(),e.fill()}}async _drawPieces(e){if(null==this.pieceDrawer)return;let{GOMOKU_SIZE:t,pieceDrawer:i,pieceRadius:n,pieces:r}=this,s=[],a=[];for(let{r:e,c:i,p:n}of r)if(e>=0&&e<t&&i>=0&&i<t){let t=this.position(e,i);0===n?s.push(t):1===n&&a.push(t)}await Promise.allSettled([i.drawPieces(e,0,n,s),i.drawPieces(e,1,n,a)])}_drawLastPlacedHighlight(e){let t=this.pieces.get(-1);if(void 0===t)return;let{r:i,c:n}=t,{GOMOKU_SIZE:r,pieceRadius:s,activateCell:a}=this;if((i!==a.r||n!==a.c)&&i>=0&&i<r&&n>=0&&n<r){let{x:t,y:r}=this.position(i,n);e.setLineDash([5,3]),e.lineWidth=1,e.strokeStyle="#c80000",e.beginPath(),e.arc(t,r,s+4,0,ej.QA,!1),e.closePath(),e.stroke(),e.setLineDash([])}}_drawActivatedCellHighlight(e){let{GOMOKU_SIZE:t,activateCell:i,pieceRadius:n}=this,{r,c:s}=i;if(r>=0&&r<t&&s>=0&&s<t){let{x:t,y:i}=this.position(r,s);e.setLineDash([5,3]),e.lineWidth=1,e.strokeStyle="blue",e.beginPath(),e.arc(t,i,n+4,0,ej.QA,!1),e.closePath(),e.stroke(),e.setLineDash([])}}locate(e,t){let{GOMOKU_SIZE:i,pieceRadius:n}=this,r=this.gridSize+this.lineWidth,s=e-this.farLeft,a=t-this.farTop,o=Math.floor(a/r),l=Math.floor(s/r),c=s-l*r,d=a-o*r;return 2*c>r&&(l+=1,c=r-c),2*d>r&&(o+=1,d=r-d),o>=0&&o<i&&l>=0&&l<i&&Math.abs(c)<=n&&Math.abs(d)<=n?{r:o,c:l}:{r:-1,c:-1}}position(e,t){let{lineWidth:i,gridSize:n,farLeft:r,farTop:s}=this,a=n+i;return{x:r+t*a,y:s+e*a}}updateActivateCell(e,t){this.activateCell.r=e,this.activateCell.c=t,this.draw(this.pieces)}constructor(e){var t,i,n,r,s;this.canvas=null,this.pieceDrawer=null,this.pieceRadius=0,this.gridSize=0,this.farTop=0,this.farRight=0,this.farBottom=0,this.farLeft=0,this.activateCell={r:-1,c:-1},this._drawingStatus={drawing:!1,requesting:!1,requestData:[b.aV.of()]},this.onresize=()=>{let{canvas:e,GOMOKU_SIZE:t,lineWidth:i}=this;if(null==e)return;let n=e.parentElement;if(null!=n){var r;let s=Math.min(n.clientWidth,n.clientHeight),a=i*t,o=Math.floor((s-a)/(t+.2));if(o<12)throw TypeError("Canvas is not large enough. clientWidth(".concat(n.clientWidth,"), clientHeight(").concat(n.clientHeight,")"));e.width=s,e.height=s;let l=s-a-o*(t-1);this.farLeft=this.farTop=Math.floor(l/2),this.farRight=this.farBottom=s-(l-this.farLeft),this.gridSize=o;let c=Math.round((this.lineWidth+16)/2)+1;this.pieceRadius=null!==(r=this.__customPieceRadius)&&void 0!==r?r:Math.floor(Math.min(.4*o,Math.max(.3*this.gridSize,c))),this.draw(this.pieces)}},this.onclick=e=>{let{GOMOKU_SIZE:t}=this,{offsetX:i,offsetY:n}=e,{r,c:s}=this.locate(i,n);if(r>=0&&r<t&&s>=0&&s<t){var a,o;this.updateActivateCell(r,s),null===(a=(o=this.listeners).onClick)||void 0===a||a.call(o,r,s)}},this.GOMOKU_SIZE=e.lines,this.pieces=e.pieces,this.lineWidth=null!==(n=e.lineWidth)&&void 0!==n?n:1,this.pieceDrawer=e.pieceDrawer,this.listeners={...e.listeners},this.bufferCanvas=document.createElement("canvas"),this.styles={gridLineColor:null!==(r=null===(t=e.styles)||void 0===t?void 0:t.gridLineColor)&&void 0!==r?r:"#492d15",locatePointColor:null!==(s=null===(i=e.styles)||void 0===i?void 0:i.locatePointColor)&&void 0!==s?s:"#333333"},this.__customPieceRadius=e.pieceRadius,this.init(e.canvas)}}var eP=i(6260);class eI{drawPieces(e,t,i,n){let r=2*i,{pieceFillStyle:s,pieceStrokeStyle:a}=this.getPreferenceSettings(t),o=null!=a?(0,j.xv)(a):"";switch(o&&(e.strokeStyle=o),s.prefer){case"color":for(let{x:t,y:r}of((0,eP.Z)(null!=s.color,"[drawPiece] color is not defined"),e.fillStyle=(0,j.xv)(s.color),n))e.beginPath(),e.arc(t,r,i,0,ej.QA,!1),e.closePath(),e.stroke(),e.fill();return Promise.resolve();case"image":{(0,eP.Z)(null!=s.imageUrl,"[drawPiece] imageUrl is not defined");let t=document.createElement("img");return t.src=s.imageUrl,new Promise(s=>{t.onload=()=>{for(let{x:s,y:a}of n)e.save(),e.beginPath(),e.arc(s,a,i,0,ej.QA,!1),e.closePath(),e.clip(),e.drawImage(t,0,0,t.width,t.height,s-i,a-i,r,r),e.restore();s()}})}default:return Promise.resolve()}}constructor(e){this.getPreferenceSettings=e}}new RegExp("^\\s*(\\d+(?:\\.\\d+)?)([".concat("KMGTP","]B?)?\\s*$"));let eM=e=>new Promise(t=>setTimeout(t,e));var e_=i(25289);class eA{get isRunning(){return this._running}request(e){if(!this._running){var t;this._running=!0,null===(t=this._worker)||void 0===t||t.postMessage(e)}}constructor(e){if(this._running=!1,this._worker=null,e.canUseDOM&&"undefined"!=typeof Worker){let{scriptURL:t,options:i,onResponse:n}=e,r=new Worker(t,i);r.onmessage=e=>{this._running=!1,n(e)},this._worker=r}}}(c||(c={})).MOVE="move";let eD=new class{run(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,{_tasks:n,_taskMap:r,_previousTaskHolder:s}=this;return new Promise((a,o)=>{this._taskId+=1;let l={id:this._taskId,type:e,data:t,status:"pending",resolve:a,reject:o};n.enqueue(l),r.set(l.id,l);let c=s.get(i);void 0!==c&&"pending"===c.status&&(c.status="canceled",c.resolve(null),l.id=c.id),s.set(i,l),this._schedule()})}_schedule(){var e;let t;let i=this._workers.find(e=>!e.isRunning);if(void 0===i)return;let{_tasks:n}=this;for(;n.size>0&&"pending"!==(t=n.dequeue()).status;);(null===(e=t)||void 0===e?void 0:e.status)==="pending"&&(t.status="running",i.request({id:t.id,type:t.type,data:t.data}))}constructor(e){var t;let i=Math.max(1,Math.min(100,e.workerInstanceCount));this._requestId=0,this._taskId=0,this._tasks=new e_.T,this._taskMap=new Map,this._previousTaskHolder=new Map,this._tasks.init(),this._tasks.resize(null!==(t=e.MAX_TASK_NUMBER)&&void 0!==t?t:1e4),this._workers=Array(i).fill([]).map(()=>new eA({canUseDOM:e.canUseDOM,scriptURL:e.workerUrl,options:e.workerOptions,onResponse:e=>{let{id:t,data:i,error:n}=e.data,r=this._taskMap.get(t);switch((0,eP.Z)(void 0!==r,()=>"[Webworker] Cannot find the running task with id (".concat(t,")")),r.status){case"running":null===i?r.reject("[Webworker] Cannot solve the request. ".concat(n)):r.resolve(i),r.status="done";break;case"pending":case"done":throw Error("[Webworker] Bad task status (".concat(r.status,"). id (").concat(t,")"))}this._schedule()}}))}}({canUseDOM:ej.Nq,workerUrl:"/asset/js/webworker/gomoku.js",workerInstanceCount:1,MAX_TASK_NUMBER:10});async function e$(e){let t=await eD.run(c.MOVE,e);if(null===t)return[-1,-1];let{r:i,c:n}=t;return[i,n]}class eO{async move(e){let t=Date.now(),i=this._move(e),n=t+this.MINIMAL_THINKING_TIME-Date.now();return n>0&&await eM(n),i}constructor(e){var t;let i=Math.min(3e5,null!==(t=e.MINIMAL_THINKING_TIME)&&void 0!==t?t:0);this.MINIMAL_THINKING_TIME=i}}class eU extends eO{async _move(e){let{MAX_ROW:t,MAX_COL:i,pieces:n,playerId:r}=e,[s,a]=await e$({MAX_ROW:t,MAX_COL:i,pieces:Array.from(n),playerId:r,MAX_ADJACENT:this.MAX_ADJACENT,MAX_DISTANCE_OF_NEIGHBOR:this.MAX_DISTANCE_OF_NEIGHBOR});return[s,a]}constructor(e){super(e),this.type=l.COMPUTER,this.MAX_ADJACENT=e.MAX_ADJACENT,this.MAX_DISTANCE_OF_NEIGHBOR=e.MAX_DISTANCE_OF_NEIGHBOR,this.scoreMap=e.scoreMap}}class eX extends eO{_move(e){if(null!=e.clickedPos){let{r:t,c:i}=e.clickedPos;return[t,i]}return[-1,-1]}constructor(...e){super(...e),this.type=l.HUMAN}}var eG=i(66420);class eB extends eO{_move(e){let{MAX_ROW:t,MAX_COL:i}=e,n=Array.from(e.pieces);if(n.length<=0)return[t>>1,i>>1];for(let e of((0,eG.ZP)(n),(0,eG.ZP)(this.shufflableDirections),n))for(let[r,s]of this.shufflableDirections){let a=e.r+r,o=e.c+s;if(a>=0&&a<t&&o>=0&&o<i){if(n.some(e=>e.r===a&&e.c===o))continue;return[a,o]}}return[-1,-1]}constructor(e){super(e),this.type=l.STUPID_COMPUTER,this.shufflableDirections=k.bs.slice()}}let eZ=e=>{switch(e.type){case l.HUMAN:return new eX({MINIMAL_THINKING_TIME:0});case l.COMPUTER:return new eU({MAX_ADJACENT:5,MAX_DISTANCE_OF_NEIGHBOR:2,MINIMAL_THINKING_TIME:300});case l.STUPID_COMPUTER:return new eB({MINIMAL_THINKING_TIME:300})}},eF=()=>{var e;let t=f(),i=x(e=>e.status$),n=x(e=>e.MAX_ROW$),r=x(e=>e.MAX_COL$),s=x(e=>e.pieces$),o=x(e=>e.players$),l=x(e=>e.mover$),c=h.useRef([]);(null===(e=c.current[l])||void 0===e?void 0:e.type)!==o[l].type&&(c.current[l]=eZ(o[l]));let d=c.current[l],u=h.useRef(!1),p=(0,E.$0)(async e=>{if(!u.current&&void 0!==d&&i===y.X.RUNNING)try{u.current=!0;let[i,o]=await d.move({MAX_ROW:n,MAX_COL:r,pieces:s,playerId:l,clickedPos:e});(0,eP.Z)(i>=0&&i<n&&o>=0&&o<=r,()=>"[Unexpected moving] currentPlayer(".concat(l,"}), moving: (").concat(i,", ").concat(o,")")),t({type:a.MOVE,payload:{r:i,c:o}})}catch(e){console.error("Failed to move:",e)}finally{u.current=!1,await eM(50)}}),m=C(d.type);return h.useEffect(()=>{if(!m||i!==y.X.RUNNING)return;let e=setTimeout(()=>void p(),0);return()=>clearTimeout(e)},[l,m,i,p]),{move:p}},eL=e=>{let{overlay:t,className:i}=e,n=x(e=>e.MAX_ROW$),r=x(e=>e.pieces$),s=x(e=>e.status$),a=x(e=>e.players$),{borderColor:o}=x(e=>e.preference$),l=h.useRef(null),c=(0,j.xv)(o),u=eF(),p=(0,E.$0)((e,t)=>{e>=0&&e<n&&t>=0&&t<n&&u.move({r:e,c:t})}),m=(0,E.$0)(e=>a[e].preference),g=(0,E.$0)(async()=>{await (null==v?void 0:v.draw(r))}),[v,f]=h.useState(null);return h.useEffect(()=>{let e=new eI(m),t=new eT({canvas:l.current,lines:15,pieces:b.aV.of(),pieceDrawer:e,listeners:{onClick:p}});return f(t),()=>t.destroy()},[p,m]),h.useEffect(()=>{null!=v&&(v.reset({canvas:l.current,GOMOKU_SIZE:n,styles:{gridLineColor:c}}),g())},[v,n,c,g]),h.useEffect(()=>{null==v||v.draw(r)},[v,r]),(0,d.jsxs)("div",{className:(0,U.cx)(eq.container,i),children:[(0,d.jsx)("div",{className:(0,U.cx)(eq.overlay,s===y.X.PENDING&&eq.overlayPending,s===y.X.RUNNING&&eq.overlayRunning,s===y.X.PAUSED&&eq.overlayPaused,s===y.X.END&&eq.overlayEnd),children:t},"overlay"),(0,d.jsx)("canvas",{ref:l})]})},ez={finished:(0,U.F4)({"0%":{transform:"translate(0, -100px)"},"80%":{transform:"translate(0, 20px)"},"90%":{transform:"translate(0, -10px)"},"95%":{transform:"translate(0, 2px)"},"100%":{transform:"translate(0, 0)"}})},eq={container:(0,U.iv)({position:"relative",boxSizing:"content-box",display:"inline-block",width:"100%",height:"100%",padding:0,border:0,margin:0,fontFamily:"Consolas, 'Source Code Pro', 'Roboto Mono', monospace, sans-serif"}),overlay:(0,U.iv)({zIndex:2,position:"absolute",top:0,left:0,right:0,bottom:0,display:"none",width:"100%",height:"100%",overflow:"hidden",background:"linear-gradient(45deg, hsl(30, 20%, 90%, 0.2), hsl(210, 20%, 100%, 0.3))"}),overlayPending:(0,U.iv)({display:"block",backdropFilter:"blur(1px)"}),overlayRunning:(0,U.iv)({display:"none"}),overlayPaused:(0,U.iv)({display:"block",backdropFilter:"blur(4px)"}),overlayEnd:(0,U.iv)({display:"block",backdropFilter:"blur(4px)",color:"#ff00ff",animation:"1s 0s ".concat(ez.finished," ease-in-out")})};var eW=i(9171),eH=i(41616),eV=i(70655),eY=i(1849);class eK extends h.Component{render(){let{start:e,resume:t,restart:i}=this,{status:n,players:r}=this.props,s=r[this.props.winner];switch(n){case y.X.PENDING:return(0,d.jsx)("div",{className:eQ.overlay,children:(0,d.jsx)(W.Z,{className:eQ.button,variant:"contained",color:"primary",startIcon:(0,d.jsx)(eV.Z,{}),onClick:e,children:"Start"})});case y.X.PAUSED:return(0,d.jsx)("div",{className:eQ.overlay,children:(0,d.jsx)(W.Z,{className:eQ.button,variant:"contained",color:"primary",startIcon:(0,d.jsx)(eH.Z,{}),onClick:t,children:"Resume"})});case y.X.END:return(0,d.jsx)("div",{className:eQ.overlay,children:(0,d.jsxs)("div",{className:eQ.finishedBanner,children:[void 0!==s?(0,d.jsxs)("div",{className:eQ.blessing,children:[(0,d.jsxs)("div",{className:eQ.winner,children:[(0,d.jsx)("span",{className:eQ.winnerAvatar,style:{background:(0,j.l9)(s.preference.pieceFillStyle),backgroundSize:"cover"}},"avatar"),(0,d.jsx)("span",{className:eQ.winnerName,children:s.name},"name")]}),"win\uD83C\uDF89"]}):(0,d.jsx)("p",{children:"Draw!"}),(0,d.jsx)(W.Z,{className:eQ.button,variant:"contained",color:"primary",startIcon:(0,d.jsx)(eY.Z,{}),onClick:i,children:"New"})]})});default:return(0,d.jsx)(h.Fragment,{})}}componentDidUpdate(e){let t=this.props.attemptTick>0,i=this.props.status;if(e.status!==i&&i===y.X.END&&t){let e=this.props.players[this.props.winner];void 0!==e&&this.props.throwConfetti()}}shouldComponentUpdate(e){let t=this.props;return t.status!==e.status||t.winner!==e.winner||t.attemptTick!==e.attemptTick||t.players!==e.players}constructor(...e){super(...e),this.start=()=>{let{dispatchGomokuAction:e}=this.props;e({type:a.START})},this.resume=()=>{let{dispatchGomokuAction:e}=this.props;e({type:a.RESUME})},this.restart=()=>{let{dispatchGomokuAction:e}=this.props;e({type:a.RESTART})}}}eK.displayName="GameOverlayComponent",eK.propTypes={status:p().number.isRequired,winner:p().number.isRequired,attemptTick:p().number.isRequired,players:p().array.isRequired,dispatchGomokuAction:p().func.isRequired,throwConfetti:p().func.isRequired};let eQ={overlay:(0,U.iv)({position:"relative",display:"flex",alignItems:"center",justifyContent:"center",height:"100%",width:"100%",userSelect:"none"}),confettiCanvas:(0,U.iv)({top:0,bottom:0,left:0,right:0,width:"100%",height:"100%"}),button:(0,U.iv)({"&&, &&:hover":{boxShadow:"4px 4px 16px 0px hsl(0deg 0% 0% / 0.75)"}}),finishedBanner:(0,U.iv)({position:"relative",display:"flex",flexDirection:"column",justifyContent:"center",padding:0,margin:0,fontSize:32}),blessing:(0,U.iv)({display:"flex",alignItems:"center",marginBottom:"1rem"}),winner:(0,U.iv)({display:"flex",flexDirection:"column",alignItems:"center",marginRight:16}),winnerAvatar:(0,U.iv)({display:"inline-block",width:32,height:32,borderRadius:"50%"}),winnerName:(0,U.iv)({color:"#333",fontSize:12})},eJ=()=>{let e=f(),t=x(e=>e.status$),i=x(e=>e.winner$),n=x(e=>e.attemptTick$),r=x(e=>e.players$),s=(0,eW.D)();return(0,d.jsx)(eK,{status:t,winner:i,attemptTick:n,players:r,dispatchGomokuAction:e,throwConfetti:s})};var e0=i(44993),e1=i(51334),e2=i(94229),e4=i(93946);let e3=["size","background","border"],e5={keys:e3,Component:e=>{let t=x(e=>e.status$),i=t===y.X.PENDING,n=t===y.X.END,r=h.useMemo(()=>({size:{label:"Size",disabled:!i,ContentRenderer:eh({componentName:"GomokuSettingBoardSize",choices:Object.fromEntries([5,7,9,11,13,15,17,19,21,23,25].map(e=>[e,"".concat(e,"x").concat(e)])),normalize:e=>Number(e)})},background:{label:"Background",disabled:n,ContentRenderer:eo({componentName:"GomokuSettingBoardBackground"})},border:{label:"Board",disabled:n,ContentRenderer:ec({componentName:"GomokuSettingBoardColor"})}}),[i,n]);return(0,d.jsx)(X,{data:e.data,items:r,itemsOrder:e3,classes:e9,onChange:e.onChange})}},e9={formItem:(0,U.iv)({margin:"1rem 1rem",alignItems:"center"}),label:(0,U.iv)({minWidth:"6rem"})},e6=e=>{let t=f(),i=x(e=>e.status$),n=x(e=>e.MAX_ROW$),{boardBackground:r,borderColor:s}=x(e=>e.preference$),[o,l]=h.useState(!1),c=h.useMemo(()=>({size:M.MAX_ROW,background:M.preference.boardBackground,border:M.preference.borderColor}),[]),u=h.useMemo(()=>({size:n,background:r,border:s}),[n,r,s]),p=h.useMemo(()=>[e5],[]),m=i===y.X.END,g={onOpenDialog:(0,E.$0)(()=>l(!0)),onRealTimeChange:(0,E.$0)(e=>{n!==e.size&&t({type:a.RESET,payload:{MAX_ROW:e.size,MAX_COL:e.size}}),(r!==e.background||s!==e.border)&&t({type:a.MODIFY_PREFERENCE,payload:{boardBackground:e.background,borderColor:e.border}})}),onSave:e=>{g.onRealTimeChange(e),l(!1)},onDiscard:(0,E.$0)(e=>{g.onRealTimeChange(e),l(!1)})},{WakeBtn:v=e8}=e;return(0,d.jsxs)("div",{className:(0,U.cx)(e7.container,e.className),children:[(0,d.jsx)(v,{onWakeUp:g.onOpenDialog}),o&&(0,d.jsx)(H,{container:e.containerRef.current,initialData:u,factoryData:c,isResetAvailable:!m,formGroups:p,classes:te,onSave:g.onSave,onDiscard:g.onDiscard,onRealTimeChange:g.onRealTimeChange})]})},e8=e=>(0,d.jsx)(e4.Z,{size:"small",className:e7.wakeBtn,onClick:e.onWakeUp,children:(0,d.jsx)(e2.Z,{})}),e7={container:(0,U.iv)({}),wakeBtn:(0,U.iv)({"> svg":{width:18,height:18}})},te={dialog:(0,U.iv)({minWidth:240,minHeight:400})};class tt extends h.Component{render(){let{flip:e,retract:t,restart:i,start:n,closeRestartDialog:r}=this,{containerRef:s,status:a,mover:o,pieces:l}=this.props,{isRestartDialogVisible:c}=this.state,u=a!==y.X.PENDING,p=(a===y.X.RUNNING||a===y.X.END)&&l.some(e=>e.p===o),h=a===y.X.PENDING;return(0,d.jsxs)("div",{className:ti.toolbar,children:[(0,d.jsxs)("div",{className:(0,U.cx)(ti.item,ti.buttons),children:[(0,d.jsx)(W.Z,{variant:"contained",color:"inherit",size:"small",startIcon:(0,d.jsx)(eY.Z,{}),disabled:!u,onClick:n,children:(0,d.jsx)("span",{className:ti.buttonText,children:"New"})}),(0,d.jsx)(W.Z,{variant:"contained",color:"inherit",size:"small",startIcon:(0,d.jsx)(e0.Z,{}),disabled:!p,onClick:t,children:(0,d.jsx)("span",{className:ti.buttonText,children:"Retract"})}),(0,d.jsx)(W.Z,{variant:"contained",color:"inherit",size:"small",startIcon:(0,d.jsx)(e1.Z,{}),disabled:!h,onClick:e,children:(0,d.jsx)("span",{className:ti.buttonText,children:"Flip"})}),(0,d.jsx)(e6,{containerRef:s})]}),(0,d.jsxs)(L.Z,{container:s.current,open:c,onClose:r,"aria-labelledby":"confirm-to-restart",children:[(0,d.jsx)(z.Z,{children:"Are you sure you want to start a new game?"}),(0,d.jsxs)(q.Z,{children:[(0,d.jsx)(W.Z,{color:"inherit",onClick:r,children:"Cancel"}),(0,d.jsx)(W.Z,{color:"primary",onClick:i,children:"Confirm"})]})]})]})}shouldComponentUpdate(e,t){let i=this.props,n=this.state;return n.isRestartDialogVisible!==t.isRestartDialogVisible||i.containerRef!==e.containerRef||i.status!==e.status||i.mover!==e.mover||i.pieces!==e.pieces}constructor(e){super(e),this.flip=()=>{let{dispatchGomokuAction:e}=this.props;e({type:a.FLIP_PLAYER})},this.retract=()=>{let{dispatchGomokuAction:e}=this.props;e({type:a.RETRACT})},this.restart=()=>{let{dispatchGomokuAction:e}=this.props;e({type:a.RESTART}),this.setState({isRestartDialogVisible:!1})},this.start=()=>{let{status:e,dispatchGomokuAction:t}=this.props;e===y.X.PENDING||e===y.X.END?t({type:a.RESTART}):this.setState({isRestartDialogVisible:!0})},this.closeRestartDialog=()=>{this.setState({isRestartDialogVisible:!1})},this.state={isRestartDialogVisible:!1}}}tt.displayName="GameToolbarComponent",tt.propTypes={containerRef:p().object.isRequired,status:p().number.isRequired,mover:p().number.isRequired,pieces:p().any.isRequired,dispatchGomokuAction:p().func.isRequired};let ti={toolbar:(0,U.iv)({display:"block",maxWidth:"min(90vw, 400px)",margin:"auto"}),item:(0,U.iv)({display:"flex",flexWrap:"wrap",alignItems:"center",justifyContent:"flex-start",margin:"1rem 0"}),buttons:(0,U.iv)({justifyContent:"space-around","> button":{display:"flex",justifyContent:"spaceBetween",alignItems:"center",margin:"0 4px"}}),buttonText:(0,U.iv)({lineHeight:1.1})},tn=e=>{let t=f(),i=x(e=>e.status$),n=x(e=>e.mover$),r=x(e=>e.pieces$);return(0,d.jsx)(tt,{status:i,mover:n,pieces:r,containerRef:e.containerRef,dispatchGomokuAction:t})},tr=()=>{let e=f(),t=h.useRef(null),i=ts();return(0,E.TK)(()=>e({type:a.PAUSE}),[e]),(0,d.jsxs)("div",{ref:t,className:i.container,children:[(0,d.jsxs)("div",{className:i.header,children:[(0,d.jsx)(eE,{containerRef:t}),(0,d.jsx)(tn,{containerRef:t})]}),(0,d.jsx)("div",{className:i.main,children:(0,d.jsx)(eL,{overlay:(0,d.jsx)(eJ,{})})})]})},ts=()=>{let{boardBackground:e}=x(e=>e.preference$);return{container:(0,U.iv)({boxSizing:"border-box",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",width:"100%"}),header:(0,U.iv)({boxSizing:"border-box",display:"flex",flexDirection:"column",justifyContent:"center",width:"100%",padding:"2vmin"}),main:(0,U.iv)({boxSizing:"border-box",height:"96vmin",width:"96vmin",background:(0,j.l9)(e),backgroundSize:"cover","@media (min-width: 1367px)":{width:"60vmin",height:"60vmin"}})}},ta=e=>(0,d.jsx)($,{storageKey:e.storageKey,initialData:e.initialState,children:(0,d.jsx)(tr,{})});ta.propTypes={storageKey:p().string.isRequired};var to=i(28514);class tl extends h.PureComponent{render(){return(0,d.jsx)(to.Vj,{title:"Gomoku Game",children:(0,d.jsx)(ta,{storageKey:"@kyokuya/gomoku-game/context0/"})})}}tl.displayName="GomokuGamePage"},74243:function(e,t,i){var n={"./component/container":[28195,195],"./component/container.tsx":[28195,195],"./component/editor":[70102,102],"./component/editor.tsx":[70102,102],"./component/previewer":[36040,40],"./component/previewer.tsx":[36040,40],"./post/algorithm/dlx/sudoku-solver":[15051,51],"./post/algorithm/dlx/sudoku-solver.tsx":[15051,51],"./post/game/sudoku":[71247,596,724,997,564,747,185,247],"./post/game/sudoku.tsx":[71247,596,724,997,564,747,185,247],"./util/sudoku":[34388,388],"./util/sudoku.ts":[34388,388]};function r(e){if(!i.o(n,e))return Promise.resolve().then(function(){var t=Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t});var t=n[e],r=t[0];return Promise.all(t.slice(1).map(i.e)).then(function(){return i(r)})}r.keys=function(){return Object.keys(n)},r.id=74243,e.exports=r}},function(e){e.O(0,[596,554,724,564,43,774,888,179],function(){return e(e.s=40193)}),_N_E=e.O()}]);